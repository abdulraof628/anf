import{x as c,v as B,u as j,z as w,H as x,y as t,J as i,F as g,I as b,t as S,O as P,B as T,b7 as D,q as l,S as $,U as f}from"./@vue-39dc9ff3.js";import"./Authenticated-214cc5de.js";import{d as L,c as R,e as z}from"./@heroicons-fd1e1a44.js";import{H as C,L as E}from"./@inertiajs-2b766590.js";import{C as F}from"./ConfirmationModal-958041d3.js";import{P as I}from"./Pagination-4f35e34d.js";import{h as v}from"./moment-a9aaa855.js";import{s as M}from"./@vueform-8fb84cf1.js";import{a as O}from"./axios-1779699b.js";import{C as k}from"./chart.js-0b478678.js";import{p as V}from"./chartjs-plugin-datalabels-da6f5433.js";import{d as Z}from"./dom-to-image-a7f639c9.js";import"./ApplicationLogo-5cf6e77e.js";import"./radix-vue-a603168c.js";import"./@floating-ui-c05b1c1f.js";import"./@internationalized-2f03b566.js";import"./class-variance-authority-52f2569e.js";import"./clsx-1229b3e0.js";import"./app-ef5f5861.js";import"./pusher-js-68b5c933.js";import"./@vuepic-a83e4355.js";import"./@babel-1b80a44a.js";import"./cropperjs-042b647f.js";import"./laravel-vite-plugin-d10ca5e8.js";import"./vue-debounce-ed417ae1.js";import"./v-calendar-e9930861.js";import"./tailwind-merge-3f7ff3b1.js";import"./@vueuse-c14271ca.js";import"./@radix-icons-9ff33614.js";import"./lodash.isequal-0acc53e7.js";import"./vue-46d666fa.js";import"./lodash.clonedeep-12c784b4.js";import"./qs-45a3326f.js";import"./side-channel-401220dd.js";import"./get-intrinsic-88feedc6.js";import"./es-errors-82fd953f.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-1353c55e.js";import"./function-bind-61637ca6.js";import"./hasown-bc561cf0.js";import"./call-bind-9ec8ebd8.js";import"./set-function-length-ecd19468.js";import"./define-data-property-d38573ea.js";import"./es-define-property-cfa03815.js";import"./gopd-4c4454f6.js";import"./has-property-descriptors-68e2873e.js";import"./object-inspect-ac0241aa.js";import"./deepmerge-89e33937.js";import"./nprogress-87ee1729.js";import"./lucide-vue-next-7b48dc26.js";import"./@headlessui-3f5736f6.js";import"./@kurkle-b1b89bbc.js";const H={class:"flex flex-col justify-center items-center p-3 space-y-4"},N=t("div",{class:"mt-16"}," Please wait while report is loading... ",-1),W=[N],Y={class:"flex justify-center w-[215mm] mx-2 my-2 md:mx-auto"},q={class:"flex flex-col items-center space-y-4"},J={class:"w-[210mm]"},Q={class:"flex flex-col justify-between space-y-2 bg-white p-3",id:"report",ref:"report"},U={class:"grid grid-rows-1"},G={class:"flex justify-center"},K={class:"font-bold text-slate-800 text-xl py-5 uppercase"},X={class:"grid grid-rows-1"},tt={class:"grid grid-cols-2 px-4 space-x-4"},et={class:"flex items-center justify-center rounded-lg"},st={id:"scatter-chart",ref:"scatterChart",class:"hidden m-0"},rt={id:"bar-chart",ref:"barChart",class:"hidden m-0"},at={class:"p-6 rounded-lg"},ot={class:"mt-2 space-y-3"},it={class:"flex justify-between text-sm font-medium"},nt=t("dt",{class:"text-gray-500 min-w-[70px]"},"Name : ",-1),lt={class:"text-gray-900 break-word"},ct={class:"flex justify-between text-sm font-medium"},dt=t("dt",{class:"text-gray-500"},"Age :",-1),ht={class:"text-gray-900"},pt={class:"flex justify-between text-sm font-medium"},_t=t("dt",{class:"text-gray-500"},"Result :",-1),mt={class:"text-gray-900"},gt={class:"flex justify-between text-sm font-medium"},ft=t("dt",{class:"text-gray-500"},"Date / Time",-1),ut={class:"text-gray-900"},yt={class:"grid grid-cols-1 px-4 space-x-4"},wt={class:"flex items-center p-2 text-sm text-gray-800 border border-gray-300 rounded-lg bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600",role:"alert"},xt=t("svg",{class:"flex-shrink-0 inline w-4 h-4 me-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})],-1),bt={class:"flex flex-col text-xs"},vt={class:"grid grid-rows-1"},kt={class:"grid grid-cols-1"},Ct={class:"flex justify-center px-4"},At={class:"w-full"},Bt=t("thead",{class:"text-xs font-semibold uppercase text-gray-400 bg-indigo-100"},[t("tr",null,[t("th",{class:"p-2 whitespace-nowrap border-2 rounded-tr",width:"3"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"#")]),t("th",{class:"p-2 whitespace-nowrap border-2"},[t("div",{class:"flex font-semibold justify-center text-gray-700"},"Question")]),t("th",{class:"p-2 whitespace-nowrap border-2 w-8"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"Result")])])],-1),jt={class:"text-sm divide-y divide-gray-100"},St={class:"p-1 whitespace-nowrap border-2 text-center align-middle text-sm"},Pt={class:"p-1 whitespace-nowrap border-2 align-middle text-sm"},Tt={class:"flex flex-col flex-wrap"},Dt={class:"whitespace-normal font-semibold"},$t={key:0,class:"flex items-center"},Lt={class:"whitespace-normal font-semibold"},Rt={key:0},zt={key:1},Et={key:1,class:"whitespace-normal font-semibold"},Ft={class:"p-1 whitespace-nowrap border-2 text-center align-middle text-sm"},It={class:"flex justify-center"},Mt={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-check-circle-fill text-green-500",viewBox:"0 0 16 16"},Ot=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"},null,-1),Vt=[Ot],Zt={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-x-circle-fill text-red-500",viewBox:"0 0 16 16"},Ht=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"},null,-1),Nt=[Ht],Wt={components:{SearchIcon:L,TrashIcon:R,PencilIcon:z,ConfirmationModal:F,Head:C,Link:E,Multiselect:M,Pagination:I},props:{filter:Object},data(){return{finish_loading_report:!1,current_chart_type:"",chart_info:[],bar_chart:"",scatter_chart:"",chart_image:"",show_report:!1,report:{title:"",name:"",age:"",result:"",datetime:""},chart_data:{categories:{label:[],data:[],info:[]},total_answers:4},answer_data:[]}},methods:{viewReport(){const o=this.$page.props.answer_record.dt_id,e=this.$page.props.answer_record.total_answers,s=this.$page.props.answer_record.chart_type;this.current_chart_type=s,this.chart_data.total_answers=e,this.bar_chart&&this.bar_chart.destroy(),this.scatter_chart&&this.scatter_chart.destroy(),this.displayChart(o,s)},displayChart(o,e){O.get(route("diagnostic_test.get_dt_categories"),{params:{dt_id:o,chart_type:e}}).then(s=>{this.chart_data.categories.label=s.data.label,this.chart_data.categories.data=s.data.data,this.chart_data.categories.data=this.splitResultByCategory(),this.chart_data.categories.info=s.data.info,this.initChart(e),this.initAnswers(),this.initInfos()}).catch(s=>{console.error(s)})},initChart(o){if(o==1){let s=document.getElementById("bar-chart").getContext("2d");const a=new k(s,{type:"bar",data:{labels:this.chart_data.categories.label,datasets:[{data:this.chart_data.categories.data,backgroundColor:["#7B66FF","#39A7FF","#508D69","#ED5AB3"],borderWidth:1}]},options:{animation:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1},datalabels:{display:!1}},scales:{y:{min:0,max:3,stepSize:1,ticks:{beginAtZero:!0}},x:{display:!1,min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}}},ticks:{precision:0}},plugins:[V]});this.bar_chart=a}if(o==2){const e=this.chart_data.total_answers,s={id:"scatterArbitraryLine",beforeDatasetDraw(h,r,d){const{ctx:p,chartArea:{top:Yt,bottom:qt,left:Jt,right:Qt,width:Ut,height:Gt},scales:{x:u,y}}=h;A();function A(Kt,Xt,te,ee){p.save(),p.beginPath(),p.strokeStyle="rgba(170, 170, 170, 1)",p.lineWidth=3,p.moveTo(u.getPixelForValue(0),y.getPixelForValue(0)),p.lineTo(u.getPixelForValue(e),y.getPixelForValue(e)),p.stroke(),p.restore()}}},a={id:"scatterAnnotationLine",beforeDraw:h=>{if(h.tooltip._active&&h.tooltip._active.length){const r=h.ctx;r.save();const d=h.tooltip._active[0];r.beginPath(),r.moveTo(d.element.x,h.chartArea.top),r.lineTo(d.element.x,d.element.y),r.lineWidth=2,r.strokeStyle="white",r.stroke(),r.restore(),r.beginPath(),r.moveTo(d.element.x,d.element.y),r.lineTo(d.element.x,h.chartArea.bottom),r.lineWidth=2,r.strokeStyle="red",r.stroke(),r.restore(),r.beginPath(),r.moveTo(h.chartArea.left,d.element.y),r.lineTo(d.element.x,d.element.y),r.lineWidth=2,r.strokeStyle="red",r.stroke(),r.restore()}}};let m=document.getElementById("scatter-chart").getContext("2d");const _=new k(m,{type:"scatter",data:{labels:this.chart_data.total_answers,datasets:[{data:[{x:this.chart_data.categories.data[0],y:this.chart_data.categories.data[1]}],borderColor:"rgba(255, 8, 0, 1)",pointStyle:"crossRot",radius:6,hoverRadius:10,fill:!1}]},options:{animation:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1}},scales:{y:{min:0,max:5,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Operations"}},x:{min:0,max:5,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Numbers"}}},ticks:{precision:0}},plugins:[s,a]});this.scatter_chart=_}},splitResultByCategory(){const o=this.$page.props.answer_record.answer_record.reduce((s,a)=>(a.correct?s[a.question_category_id]=(s[a.question_category_id]||0)+1:s.hasOwnProperty(a.question_category_id)||(s[a.question_category_id]=null),s),{}),e={};return Object.keys(o).forEach((s,a)=>{e[a]=o[s]}),Object.values(e)},initAnswers(){this.answer_data=this.$page.props.answer_record.answer_record},initInfos(){this.report.title=this.$page.props.answer_record.dt_name,this.report.name=this.$page.props.answer_record.child_name,this.report.age=this.$page.props.answer_record.child_age,this.report.result=this.$page.props.answer_record.total_correct_answers+"/"+this.$page.props.answer_record.total_answers,this.report.date=v(this.$page.props.answer_record.created_at).format("DD/MM/YYYY"),this.report.time=v(this.$page.props.answer_record.created_at).format("hh:mm A"),this.finish_loading_report=!0},download(){document.getElementById("report").style.display="block";var o=document.getElementById("report");setTimeout(()=>{var e=2;Z.toPng(o,{width:o.clientWidth*e,height:o.clientHeight*e,style:{transform:"scale("+e+")",transformOrigin:"top left"}}).then(function(s){var a=document.createElement("a");a.href=s,a.download="Diagnostic Test Report.png",a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}).catch(function(s){console.error("oops, something went wrong!",s)})})}},created(){this.viewReport()}},ts=Object.assign(Wt,{__name:"Report",setup(o){return(e,s)=>{const a=D("Button");return l(),c(g,null,[B(j(C),{title:"Diagnostic Test Report"}),w(t("div",H,W,512),[[x,!e.finish_loading_report]]),w(t("div",Y,[t("div",q,[t("div",J,[t("div",Q,[t("div",U,[t("div",G,[t("h1",K,"Diagnostic Test "+i(e.report.title),1)])]),t("div",X,[t("div",tt,[t("div",et,[t("canvas",st,null,512),t("canvas",rt,null,512)]),t("div",at,[t("dl",ot,[t("div",it,[nt,t("dd",lt,i(e.report.name),1)]),t("div",ct,[dt,t("dd",ht,i(e.report.age),1)]),t("div",pt,[_t,t("dd",mt,i(e.report.result),1)]),t("div",gt,[ft,t("dd",ut,i(e.report.date)+" - "+i(e.report.time),1)])])])]),t("div",yt,[t("div",wt,[xt,t("div",bt,[(l(!0),c(g,null,b(e.chart_data.categories.info,n=>(l(),c("span",null,[t("span",{class:"font-semibold",style:$("color: "+n.category_color)},i(n.category_name)+":",5),f(" "+i(n.category_description),1)]))),256))])])])]),t("div",vt,[t("div",kt,[t("div",Ct,[t("table",At,[Bt,t("tbody",jt,[(l(!0),c(g,null,b(e.answer_data,(n,m)=>(l(),c("tr",null,[t("td",St,i(++m),1),t("td",Pt,[t("div",Tt,[t("p",Dt,i(n.question),1),n.answer?(l(),c("div",$t,[t("p",Lt,[f("Answer: "),n.answer.length?(l(),c("span",Rt,i(n.answer.map(_=>_===null?"Blank":_)),1)):(l(),c("span",zt,i(n.answer),1))])])):(l(),c("p",Et,"Answer: "+i(n.answer+1),1))])]),t("td",Ft,[t("div",It,[n.correct?(l(),c("svg",Mt,Vt)):(l(),c("svg",Zt,Nt))])])]))),256))])])])])])],512)]),e.finish_loading_report?(l(),S(a,{key:0,onClick:e.download},{default:P(()=>[f("Download")]),_:1},8,["onClick"])):T("",!0)])],512),[[x,e.finish_loading_report]])],64)}}});export{ts as default};
