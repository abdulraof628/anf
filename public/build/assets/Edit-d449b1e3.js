import{o as d,c as a,a as f,u as x,w as y,F as p,H as V,L as O,d as e,l as D,h as l,v as i,e as _,t as u,q as m,g as v,m as I,n as h,i as M}from"./app-4d4cbe7d.js";import{B as C}from"./Authenticated-cde3a9ac.js";import{B as w}from"./Button-7893ea7c.js";import{h as k}from"./moment-a9aaa855.js";import{Z as L}from"./vue-datepicker-fdb826aa.js";import"./ApplicationLogo-7e99a00b.js";import"./NavLink-9d0a350c.js";import"./XIcon-33e2d1a0.js";import"./vue3-perfect-scrollbar-edf4bd5b.js";import"./_plugin-vue_export-helper-c27b6911.js";const B={class:"md:grid md:grid-cols-2"},P={class:"md:mt-0 md:col-span-2"},S={class:"px-4 py-5 bg-indigo-50 space-y-6 sm:p-6"},N={class:"grid grid-cols-1 2xl:grid-cols-3 gap-4"},z={class:"lg:col-span-2"},T={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-md h-full"},j=e("div",{class:"mb-5"},[e("h1",{class:"font-bold text-indigo-800"},"Invoice Information"),e("div",{class:"border-b border-dashed border-indigo-900 mt-1"})],-1),A={class:"grid grid-cols-1"},E={class:"mb-4"},R=e("label",{for:"invoice_number",class:"block text-sm font-bold text-gray-700"}," Invoice Number ",-1),W={class:"mt-1 flex rounded-md shadow-sm"},H={class:"grid grid-cols-1"},Y={class:"mb-4"},Z=e("label",{for:"student_name",class:"block text-sm font-bold text-gray-700"}," Student Name ",-1),q={class:"mt-1 flex rounded-md shadow-sm"},J={class:"grid grid-cols-2 gap-4"},G={class:"mb-4"},K=e("label",{for:"date_issued",class:"block text-sm font-bold text-gray-700"}," Date Issued ",-1),Q={class:"mt-1 flex rounded-md shadow-sm"},X={class:"mb-4"},ee=e("label",{for:"due_date",class:"block text-sm font-bold text-gray-700"}," Due Date ",-1),oe={class:"mt-1 flex rounded-md shadow-sm"},se={class:"grid grid-cols-1"},te={class:"mb-10"},re={class:"w-full"},de=e("thead",null,[e("tr",{class:"bg-gray-600"},[e("th",{class:"text-left text-white text-sm py-2 px-4 w-1/12"},"#"),e("th",{class:"text-left text-white text-sm py-2 px-4 w-7/12"},"Items"),e("th",{class:"text-center text-white text-sm py-2 px-4 w-2/12"},"Discount"),e("th",{class:"text-center text-white text-sm py-2 px-4 w-2/12"},"Amount")])],-1),ae={class:"border text-sm text-center py-2 px-4"},ne={class:"border text-sm py-2 px-4"},le={class:"grid grid-rows-1 gap-2"},ie={class:"border border-dashed border-indigo-400 bg-indigo-200 rounded py-1 px-3"},me={class:"font-semibold"},ue={class:"flex flex-col space-y-2 pl-5"},pe={class:"border border-dashed border-indigo-400 rounded py-1 px-3"},ce={key:0,class:"bg-indigo-100 py-1 px-3 rounded-sm"},fe=e("label",null," Registration Fee ",-1),_e=[fe],be={key:1,class:"bg-indigo-100 py-1 px-3 rounded-sm"},ge=e("label",null," Material Fee ",-1),ye=[ge],he={class:"border border-dashed border-blue-400 bg-blue-100 rounded py-1 px-3 space-x-1"},ve=e("label",{class:"text-xs text-white px-1.5 py-0.5 bg-blue-500 rounded"},"Promo",-1),xe={class:"border text-sm py-2 px-4 align-bottom"},we={class:"flex flex-col space-y-1.5"},ke=["onUpdate:modelValue"],Ve=["onUpdate:modelValue"],$e=["onUpdate:modelValue"],Fe=["value"],Ue={class:"border text-sm py-2 px-4 align-bottom"},Oe={class:"flex flex-col space-y-1.5"},De=["onUpdate:modelValue"],Ie=["onUpdate:modelValue"],Me=["onUpdate:modelValue"],Ce=e("div",{class:"border-b border-dashed border-indigo-900 mb-5"},null,-1),Le={class:"grid grid-cols-3"},Be={class:"mb-4 text-left"},Pe=e("label",{for:"payment_status",class:"block text-sm font-bold text-gray-700"}," Payment Status ",-1),Se=["value"],Ne=e("div",{class:"mb-4"},null,-1),ze={class:"mb-4 text-right pr-5"},Te=e("label",{for:"amount",class:"block text-md font-bold text-gray-700"}," Total Amount",-1),je={class:"text-2xl font-bold text-indigo-500"},Ae={class:"lg:col-span-1"},Ee={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-md h-full"},Re=e("div",{class:"mb-5"},[e("h1",{class:"font-bold text-indigo-800"},"Collect Payment"),e("div",{class:"border-b border-dashed border-indigo-900 mt-1"})],-1),We={class:"grid grid-cols-1"},He={class:"mb-4"},Ye=e("label",{for:"date",class:"block text-sm font-bold text-gray-700"}," Date ",-1),Ze={class:"mt-1 flex rounded-md shadow-sm"},qe={class:"mb-4"},Je=e("label",{for:"transaction_id",class:"block text-sm font-bold text-gray-700"}," Transaction ID ",-1),Ge={class:"mt-1 flex rounded-md shadow-sm"},Ke={class:"mb-4"},Qe=e("label",{for:"student_name",class:"block text-sm font-bold text-gray-700"}," Proof of Payment ",-1),Xe={class:"mt-1 items-center space-x-2 w-full"},eo={key:0,class:""},oo={class:"block focus:ring-0 focus:border-gray-300"},so=e("span",{class:"sr-only"},"Browse File",-1),to={key:1,class:"flex justify-between py-2 border bg-gray-50 shadow-md p-4 rounded-md"},ro=["href"],ao=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 448 512"},[e("path",{d:"M364.2 83.8c-24.4-24.4-64-24.4-88.4 0l-184 184c-42.1 42.1-42.1 110.3 0 152.4s110.3 42.1 152.4 0l152-152c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-152 152c-64 64-167.6 64-231.6 0s-64-167.6 0-231.6l184-184c46.3-46.3 121.3-46.3 167.6 0s46.3 121.3 0 167.6l-176 176c-28.6 28.6-75 28.6-103.6 0s-28.6-75 0-103.6l144-144c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-144 144c-6.7 6.7-6.7 17.7 0 24.4s17.7 6.7 24.4 0l176-176c24.4-24.4 24.4-64 0-88.4z"})],-1),no={class:"flex"},lo=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",fill:"currentColor",class:"text-white h-3 w-3"},[e("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})],-1),io=[lo],mo={class:"mb-4"},uo=e("label",{for:"transaction_id",class:"block text-sm font-bold text-gray-700"}," Remark ",-1),po={class:"mt-1 flex rounded-md shadow-sm"},co={class:"grid grid-rows-1 grid-cols-1 sm:grid-cols-1 gap-4"},fo={class:"sm:row-span-3"},_o={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-md"},bo={class:"flex items-center justify-end"},go={class:"flex space-x-2"},yo={components:{Head:V,Link:O},data(){return{date_issued:k(this.$page.props.invoice_data.date_issued).format("DD MMM Y"),due_date:k(this.$page.props.invoice_data.due_date).format("DD MMM Y"),form:{params:this.$page.props.params,invoice_id:this.$page.props.invoice_data.id,invoice_items:JSON.parse(this.$page.props.invoice_data.invoice_items),invoice_amount:this.$page.props.invoice_data.amount,payment:{status:this.$page.props.invoice_data.status,date:this.$page.props.invoice_data.payment_date,transaction_id:this.$page.props.invoice_data.payment_transaction_id,proof:{url:this.$page.props.invoice_data.payment_proof?this.$page.props.invoice_data.payment_proof:"",file:"",delete_previous:!1},remark:this.$page.props.invoice_data.remark}}}},watch:{"form.invoice_items":{handler(n){n.forEach(o=>{o.programme_fee||(o.programme_fee=0),o.programme_fee_discount||(o.programme_fee_discount=0),o.registration_fee||(o.registration_fee=0),o.registration_fee_discount||(o.registration_fee_discount=0),o.material_fee||(o.material_fee=0),o.material_fee_discount||(o.material_fee_discount=0)})},deep:!0}},methods:{submit(){this.form.invoice_amount=this.totalFee(this.form.invoice_items),this.$inertia.post(route("fee.invoices.update"),this.form,{preserveState:!0})},numbersOnly(n){n=n||window.event;var o=n.which?n.which:n.keyCode;if(o>31&&(o<48||o>57)&&o!==46)n.preventDefault();else{let t=n.target.value.trim();return t===""?t="0":t!=="0"&&t.startsWith("0")&&(t=t.replace(/^0+/,"")),n.target.value=t!==""?t:"0",!0}},totalFee(n){let o=0;for(const s of n){const b=parseFloat(s.programme_fee),r=parseFloat(s.programme_fee_discount),c=parseFloat(s.registration_fee),$=parseFloat(s.registration_fee_discount),F=parseFloat(s.material_fee),U=parseFloat(s.material_fee_discount);o+=b-r,s.include_registration_fee&&(o+=c-$),s.include_material_fee&&(o+=F-U);var t=0;if(s.promos&&Array.isArray(s.promos)){for(const g of s.promos)g.type_id===1&&(t+=b*g.value/100),g.type_id===2&&(t+=g.value);o=o-t}}return o},deleteProof(){this.form.payment.proof.url=[],this.form.payment.proof.file="",this.form.payment.proof.delete_previous=!0},uploadFile(n){const o=n.target.files[0];o.type=="application/pdf"||o.name.toLowerCase().endsWith(".pdf")||o.type=="image/jpeg"||o.name.toLowerCase().endsWith(".png")?(this.form.payment.proof.url=[URL.createObjectURL(o)],this.form.payment.proof.file=o):(alert("Only Image / PDF File allowed!"),this.$refs.file_input.value="",this.form.payment.proof.url="",this.form.payment.proof.file="")}}},Do=Object.assign(yo,{__name:"Edit",setup(n){return(o,t)=>(d(),a(p,null,[f(x(V),{title:"Fee Invoices"}),f(C,null,{header:y(()=>[]),default:y(()=>[e("div",B,[e("div",P,[e("form",{onSubmit:t[18]||(t[18]=D((...s)=>o.submit&&o.submit(...s),["prevent"]))},[e("div",S,[e("div",N,[e("div",z,[e("div",T,[j,e("div",A,[e("div",E,[R,e("div",W,[l(e("input",{disabled:"",type:"text",name:"invoice_number",id:"invoice_number",class:"focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 bg-gray-100","onUpdate:modelValue":t[0]||(t[0]=s=>o.$page.props.invoice_data.invoice_number=s),autocomplete:"off"},null,512),[[i,o.$page.props.invoice_data.invoice_number]])])])]),e("div",H,[e("div",Y,[Z,e("div",q,[l(e("input",{disabled:"",type:"text",name:"student_name",id:"student_name",class:"focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 bg-gray-100","onUpdate:modelValue":t[1]||(t[1]=s=>o.$page.props.invoice_data.student_name=s),autocomplete:"off"},null,512),[[i,o.$page.props.invoice_data.student_name]])])])]),e("div",J,[e("div",G,[K,e("div",Q,[l(e("input",{disabled:"",type:"text",name:"date_issued",id:"date_issued",class:"focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 bg-gray-100","onUpdate:modelValue":t[2]||(t[2]=s=>o.date_issued=s),autocomplete:"off"},null,512),[[i,o.date_issued]])])]),e("div",X,[ee,e("div",oe,[l(e("input",{disabled:"",type:"text",name:"due_date",id:"due_date",class:"focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 bg-gray-100","onUpdate:modelValue":t[3]||(t[3]=s=>o.due_date=s),autocomplete:"off"},null,512),[[i,o.due_date]])])])]),e("div",se,[e("div",te,[e("table",re,[de,e("tbody",null,[(d(!0),a(p,null,_(o.form.invoice_items,(s,b)=>(d(),a("tr",null,[e("td",ae,u(b+1),1),e("td",ne,[e("div",le,[e("div",ie,[e("label",me,u(s.programme_name)+" ( Level "+u(s.programme_level)+" )",1)]),e("div",ue,[e("div",pe,[e("label",null,u(s.programme_type),1)]),s.include_registration_fee?(d(),a("div",ce,_e)):m("",!0),s.include_material_fee?(d(),a("div",be,ye)):m("",!0),s.promos?(d(!0),a(p,{key:2},_(s.promos,r=>(d(),a("div",he,[ve,v(),e("label",null,u(r.promo_name),1)]))),256)):m("",!0)])])]),e("td",xe,[e("div",we,[l(e("input",{type:"number",min:"0",name:"",id:"",class:"bg-gray-50 py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 cursor-not-allowed","onUpdate:modelValue":r=>s.programme_fee_discount=r,autocomplete:"off",onInput:t[4]||(t[4]=(...r)=>o.numbersOnly&&o.numbersOnly(...r)),disabled:""},null,40,ke),[[i,s.programme_fee_discount]]),s.include_registration_fee?l((d(),a("input",{key:0,type:"number",min:"0",name:"",id:"",class:"bg-gray-50 py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 cursor-not-allowed","onUpdate:modelValue":r=>s.registration_fee_discount=r,autocomplete:"off",onInput:t[5]||(t[5]=(...r)=>o.numbersOnly&&o.numbersOnly(...r)),disabled:""},null,40,Ve)),[[i,s.registration_fee_discount]]):m("",!0),s.include_material_fee?l((d(),a("input",{key:1,type:"number",min:"0",name:"",id:"",class:"bg-gray-50 py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 cursor-not-allowed","onUpdate:modelValue":r=>s.material_fee_discount=r,autocomplete:"off",onInput:t[6]||(t[6]=(...r)=>o.numbersOnly&&o.numbersOnly(...r)),disabled:""},null,40,$e)),[[i,s.material_fee_discount]]):m("",!0),s.promos?(d(!0),a(p,{key:2},_(s.promos,r=>(d(),a("input",{type:"number",min:"0",name:"",id:"",class:"bg-gray-50 py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 cursor-not-allowed",value:r.type_id===1?s.programme_fee*r.value/100:r.value,autocomplete:"off",onInput:t[7]||(t[7]=(...c)=>o.numbersOnly&&o.numbersOnly(...c)),disabled:""},null,40,Fe))),256)):m("",!0)])]),e("td",Ue,[e("div",Oe,[l(e("input",{type:"number",min:"0",name:"",id:"",class:"bg-gray-50 py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 cursor-not-allowed","onUpdate:modelValue":r=>s.programme_fee=r,autocomplete:"off",onInput:t[8]||(t[8]=(...r)=>o.numbersOnly&&o.numbersOnly(...r)),disabled:""},null,40,De),[[i,s.programme_fee]]),s.include_registration_fee?l((d(),a("input",{key:0,type:"number",min:"0",name:"",id:"",class:"bg-gray-50 py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 cursor-not-allowed","onUpdate:modelValue":r=>s.registration_fee=r,autocomplete:"off",onInput:t[9]||(t[9]=(...r)=>o.numbersOnly&&o.numbersOnly(...r)),disabled:""},null,40,Ie)),[[i,s.registration_fee]]):m("",!0),s.include_material_fee?l((d(),a("input",{key:1,type:"number",min:"0",name:"",id:"",class:"bg-gray-50 py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 cursor-not-allowed","onUpdate:modelValue":r=>s.material_fee=r,autocomplete:"off",onInput:t[10]||(t[10]=(...r)=>o.numbersOnly&&o.numbersOnly(...r)),disabled:""},null,40,Me)),[[i,s.material_fee]]):m("",!0),s.promos?(d(!0),a(p,{key:2},_(s.promos,r=>(d(),a("input",{type:"number",min:"0",name:"",id:"",class:"bg-gray-50 py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 cursor-not-allowed",value:0,onInput:t[11]||(t[11]=(...c)=>o.numbersOnly&&o.numbersOnly(...c)),disabled:""},null,32))),256)):m("",!0)])])]))),256))])])])]),Ce,e("div",Le,[e("div",Be,[Pe,l(e("select",{name:"payment_status",id:"payment_status",class:"mt-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300",autocomplete:"off","onUpdate:modelValue":t[12]||(t[12]=s=>o.form.payment.status=s)},[(d(!0),a(p,null,_(o.$page.props.invoice_status,s=>(d(),a("option",{value:s.id},u(s.name),9,Se))),256))],512),[[I,o.form.payment.status]])]),Ne,e("div",ze,[Te,e("span",je,u(o.totalFee(o.form.invoice_items)),1)])])])]),e("div",Ae,[e("div",Ee,[Re,e("div",We,[e("div",He,[Ye,e("div",Ze,[f(x(L),{class:h("focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm"),style:M(o.$page.props.errors.date?"--dp-border-color: #fa9e9e":""),"input-class-name":"invoices-input-date-picker focus:ring-0",modelValue:o.form.payment.date,"onUpdate:modelValue":t[13]||(t[13]=s=>o.form.payment.date=s),enableTimePicker:!1,"auto-apply":!0,format:"dd/MM/yyyy"},null,8,["style","modelValue"])])]),e("div",qe,[Je,e("div",Ge,[l(e("input",{type:"text",name:"transaction_id",id:"transaction_id",class:h(["focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm",o.$page.props.errors.transaction_id?"border-red-300":"border-gray-300"]),"onUpdate:modelValue":t[14]||(t[14]=s=>o.form.payment.transaction_id=s),autocomplete:"off"},null,2),[[i,o.form.payment.transaction_id]])])]),e("div",Ke,[Qe,e("div",Xe,[o.form.payment.proof.url.length?(d(),a("div",to,[e("a",{href:o.form.payment.proof.file?o.form.payment.proof.url:"/storage/proof_of_payment/"+o.form.payment.proof.url,download:"",class:"flex items-center space-x-2 text-indigo-500 hover:text-indigo-600"},[ao,e("span",null,u(o.form.payment.proof.file?o.form.payment.proof.file.name:o.form.payment.proof.url),1)],8,ro),e("div",no,[e("button",{type:"button",class:"rounded-md p-2 bg-red-500 text-white",onClick:t[16]||(t[16]=s=>o.deleteProof())},io)])])):(d(),a("div",eo,[e("label",oo,[so,e("input",{type:"file",ref:"file_input",class:h(["focus:ring-0 border rounded-md block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:border-0 file:text-sm file:font-semibold file:bg-gray-200 file:text-gray-700 focus:outline-none",o.$page.props.errors.proof?"border-red-300":"border-gray-300"]),onChange:t[15]||(t[15]=(...s)=>o.uploadFile&&o.uploadFile(...s))},null,34)])]))])]),e("div",mo,[uo,e("div",po,[l(e("textarea",{type:"text",name:"transaction_id",id:"transaction_id",class:h(["focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm",o.$page.props.errors.transaction_id?"border-red-300":"border-gray-300"]),"onUpdate:modelValue":t[17]||(t[17]=s=>o.form.payment.remark=s),autocomplete:"off"},null,2),[[i,o.form.payment.remark]])])])])])])]),e("div",co,[e("div",fo,[e("div",_o,[e("div",bo,[e("div",go,[f(w,{buttonType:"gray",route:o.route("fee.invoices",o.$page.props.params)},{default:y(()=>[v("Cancel")]),_:1},8,["route"]),f(w,{type:"submit"},{default:y(()=>[v("Save")]),_:1})])])])])])])],32)])])]),_:1})],64))}});export{Do as default};
