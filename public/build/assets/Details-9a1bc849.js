import{B as j}from"./Authenticated-c6c44436.js";import{B as T}from"./Button-d134789c.js";import{r as D}from"./PencilIcon-8d9147ed.js";import{r as S}from"./SearchIcon-1ffa6b4e.js";import{r as M}from"./TrashIcon-4b2d8553.js";import{o as c,c as d,b as y,u as g,w,F as u,H as C,L,ab as k,d as t,j as P,h as x,t as n,n as $,k as R}from"./app-6cd5c775.js";import{C as z}from"./ConfirmationModal-906ced87.js";import{P as F}from"./Pagination-19930078.js";import{h as f}from"./moment-fbc5633a.js";import{s as E}from"./multiselect-9ba7d4a5.js";import{M as I}from"./Modal-6caa5570.js";import"./auto-65a5f8f0.js";import{p as V,d as Y}from"./dom-to-image-b628ce37.js";import{C as A}from"./chart-30d8fb54.js";import"./ApplicationLogo-4eadbb82.js";import"./XIcon-f206e72e.js";import"./toggle-721a87ac.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./transition-77518535.js";import"./VueFinalModal.esm-cffa6594.js";/* empty css                                                              */const O={class:"py-4 px-4"},N={class:"mx-auto"},Z={class:"align-middle inline-block min-w-full"},W={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},q={class:"min-w-full divide-y divide-gray-200"},H=t("thead",{class:"bg-gray-300"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/14"},"#"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-3/14"},"Level"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-2/14"},"Result"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-2/14"},"Date Taken"),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider w-2/14"},"Action")])],-1),G={class:"bg-white divide-y divide-gray-200"},Q={key:0},J=t("td",{class:"text-center",colspan:"10"},[t("div",{class:"p-3"}," No Record Found! ")],-1),K=[J],U={class:"px-6 py-4 whitespace-nowrap"},X={class:"text-sm font-medium text-gray-700"},tt={class:"px-6 py-4 whitespace-nowrap"},et={class:"text-sm font-medium text-gray-900"},st={class:"px-6 py-4 whitespace-nowrap"},at={class:"text-sm font-medium text-gray-900"},rt={class:"px-6 py-4 whitespace-nowrap"},ot={class:"text-sm font-medium text-gray-900"},it={class:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium"},nt={class:"flex justify-center space-x-2"},ct={key:0,class:"flex items-center space-x-2"},dt=t("svg",{class:"inline-block h-4 w-4 animate-spin rounded-full border-2 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]",viewBox:"0 0 24 24"},null,-1),lt=t("span",null,"Generating...",-1),ht=[dt,lt],pt={key:1},_t={class:"relative overflow-hidden w-[210mm]"},mt={class:"absolute flex flex-col justify-between space-y-2 bg-white p-3 py-5",id:"report",ref:"report"},gt={class:"grid grid-rows-1"},ut={class:"flex justify-center"},ft={class:"font-bold text-slate-800 text-xl py-5 uppercase"},yt={class:"grid grid-rows-1"},wt={class:"grid grid-cols-2 px-4 space-x-4"},xt={class:"flex items-center justify-center rounded-lg"},bt={id:"scatter-chart",ref:"scatterChart",class:"hidden m-0"},vt={id:"bar-chart",ref:"barChart",class:"hidden m-0"},kt={class:"p-6 rounded-lg"},At={class:"mt-2 space-y-3"},Ct={class:"flex justify-between text-sm font-medium"},Bt=t("dt",{class:"text-gray-500 min-w-[70px]"},"Name : ",-1),jt={class:"text-gray-900 break-word"},Tt={class:"flex justify-between text-sm font-medium"},Dt=t("dt",{class:"text-gray-500"},"Age :",-1),St={class:"text-gray-900"},Mt={class:"flex justify-between text-sm font-medium"},Lt=t("dt",{class:"text-gray-500"},"Result :",-1),Pt={class:"text-gray-900"},$t={class:"flex justify-between text-sm font-medium"},Rt=t("dt",{class:"text-gray-500"},"Date / Time",-1),zt={class:"text-gray-900"},Ft={class:"grid grid-cols-1 px-4 space-x-4"},Et={class:"flex items-center p-2 text-sm text-gray-800 border border-gray-300 rounded-lg bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600",role:"alert"},It=t("svg",{class:"flex-shrink-0 inline w-4 h-4 me-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})],-1),Vt={class:"flex flex-col text-sm"},Yt={class:"grid grid-rows-1"},Ot={class:"grid grid-cols-1"},Nt={class:"flex justify-center px-4"},Zt={class:"w-full"},Wt=t("thead",{class:"text-xs font-semibold uppercase text-gray-400 bg-indigo-100"},[t("tr",null,[t("th",{class:"p-2 whitespace-nowrap border-2 rounded-tr",width:"3"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"#")]),t("th",{class:"p-2 whitespace-nowrap border-2"},[t("div",{class:"flex font-semibold justify-center text-gray-700"},"Question")]),t("th",{class:"p-2 whitespace-nowrap border-2 w-8"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"Result")])])],-1),qt={class:"text-sm divide-y divide-gray-100"},Ht={class:"p-1 whitespace-nowrap border-2 text-center align-middle"},Gt={class:"p-1 whitespace-nowrap border-2 align-middle"},Qt={class:"flex flex-col flex-wrap"},Jt={class:"whitespace-normal font-semibold"},Kt={key:0,class:"flex items-center"},Ut={class:"whitespace-normal font-semibold"},Xt={key:1,class:"whitespace-normal font-semibold"},te={class:"p-1 whitespace-nowrap border-2 text-center align-middle"},ee={class:"flex justify-center"},se={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-check-circle-fill text-green-500",viewBox:"0 0 16 16"},ae=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"},null,-1),re=[ae],oe={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-x-circle-fill text-red-500",viewBox:"0 0 16 16"},ie=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"},null,-1),ne=[ie],ce={id:"canvas",ref:"canvas",style:{display:"none"}},de={components:{SearchIcon:S,TrashIcon:M,PencilIcon:D,ConfirmationModal:z,Head:C,Link:L,Multiselect:E,Modal:I,Pagination:F},props:{filter:Object},data(){return{current_chart_type:"",processing:!1,processing_item:[],bar_chart:"",scatter_chart:"",chart_image:"",show_report:!1,report:{title:"",name:"",age:"",result:"",datetime:""},params:{search:this.filter.search?this.filter.search:""},chart_data:{categories:{label:[],data:[]},total_answers:4},answer_data:[]}},watch:{params:{handler(){this.params&&this.$inertia.get(this.route("diagnostic_test.saved_result.details"),this.params,{replace:!0,preserveState:!0})},deep:!0}},methods:{async waitTwoSeconds(){await new Promise(r=>setTimeout(r,2e3))},viewReport(r,s,i,e){this.current_chart_type=e,this.processing=!0,this.processing_item[r].process=!0,this.chart_data.total_answers=i,this.bar_chart&&this.bar_chart.destroy(),this.scatter_chart&&this.scatter_chart.destroy(),this.displayChart(r,s,e)},displayChart(r,s,i){k.get(route("diagnostic_test.get_dt_categories"),{params:{dt_id:s,chart_type:i}}).then(e=>{this.chart_data.categories.label=e.data.label,this.chart_data.categories.data=e.data.data,this.chart_data.categories.data=this.splitResultByCategory(r),this.chart_data.categories.info=e.data.info,this.initChart(i),this.initAnswers(r),this.initInfos(r)}).catch(e=>{console.error(e)})},initChart(r){if(r==1){let i=document.getElementById("bar-chart").getContext("2d");const e=new A(i,{type:"bar",data:{labels:this.chart_data.categories.label,datasets:[{data:this.chart_data.categories.data,backgroundColor:["#7B66FF","#39A7FF","#508D69","#ED5AB3"],borderWidth:1}]},options:{animation:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1},datalabels:{display:!1}},scales:{y:{min:0,max:3,stepSize:1,ticks:{beginAtZero:!0}},x:{display:!1,min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}}},ticks:{precision:0}},plugins:[V]});this.bar_chart=e}if(r==2){const s=this.chart_data.total_answers,i={id:"scatterArbitraryLine",beforeDatasetDraw(p,a,h){const{ctx:m,chartArea:{top:le,bottom:he,left:pe,right:_e,width:me,height:ge},scales:{x:b,y:v}}=p;B();function B(ue,fe,ye,we){m.save(),m.beginPath(),m.strokeStyle="rgba(170, 170, 170, 1)",m.lineWidth=3,m.moveTo(b.getPixelForValue(0),v.getPixelForValue(0)),m.lineTo(b.getPixelForValue(s),v.getPixelForValue(s)),m.stroke(),m.restore()}}},e={id:"scatterAnnotationLine",beforeDraw:p=>{if(p.tooltip._active&&p.tooltip._active.length){const a=p.ctx;a.save();const h=p.tooltip._active[0];a.beginPath(),a.moveTo(h.element.x,p.chartArea.top),a.lineTo(h.element.x,h.element.y),a.lineWidth=2,a.strokeStyle="white",a.stroke(),a.restore(),a.beginPath(),a.moveTo(h.element.x,h.element.y),a.lineTo(h.element.x,p.chartArea.bottom),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore(),a.beginPath(),a.moveTo(p.chartArea.left,h.element.y),a.lineTo(h.element.x,h.element.y),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore()}}};let l=document.getElementById("scatter-chart").getContext("2d");const _=new A(l,{type:"scatter",data:{labels:this.chart_data.total_answers,datasets:[{data:[{x:this.chart_data.categories.data[0],y:this.chart_data.categories.data[1]}],borderColor:"rgba(255, 8, 0, 1)",pointStyle:"crossRot",radius:6,hoverRadius:10,fill:!1}]},options:{animation:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1}},scales:{y:{min:0,max:5,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Operations"}},x:{min:0,max:5,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Numbers"}}},ticks:{precision:0}},plugins:[i,e]});this.scatter_chart=_}},splitResultByCategory(r){const i=this.$page.props.answer_record.data[r].answer_record.filter(o=>o.correct).reduce((o,l)=>(l.correct&&(o[l.question_category_id]?o[l.question_category_id]++:o[l.question_category_id]=1),o),{}),e={};return Object.keys(i).forEach((o,l)=>{e[l]=i[o]}),Object.values(e)},initAnswers(r){this.answer_data=this.$page.props.answer_record.data[r].answer_record},initInfos(r){k.post(route("diagnostic_test.get_saved_result_info"),{result_id:this.$page.props.result_id}).then(s=>{this.report.title=this.$page.props.answer_record.data[r].dt_name,this.report.name=s.data.child_name,this.report.age=s.data.child_age,this.report.result=this.$page.props.answer_record.data[r].total_correct_answers+"/"+this.$page.props.answer_record.data[r].total_answers,this.report.datetime=f(s.data.created_at).format("DD/MM/YYYY, hh:mm A"),document.getElementById("report").style.display="block";var i=document.getElementById("report"),e=!0;setTimeout(()=>{var o=2;e=!1,Y.toPng(i,{width:i.clientWidth*o,height:i.clientHeight*o,style:{transform:"scale("+o+")",transformOrigin:"top left"}}).then(function(l){var _=document.createElement("a");_.href=l,_.download="Diagnostic Test Report.png",_.style.display="none",document.body.appendChild(_),_.click(),document.body.removeChild(_)}).catch(function(l){console.error("oops, something went wrong!",l)})}),e&&(this.processing=!1,this.processing_item[r].process=!1)}).catch(s=>{console.error(s)})}},created(){this.$page.props.answer_record.data.map(()=>{this.processing_item.push({process:!1})})}},Ye=Object.assign(de,{__name:"Details",setup(r){return(s,i)=>(c(),d(u,null,[y(g(C),{title:"Diagnostic Test"}),y(j,null,{header:w(()=>[]),default:w(()=>[t("div",O,[t("div",N,[t("div",Z,[t("div",W,[t("table",q,[H,t("tbody",G,[s.$page.props.answer_record.data.length?P("",!0):(c(),d("tr",Q,K)),(c(!0),d(u,null,x(s.$page.props.answer_record.data,(e,o)=>(c(),d("tr",{class:"hover:bg-gray-200",key:e.id},[t("td",U,[t("div",X,n(o+1),1)]),t("td",tt,[t("div",et,n(e.dt_name),1)]),t("td",st,[t("div",at,n(e.total_correct_answers+"/"+e.total_answers),1)]),t("td",rt,[t("div",ot,n(g(f)(e.created_at).format("DD/MM/YYYY")),1)]),t("td",it,[t("div",nt,[y(T,{buttonType:"blue",class:"py-1 px-2",onClick:l=>!s.processing_item[o].process&&!s.processing?s.viewReport(o,e.dt_id,e.total_answers,e.chart_type):""},{default:w(()=>[s.processing_item[o].process&&s.processing?(c(),d("div",ct,ht)):(c(),d("span",pt,"View Report"))]),_:2},1032,["onClick"])])])]))),128))])]),t("div",_t,[t("div",mt,[t("div",gt,[t("div",ut,[t("h1",ft,"Diagnostic Test "+n(s.report.title),1)])]),t("div",yt,[t("div",wt,[t("div",xt,[t("canvas",bt,null,512),t("canvas",vt,null,512)]),t("div",kt,[t("dl",At,[t("div",Ct,[Bt,t("dd",jt,n(s.report.name),1)]),t("div",Tt,[Dt,t("dd",St,n(s.report.age),1)]),t("div",Mt,[Lt,t("dd",Pt,n(s.report.result),1)]),t("div",$t,[Rt,t("dd",zt,n(g(f)(s.report.datetime).format("DD/MM/Y"))+" - "+n(g(f)(s.report.datetime).format("h:mm A")),1)])])])]),t("div",Ft,[t("div",Et,[It,t("div",Vt,[(c(!0),d(u,null,x(s.chart_data.categories.info,e=>(c(),d("span",null,[t("span",{class:$(["font-semibold","text-["+e.category_color+"]"])},n(e.category_name)+":",3),R(" "+n(e.category_description),1)]))),256))])])])]),t("div",Yt,[t("div",Ot,[t("div",Nt,[t("table",Zt,[Wt,t("tbody",qt,[(c(!0),d(u,null,x(s.answer_data,(e,o)=>(c(),d("tr",null,[t("td",Ht,n(++o),1),t("td",Gt,[t("div",Qt,[t("p",Jt,n(e.question),1),e.answer?(c(),d("div",Kt,[t("p",Ut,"Answer: "+n(e.answer.toString())+" ",1)])):(c(),d("p",Xt,"Answer: "+n(e.answer+1),1))])]),t("td",te,[t("div",ee,[e.correct?(c(),d("svg",se,re)):(c(),d("svg",oe,ne))])])]))),256))])])])])])],512)])])])])]),t("canvas",ce,null,512)]),_:1})],64))}});export{Ye as default};
