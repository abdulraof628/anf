import{c as i,b as c,u as b,w as p,F as f,H as w,L as V,ag as $,o as l,d as e,e as F,f as r,l as n,h,t as m,j as _,g as D,n as g,D as U,k as y}from"./app-c0ce435d.js";import{B as C}from"./Authenticated-395bc6e6.js";import{B as v}from"./Button-465ea343.js";import{h as x}from"./moment-fbc5633a.js";import{Z as L}from"./main-62678cea.js";import"./ApplicationLogo-39485cc1.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./XIcon-084af2a1.js";import"./default.css_vue_type_style_index_0_src_true_lang-a2b621a6.js";const O={class:"md:grid md:grid-cols-2"},M={class:"md:mt-0 md:col-span-2"},B={class:"px-4 py-5 bg-indigo-50 space-y-6 sm:p-6"},I={class:"grid grid-rows-1 grid-cols-2 sm:grid-cols-2 gap-4"},P={class:"sm:row-span-3"},S={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-md h-full"},N=e("div",{class:"mb-5"},[e("h1",{class:"font-bold text-indigo-800"},"Invoice Information"),e("div",{class:"border-b border-dashed border-indigo-900 mt-1"})],-1),j={class:"grid grid-cols-1"},z={class:"mb-4"},T=e("label",{for:"invoice_number",class:"block text-sm font-bold text-gray-700"}," Invoice Number ",-1),A={class:"mt-1 flex rounded-md shadow-sm"},E={class:"grid grid-cols-1"},W={class:"mb-4"},H=e("label",{for:"student_name",class:"block text-sm font-bold text-gray-700"}," Student Name ",-1),R={class:"mt-1 flex rounded-md shadow-sm"},Y={class:"grid grid-cols-2 gap-4"},Z={class:"mb-4"},J=e("label",{for:"date_issued",class:"block text-sm font-bold text-gray-700"}," Date Issued ",-1),q={class:"mt-1 flex rounded-md shadow-sm"},G={class:"mb-4"},K=e("label",{for:"due_date",class:"block text-sm font-bold text-gray-700"}," Due Date ",-1),Q={class:"mt-1 flex rounded-md shadow-sm"},X={class:"grid grid-cols-1"},ee={class:"mb-10"},oe=e("thead",null,[e("tr",{class:"bg-gray-600"},[e("th",{class:"text-left text-white text-sm py-2 px-4 w-1/12"},"#"),e("th",{class:"text-left text-white text-sm py-2 px-4 w-7/12"},"Programme"),e("th",{class:"text-left text-white text-sm py-2 px-4 w-2/12"},"Discount"),e("th",{class:"text-left text-white text-sm py-2 px-4 w-2/12"},"Amount")])],-1),te={class:"border text-sm align-top py-2 px-4"},se={class:"border text-sm py-2 px-4"},de={class:"flex flex-col space-y-4"},ae={class:"bg-indigo-300 py-2 px-3 rounded-t-md"},ie={class:"font-semibold"},le={class:"flex flex-col space-y-2 pl-5"},re={class:"bg-indigo-100 py-1 px-3 rounded-sm"},ne={key:0,class:"bg-indigo-100 py-1 px-3 rounded-sm"},me=e("label",null," Material Fee ",-1),ce=[me],pe={class:"border text-sm py-2 px-4 align-bottom"},ue={class:"flex flex-col space-y-1.5"},fe=["onUpdate:modelValue"],_e=["onUpdate:modelValue"],ge={class:"border text-sm py-2 px-4 align-bottom"},be={class:"flex flex-col space-y-1.5"},he=["onUpdate:modelValue"],ye=["onUpdate:modelValue"],ve=e("div",{class:"border-b border-dashed border-indigo-900 mb-5"},null,-1),xe={class:"grid grid-cols-3"},we={class:"mb-4 text-left"},ke=e("label",{for:"payment_status",class:"block text-sm font-bold text-gray-700"}," Payment Status ",-1),Ve=["value"],$e=e("div",{class:"mb-4"},null,-1),Fe={class:"mb-4 text-right pr-5"},De=e("label",{for:"amount",class:"block text-md font-bold text-gray-700"}," Total Amount",-1),Ue={class:"text-2xl font-bold text-indigo-500"},Ce={class:"sm:row-span-3"},Le={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-md h-full"},Oe=e("div",{class:"mb-5"},[e("h1",{class:"font-bold text-indigo-800"},"Collect Payment"),e("div",{class:"border-b border-dashed border-indigo-900 mt-1"})],-1),Me={class:"grid grid-cols-1"},Be={class:"mb-4"},Ie=e("label",{for:"date",class:"block text-sm font-bold text-gray-700"}," Date ",-1),Pe={class:"mt-1 flex rounded-md shadow-sm"},Se={class:"mb-4"},Ne=e("label",{for:"transaction_id",class:"block text-sm font-bold text-gray-700"}," Transaction ID ",-1),je={class:"mt-1 flex rounded-md shadow-sm"},ze={class:"grid grid-cols-1"},Te={class:"mb-4"},Ae=e("label",{for:"student_name",class:"block text-sm font-bold text-gray-700"}," Proof of Payment ",-1),Ee={class:"mt-1 items-center space-x-2 w-full"},We={key:0,class:"mb-4"},He={class:"block focus:ring-0 focus:border-gray-300"},Re=e("span",{class:"sr-only"},"Browse File",-1),Ye={key:1,class:"flex justify-between py-2 border bg-gray-50 shadow-md p-4 rounded-md"},Ze=["href"],Je=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 448 512"},[e("path",{d:"M364.2 83.8c-24.4-24.4-64-24.4-88.4 0l-184 184c-42.1 42.1-42.1 110.3 0 152.4s110.3 42.1 152.4 0l152-152c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-152 152c-64 64-167.6 64-231.6 0s-64-167.6 0-231.6l184-184c46.3-46.3 121.3-46.3 167.6 0s46.3 121.3 0 167.6l-176 176c-28.6 28.6-75 28.6-103.6 0s-28.6-75 0-103.6l144-144c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-144 144c-6.7 6.7-6.7 17.7 0 24.4s17.7 6.7 24.4 0l176-176c24.4-24.4 24.4-64 0-88.4z"})],-1),qe={class:"flex"},Ge=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",fill:"currentColor",class:"text-white h-3 w-3"},[e("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})],-1),Ke=[Ge],Qe={class:"grid grid-rows-1 grid-cols-1 sm:grid-cols-1 gap-4"},Xe={class:"sm:row-span-3"},eo={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-md"},oo={class:"flex items-center justify-end"},to={class:"flex space-x-2"},so={components:{Head:w,Link:V,Viewer:$},data(){return{date_issued:x(this.$page.props.invoice_data.date_issued).format("DD MMM Y"),due_date:x(this.$page.props.invoice_data.due_date).format("DD MMM Y"),form:{invoice_id:this.$page.props.invoice_data.id,invoice_items:JSON.parse(this.$page.props.invoice_data.invoice_items),invoice_amount:this.$page.props.invoice_data.amount,payment:{status:this.$page.props.invoice_data.status,date:this.$page.props.invoice_data.payment_date,transaction_id:this.$page.props.invoice_data.payment_transaction_id,proof:{url:this.$page.props.invoice_data.payment_proof?this.$page.props.invoice_data.payment_proof:"",file:"",delete_previous:!1}}}}},watch:{"form.invoice_items":{handler(a){a.forEach(o=>{o.programme_fee||(o.programme_fee=0),o.programme_fee_discount||(o.programme_fee_discount=0),o.material_fee||(o.material_fee=0),o.material_fee_discount||(o.material_fee_discount=0)})},deep:!0}},methods:{submit(){this.form.invoice_amount=this.totalFee(this.form.invoice_items),this.$inertia.post(route("fee.invoices.update"),this.form,{preserveState:!0})},numbersOnly(a){a=a||window.event;var o=a.which?a.which:a.keyCode;if(o>31&&(o<48||o>57)&&o!==46)a.preventDefault();else{let t=a.target.value.trim();return t===""?t="0":t!=="0"&&t.startsWith("0")&&(t=t.replace(/^0+/,"")),a.target.value=t!==""?t:"0",!0}},totalFee(a){let o=0;for(const t of a){const s=parseFloat(t.programme_fee),u=parseFloat(t.programme_fee_discount),d=parseFloat(t.material_fee),k=parseFloat(t.material_fee_discount);o+=s-u,t.include_material_fee&&(o+=d-k)}return o},deleteProof(){this.form.payment.proof.url=[],this.form.payment.proof.file="",this.form.payment.proof.delete_previous=!0},uploadFile(a){const o=a.target.files[0];o.type=="application/pdf"||o.name.toLowerCase().endsWith(".pdf")||o.type=="image/jpeg"||o.name.toLowerCase().endsWith(".png")?(this.form.payment.proof.url=[URL.createObjectURL(o)],this.form.payment.proof.file=o):(alert("Only Image / PDF File allowed!"),this.$refs.file_input.value="",this.form.payment.proof.url="",this.form.payment.proof.file="")}}},fo=Object.assign(so,{__name:"Edit",setup(a){return(o,t)=>(l(),i(f,null,[c(b(w),{title:"Fee Invoices"}),c(C,null,{header:p(()=>[]),default:p(()=>[e("div",O,[e("div",M,[e("form",{onSubmit:t[13]||(t[13]=F((...s)=>o.submit&&o.submit(...s),["prevent"]))},[e("div",B,[e("div",I,[e("div",P,[e("div",S,[N,e("div",j,[e("div",z,[T,e("div",A,[r(e("input",{disabled:"",type:"text",name:"invoice_number",id:"invoice_number",class:"focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 bg-gray-100","onUpdate:modelValue":t[0]||(t[0]=s=>this.$page.props.invoice_data.invoice_number=s),autocomplete:"off"},null,512),[[n,this.$page.props.invoice_data.invoice_number]])])])]),e("div",E,[e("div",W,[H,e("div",R,[r(e("input",{disabled:"",type:"text",name:"student_name",id:"student_name",class:"focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 bg-gray-100","onUpdate:modelValue":t[1]||(t[1]=s=>this.$page.props.invoice_data.student_name=s),autocomplete:"off"},null,512),[[n,this.$page.props.invoice_data.student_name]])])])]),e("div",Y,[e("div",Z,[J,e("div",q,[r(e("input",{disabled:"",type:"text",name:"date_issued",id:"date_issued",class:"focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 bg-gray-100","onUpdate:modelValue":t[2]||(t[2]=s=>o.date_issued=s),autocomplete:"off"},null,512),[[n,o.date_issued]])])]),e("div",G,[K,e("div",Q,[r(e("input",{disabled:"",type:"text",name:"due_date",id:"due_date",class:"focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 bg-gray-100","onUpdate:modelValue":t[3]||(t[3]=s=>o.due_date=s),autocomplete:"off"},null,512),[[n,o.due_date]])])])]),e("div",X,[e("div",ee,[e("table",null,[oe,e("tbody",null,[(l(!0),i(f,null,h(o.form.invoice_items,(s,u)=>(l(),i("tr",null,[e("td",te,m(u+1),1),e("td",se,[e("div",de,[e("div",ae,[e("label",ie,m(s.programme_name)+" ( Level "+m(s.programme_level)+" )",1)]),e("div",le,[e("div",re,[e("label",null,m(s.programme_type),1)]),s.include_material_fee?(l(),i("div",ne,ce)):_("",!0)])])]),e("td",pe,[e("div",ue,[r(e("input",{type:"number",min:"0",name:"",id:"",class:"py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300","onUpdate:modelValue":d=>s.programme_fee_discount=d,autocomplete:"off",onInput:t[4]||(t[4]=(...d)=>o.numbersOnly&&o.numbersOnly(...d))},null,40,fe),[[n,s.programme_fee_discount]]),s.include_material_fee?r((l(),i("input",{key:0,type:"number",min:"0",name:"",id:"",class:"py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300","onUpdate:modelValue":d=>s.material_fee_discount=d,autocomplete:"off",onInput:t[5]||(t[5]=(...d)=>o.numbersOnly&&o.numbersOnly(...d))},null,40,_e)),[[n,s.material_fee_discount]]):_("",!0)])]),e("td",ge,[e("div",be,[r(e("input",{type:"number",min:"0",name:"",id:"",class:"py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300","onUpdate:modelValue":d=>s.programme_fee=d,autocomplete:"off",onInput:t[6]||(t[6]=(...d)=>o.numbersOnly&&o.numbersOnly(...d))},null,40,he),[[n,s.programme_fee]]),s.include_material_fee?r((l(),i("input",{key:0,type:"number",min:"0",name:"",id:"",class:"py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300","onUpdate:modelValue":d=>s.material_fee=d,autocomplete:"off",onInput:t[7]||(t[7]=(...d)=>o.numbersOnly&&o.numbersOnly(...d))},null,40,ye)),[[n,s.material_fee]]):_("",!0)])])]))),256))])])])]),ve,e("div",xe,[e("div",we,[ke,r(e("select",{name:"payment_status",id:"payment_status",class:"mt-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300",autocomplete:"off","onUpdate:modelValue":t[8]||(t[8]=s=>o.form.payment.status=s)},[(l(!0),i(f,null,h(o.$page.props.invoice_status,s=>(l(),i("option",{value:s.id},m(s.name),9,Ve))),256))],512),[[D,o.form.payment.status]])]),$e,e("div",Fe,[De,e("span",Ue,m(o.totalFee(this.form.invoice_items)),1)])])])]),e("div",Ce,[e("div",Le,[Oe,e("div",Me,[e("div",Be,[Ie,e("div",Pe,[c(b(L),{class:g("focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm"),style:U(o.$page.props.errors.date?"--dp-border-color: #fa9e9e":""),"input-class-name":"date-picker",modelValue:o.form.payment.date,"onUpdate:modelValue":t[9]||(t[9]=s=>o.form.payment.date=s),enableTimePicker:!1,"auto-apply":!0},null,8,["style","modelValue"])])]),e("div",Se,[Ne,e("div",je,[r(e("input",{type:"text",name:"transaction_id",id:"transaction_id",class:g(["focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm",o.$page.props.errors.transaction_id?"border-red-300":"border-gray-300"]),"onUpdate:modelValue":t[10]||(t[10]=s=>o.form.payment.transaction_id=s),autocomplete:"off"},null,2),[[n,o.form.payment.transaction_id]])])])]),e("div",ze,[e("div",Te,[Ae,e("div",Ee,[o.form.payment.proof.url.length?(l(),i("div",Ye,[e("a",{href:o.form.payment.proof.file?o.form.payment.proof.url:"/storage/proof_of_payment/"+o.form.payment.proof.url,download:"",class:"flex items-center space-x-2 text-indigo-500 hover:text-indigo-600"},[Je,e("span",null,m(o.form.payment.proof.file?o.form.payment.proof.file.name:o.form.payment.proof.url),1)],8,Ze),e("div",qe,[e("button",{type:"button",class:"rounded-md p-2 bg-red-500 text-white",onClick:t[12]||(t[12]=s=>o.deleteProof())},Ke)])])):(l(),i("div",We,[e("label",He,[Re,e("input",{type:"file",ref:"file_input",class:g(["focus:ring-0 border rounded-md block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:border-0 file:text-sm file:font-semibold file:bg-gray-200 file:text-gray-700 focus:outline-none",o.$page.props.errors.proof?"border-red-300":"border-gray-300"]),onChange:t[11]||(t[11]=(...s)=>o.uploadFile&&o.uploadFile(...s))},null,34)])]))])])])])])]),e("div",Qe,[e("div",Xe,[e("div",eo,[e("div",oo,[e("div",to,[c(v,{buttonType:"gray",route:o.route("fee.invoices")},{default:p(()=>[y("Cancel")]),_:1},8,["route"]),c(v,{type:"submit"},{default:p(()=>[y("Save")]),_:1})])])])])])])],32)])])]),_:1})],64))}});export{fo as default};
