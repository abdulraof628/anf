import{B as I}from"./Authenticated-89c7332d.js";import{H as P,L as M}from"./@inertiajs-2b766590.js";import{_ as F}from"./Card-b75ae06b.js";import{_ as B}from"./DialogModal-6d0aecd6.js";import{_ as q}from"./Collapsible-08c65aae.js";import{_ as A,d as E,e as h,c as v,a as N,b as k}from"./TableRow-da22b5e6.js";import{_ as D}from"./TableCaption-43844f83.js";import{_ as O}from"./DeleteConfirmation-b2aa0ec0.js";import{C as R}from"./lucide-vue-next-7b48dc26.js";import{x as _,v as t,u as d,O as r,F as y,b7 as C,q as p,U as a,y as l,I as V,t as U,J as m,B as T}from"./@vue-39dc9ff3.js";import"./ApplicationLogo-5cf6e77e.js";import"./radix-vue-a603168c.js";import"./@floating-ui-c05b1c1f.js";import"./@internationalized-2f03b566.js";import"./class-variance-authority-52f2569e.js";import"./clsx-1229b3e0.js";import"./app-dbb80022.js";import"./axios-1779699b.js";import"./pusher-js-68b5c933.js";import"./@vueform-8fb84cf1.js";import"./@vuepic-a83e4355.js";import"./@babel-1b80a44a.js";import"./cropperjs-042b647f.js";import"./laravel-vite-plugin-d10ca5e8.js";import"./vue-debounce-ed417ae1.js";import"./v-calendar-e9930861.js";import"./tailwind-merge-3f7ff3b1.js";import"./@vueuse-c14271ca.js";import"./@radix-icons-9ff33614.js";import"./lodash.isequal-0acc53e7.js";import"./vue-46d666fa.js";import"./lodash.clonedeep-12c784b4.js";import"./qs-45a3326f.js";import"./side-channel-401220dd.js";import"./get-intrinsic-88feedc6.js";import"./es-errors-82fd953f.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-1353c55e.js";import"./function-bind-61637ca6.js";import"./hasown-bc561cf0.js";import"./call-bind-9ec8ebd8.js";import"./set-function-length-ecd19468.js";import"./define-data-property-d38573ea.js";import"./es-define-property-cfa03815.js";import"./gopd-4c4454f6.js";import"./has-property-descriptors-68e2873e.js";import"./object-inspect-ac0241aa.js";import"./deepmerge-89e33937.js";import"./nprogress-87ee1729.js";const H={class:"grid grid-cols-1 2xl:grid-cols-3 gap-4"},z=l("span",{class:"text-red-500"},"*",-1),J=l("span",{class:"text-red-500"},"*",-1),Y=l("span",{class:"text-red-500"},"*",-1),G={class:"flex justify-between items-center"},K=l("span",{class:"ml-1 hidden sm:block"},"Add",-1),Q=l("div",{class:"p-3"}," No Record Found ",-1),W={class:"text-sm text-gray-700"},X={class:"font-bold"},Z={class:"flex space-x-4 items-center"},x={class:"flex flex-col items-start"},ee={class:"text-sm text-gray-700"},te={class:"font-bold"},re={class:"flex flex-col"},oe={class:"text-sm text-gray-700 font-normal underline"},ae={class:"font-semibold"},ie={class:"text-sm text-gray-700 italic"},se={class:"font-semibold"},le={class:"text-sm text-gray-700 italic"},de={class:"font-semibold"},ne={class:"flex items-center justify-between"},pe={class:"flex space-x-2 items-center"},ue={class:"flex space-x-2"},_e={class:"p-1 grid grid-cols-1 gap-4"},me=l("span",{class:"text-red-500"},"*",-1),fe=l("span",{class:"text-red-500"},"*",-1),ce=l("span",{class:"text-red-500"},"*",-1),he=l("span",{class:"text-red-500"},"*",-1),ve=l("span",{class:"text-red-500"},"*",-1),ge={class:"p-1 grid grid-cols-1 gap-4"},be={key:0},ye=l("span",{class:"text-red-500"},"*",-1),Ve={key:1},$e=l("span",{class:"text-red-500"},"*",-1),we={class:"grid grid-cols-1 gap-4"},Ce=l("span",{class:"text-red-500"},"*",-1),ke={components:{Head:P,Link:M,Table:A,TableBody:E,TableCaption:D,TableCell:h,TableHead:v,TableHeader:N,TableRow:k,DeleteConfirmation:O},mounted(){this.$page.props.programme_info.forEach(i=>{this.form.programme_info.push(i)})},data(){return{levels:Array.from({length:10},(i,e)=>({id:e+1,name:`Level ${e+1}`})),collapsible:{fee:!0,material:!1},confirmation:{is_open:!1,route_name:"",id:""},form:{programme_id:this.$page.props.programme_data?this.$page.props.programme_data.id:"",programme_country:this.$page.props.programme_data?this.$page.props.programme_data.country_id:"",programme_name:this.$page.props.programme_data?this.$page.props.programme_data.name:"",progress_report_required:this.$page.props.programme_data?Number(this.$page.props.programme_data.progress_report_required):"",programme_info:[],programme_active:this.$page.props.programme_data?!!this.$page.props.programme_data.status:!1},fee_form:{level:"",registration_fee:0,material_fee:0,class_type:"",fees:[]},fee_edit_form:{new_item:!1,programme_info_index:"",data:[]},show:{add_fee:!1,edit_fee:!1,product_variations:!1,product_sub_variations:!1,add_tracking_status:!1},list:{products:[],product_variations:[],product_sub_variations:[],class_types_detail:[]},loading:{products:!1,product_variations:!1,product_sub_variations:!1},selected:{product:[],product_variation:[],product_sub_variation:[]},search_product_form:{product_id:"",product_variation_id:"",product_sub_variation_id:""},validation:{level:{required:!0,error:!1},registration_fee:{required:!0,error:!1},material_fee:{required:!0,error:!1},class_type:{required:!0,error:!1},product:{required:!1,error:!1},product_variation:{required:!1,error:!1},product_sub_variation:{required:!1,error:!1}}}},watch:{"form.programme_info":{handler(){this.groupedItems},deep:!0},"fee_form.class_type":{handler(){this.list.class_types_detail=[],this.fee_form.fees=[],this.$page.props.class_types_detail.forEach(i=>{i.class_type_id==this.fee_form.class_type&&(this.list.class_types_detail.push(i),this.fee_form.fees.push({class_type_detail_id:i.id,value:1,new_fee_amount:1}))})},deep:!0},"search_product_form.product_id":{handler(){this.search_product_form.product_id&&(this.selected.product=this.list.products.find(i=>i.id===this.search_product_form.product_id),this.show.product_variations=this.selected.product.has_variation==1,this.show.product_sub_variations=this.selected.product.has_sub_variation==1,this.search_product_form.product_variation_id="",this.search_product_form.product_sub_variation_id="",this.selected.product_variation=[],this.selected.product_sub_variation=[])}},"search_product_form.product_variation_id":{handler(){this.search_product_form.product_variation_id&&(this.selected.product_variation=this.list.product_variations.find(i=>i.id===this.search_product_form.product_variation_id),this.search_product_form.product_sub_variation_id="",this.selected.product_sub_variation=[])}},"search_product_form.product_sub_variation_id":{handler(){this.search_product_form.product_sub_variation_id&&(this.selected.product_sub_variation=this.list.product_sub_variations.find(i=>i.id===this.search_product_form.product_sub_variation_id))}}},computed:{groupedItems(){return this.form.programme_info.reduce((i,e,o)=>(i[e.level]||(i[e.level]=[]),i[e.level].push({...e,index:o}),i),{})}},methods:{submit(){this.$inertia.post(route("programmes.update"),this.form)},showAddFee(){this.search_product_form.product_id="",this.search_product_form.product_variation_id="",this.search_product_form.product_sub_variation_id="",this.list.products=[],this.list.product_variations=[],this.list.product_sub_variations=[],this.selected.product=[],this.selected.product_variation=[],this.selected.product_sub_variation=[],this.show.product_variations=!1,this.show.product_sub_variations=!1,this.validation.product.error=!1,this.validation.product_variation.required=!1,this.validation.product_variation.error=!1,this.validation.product_sub_variation.required=!1,this.validation.product_sub_variation.error=!1,this.show.add_fee=!0},addFee(){if(this.validation.level.error=this.fee_form.level=="",this.validation.registration_fee.error=this.fee_form.registration_fee==="",this.validation.material_fee.error=this.fee_form.material_fee==="",this.validation.class_type.error=this.fee_form.class_type=="",this.validation.product.error=!!(this.validation.product.required&&!Object.keys(this.selected.product).length),this.validation.product_variation.required=this.selected.product.has_variation==1,this.validation.product_variation.error=this.selected.product.has_variation==1&&!Object.keys(this.selected.product_variation).length,this.validation.product_sub_variation.required=this.selected.product.has_sub_variation==1,this.validation.product_sub_variation.error=this.selected.product.has_sub_variation==1&&!Object.keys(this.selected.product_sub_variation).length,this.validation.product.required&&!Object.keys(this.selected.product).length||this.validation.product_variation.required&&!Object.keys(this.selected.product_variation).length||this.validation.product_sub_variation.required&&!Object.keys(this.selected.product_sub_variation).length||this.fee_form.level==""||this.fee_form.registration_fee===""||this.fee_form.material_fee===""||this.fee_form.class_type==""||this.fee_form.fees.length<1)return;const i=this.fee_form.fees;this.form.programme_info.push({level:this.fee_form.level,registration_fee:this.fee_form.registration_fee,material_fee:this.fee_form.material_fee,class_type:this.fee_form.class_type,fees:i,product:this.selected.product,product_variation:this.selected.product_variation,product_sub_variation:this.selected.product_sub_variation}),this.form.programme_info.sort((e,o)=>e.level-o.level),this.clearForm(),this.show.add_fee=!1},deleteLevel(i,e){if(!i){this.form.programme_info.splice(e,1);return}this.confirmation.route_name="programmes.fee.destroy",this.confirmation.id=i,this.confirmation.is_open=!0},numbersOnly(i){i=i||window.event;var e=i.which?i.which:i.keyCode;if(e>31&&(e<48||e>57)&&e!==46)i.preventDefault();else return!0},clearForm(){this.fee_form.level="",this.fee_form.registration_fee=0,this.fee_form.material_fee=0,this.fee_form.class_type="",this.fee_form.fees=[]},findProducts(i){i&&(this.loading.products=!0,axios.get(route("products.find_products"),{params:{keyword:i}}).then(e=>{this.list.products=e.data,this.loading.products=!1}).finally(()=>{this.scrollToEnd()}))},findProductVariations(){this.loading.product_variations=!0,axios.get(route("products.find_product_variations"),{params:{product_id:this.search_product_form.product_id}}).then(i=>{this.list.product_variations=i.data,this.loading.product_variations=!1}).finally(()=>{this.scrollToEnd()})},findProductSubVariations(){this.loading.product_sub_variations=!0,axios.get(route("products.find_product_sub_variations"),{params:{product_variation_id:this.search_product_form.product_variation_id}}).then(i=>{this.list.product_sub_variations=i.data,this.loading.product_sub_variations=!1}).finally(()=>{this.scrollToEnd()})},scrollToEnd(){setTimeout(()=>{const i=this.$refs.scrollableDiv;i.scrollTop=i.scrollHeight},10)},editFee(i,e,o){this.fee_edit_form.new_item=o,this.fee_edit_form.programme_info_index=e,this.fee_edit_form.data=[],this.fee_edit_form.data=this.groupedItems[i][e].fees,this.show.edit_fee=!0},updateFee(){this.fee_edit_form.new_item?(this.form.programme_info[this.fee_edit_form.programme_info_index].fees=[],this.form.programme_info[this.fee_edit_form.programme_info_index].fees=this.fee_edit_form.data,this.show.edit_fee=!1):this.$inertia.patch(route("programmes.fee.update"),{fee_edit_form:this.fee_edit_form},{preserveState:!1})}}},Vt=Object.assign(ke,{__name:"Edit",setup(i){return(e,o)=>{const u=C("Label"),$=C("Input"),g=C("ComboBox"),c=C("Button"),j=C("Switch");return p(),_(y,null,[t(d(P),{title:"Programmes"}),t(I,null,{header:r(()=>[]),default:r(()=>[t(F,null,{title:r(()=>[a("Programme Information")]),content:r(()=>[l("div",H,[l("div",null,[t(u,null,{default:r(()=>[a("Name"),z]),_:1}),t($,{type:"text",error:e.$page.props.errors.programme_name,modelValue:e.form.programme_name,"onUpdate:modelValue":o[0]||(o[0]=s=>e.form.programme_name=s)},null,8,["error","modelValue"])]),l("div",null,[t(u,null,{default:r(()=>[a("Country"),J]),_:1}),t(g,{items:e.$page.props.countries,"label-property":"name","value-property":"id",error:e.$page.props.errors.programme_country,modelValue:e.form.programme_country,"onUpdate:modelValue":o[1]||(o[1]=s=>e.form.programme_country=s),"select-placeholder":"Select Country","search-placeholder":"Search country..."},null,8,["items","error","modelValue"])]),l("div",null,[t(u,null,{default:r(()=>[a("Progress Report Required"),Y]),_:1}),t(g,{items:[{id:0,name:"No"},{id:1,name:"Yes"}],"label-property":"name","value-property":"id",error:e.$page.props.errors.progress_report_required,modelValue:e.form.progress_report_required,"onUpdate:modelValue":o[2]||(o[2]=s=>e.form.progress_report_required=s),"select-placeholder":"Please Select","search-placeholder":"Search..."},null,8,["error","modelValue"])])])]),_:1}),t(F,null,{title:r(()=>[l("div",G,[a(" Programmes Levels & Fees "),t(c,{buttonType:"info",onClick:e.showAddFee},{default:r(()=>[t(d(R),{class:"h-4 w-4"}),K]),_:1},8,["onClick"])])]),content:r(()=>[(p(!0),_(y,null,V(e.groupedItems,(s,f)=>(p(),U(q,null,{trigger:r(()=>[a("Level "+m(f),1)]),content:r(()=>[t(d(A),{class:"px-4"},{default:r(()=>[t(d(N),{class:"bg-gray-100"},{default:r(()=>[t(d(k),null,{default:r(()=>[t(d(v),{class:"px-4"},{default:r(()=>[a("Class Type")]),_:1}),t(d(v),null,{default:r(()=>[a("Registration Fee")]),_:1}),t(d(v),null,{default:r(()=>[a("Material Fee")]),_:1}),t(d(v),null,{default:r(()=>[a("Monthly Fee (Old)")]),_:1}),t(d(v),null,{default:r(()=>[a("Monthly Fee (New)")]),_:1}),t(d(v),null,{default:r(()=>[a("Material")]),_:1}),t(d(v),{class:"text-center"},{default:r(()=>[a("Action")]),_:1})]),_:1})]),_:1}),t(d(E),null,{default:r(()=>[s.length?T("",!0):(p(),U(d(k),{key:0},{default:r(()=>[t(d(h),{class:"text-center",colspan:"10"},{default:r(()=>[Q]),_:1})]),_:1})),(p(!0),_(y,null,V(s,(n,L)=>(p(),U(d(k),null,{default:r(()=>[t(d(h),{class:"px-4"},{default:r(()=>[a(m(e.$page.props.class_types[s[L].class_type].name),1)]),_:2},1024),t(d(h),null,{default:r(()=>[a(m(n.registration_fee),1)]),_:2},1024),t(d(h),null,{default:r(()=>[a(m(n.material_fee),1)]),_:2},1024),t(d(h),null,{default:r(()=>[(p(!0),_(y,null,V(n.fees,b=>{var w;return p(),_("p",W,[a(m((w=e.$page.props.class_types_detail.find(S=>S.id===b.class_type_detail_id))==null?void 0:w.label)+" : ",1),l("span",X,m(b.value),1)])}),256))]),_:2},1024),t(d(h),null,{default:r(()=>[l("div",Z,[l("div",x,[(p(!0),_(y,null,V(n.fees,b=>{var w;return p(),_("p",ee,[a(m((w=e.$page.props.class_types_detail.find(S=>S.id===b.class_type_detail_id))==null?void 0:w.label)+" : ",1),l("span",te,m(b.new_fee_amount),1)])}),256))]),t(c,{variant:"link",class:"text-blue-500",onClick:b=>e.editFee(f,L,!n.programme_level_id)},{default:r(()=>[a("Edit")]),_:2},1032,["onClick"])])]),_:2},1024),t(d(h),null,{default:r(()=>[l("div",re,[l("p",oe,[l("span",ae,m(n.product.name),1)]),l("p",ie,[a("Variation : "),l("span",se,m(n.product_variation.option_name?n.product_variation.option_name:"-"),1)]),l("p",le,[a("Sub Variation : "),l("span",de,m(n.product_sub_variation.option_name?n.product_sub_variation.option_name:"-"),1)])])]),_:2},1024),t(d(h),{class:"text-center"},{default:r(()=>[t(c,{variant:"destructive",onClick:b=>e.deleteLevel(n.programme_level_id,n.index)},{default:r(()=>[a("Delete")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),t(F,null,{content:r(()=>[l("div",ne,[l("div",pe,[t(u,null,{default:r(()=>[a("Active")]),_:1}),t(j,{modelValue:e.form.programme_active,"onUpdate:modelValue":o[3]||(o[3]=s=>e.form.programme_active=s)},null,8,["modelValue"])]),l("div",ue,[t(c,{variant:"outline",onClick:o[4]||(o[4]=s=>e.$inertia.get(e.route("programmes")))},{default:r(()=>[a("Cancel")]),_:1}),t(c,{onClick:e.submit},{default:r(()=>[a("Save")]),_:1},8,["onClick"])])])]),_:1}),t(B,{open:e.show.add_fee,"onUpdate:open":o[15]||(o[15]=s=>e.show.add_fee=s)},{title:r(()=>[a("Add Fee")]),content:r(()=>[t(q,{modelValue:e.collapsible.fee,"onUpdate:modelValue":o[9]||(o[9]=s=>e.collapsible.fee=s)},{trigger:r(()=>[a("Fee Information")]),content:r(()=>[l("div",_e,[l("div",null,[t(u,null,{default:r(()=>[a("Level"),me]),_:1}),t(g,{items:e.levels,"label-property":"name","value-property":"id",error:e.validation.level.error,modelValue:e.fee_form.level,"onUpdate:modelValue":o[5]||(o[5]=s=>e.fee_form.level=s),"select-placeholder":"Select Level","search-placeholder":"Search level..."},null,8,["items","error","modelValue"])]),l("div",null,[t(u,null,{default:r(()=>[a("Registration Fee"),fe]),_:1}),t($,{type:"number",error:e.validation.registration_fee.error,modelValue:e.fee_form.registration_fee,"onUpdate:modelValue":o[6]||(o[6]=s=>e.fee_form.registration_fee=s)},null,8,["error","modelValue"])]),l("div",null,[t(u,null,{default:r(()=>[a("Material Fee"),ce]),_:1}),t($,{type:"number",error:e.validation.material_fee.error,modelValue:e.fee_form.material_fee,"onUpdate:modelValue":o[7]||(o[7]=s=>e.fee_form.material_fee=s)},null,8,["error","modelValue"])]),l("div",null,[t(u,null,{default:r(()=>[a("Class Type"),he]),_:1}),t(g,{items:Object.values(e.$page.props.class_types),"label-property":"name","value-property":"id",error:e.validation.class_type.error,modelValue:e.fee_form.class_type,"onUpdate:modelValue":o[8]||(o[8]=s=>e.fee_form.class_type=s),"select-placeholder":"Select Class Type","search-placeholder":"Search class type..."},null,8,["items","error","modelValue"])]),(p(!0),_(y,null,V(e.list.class_types_detail,(s,f)=>(p(),_("div",null,[t(u,null,{default:r(()=>[a(m(s.label),1),ve]),_:2},1024),t($,{type:"number",min:"1",error:e.$page.props.errors.class_type_detail,modelValue:e.fee_form.fees[f].value,"onUpdate:modelValue":n=>e.fee_form.fees[f].value=n},null,8,["error","modelValue","onUpdate:modelValue"])]))),256))])]),_:1},8,["modelValue"]),t(q,{modelValue:e.collapsible.material,"onUpdate:modelValue":o[13]||(o[13]=s=>e.collapsible.material=s)},{trigger:r(()=>[a("Material Information")]),content:r(()=>[l("div",ge,[l("div",null,[t(u,null,{default:r(()=>[a("Material")]),_:1}),t(g,{items:e.list.products,"label-property":"name","value-property":"id",error:e.validation.product.error,loading:e.loading.products,onSearch:e.findProducts,onSelect:e.findProductVariations,modelValue:e.search_product_form.product_id,"onUpdate:modelValue":o[10]||(o[10]=s=>e.search_product_form.product_id=s),"select-placeholder":"Select Material","search-placeholder":"Search material..."},null,8,["items","error","loading","onSearch","onSelect","modelValue"])]),e.show.product_variations?(p(),_("div",be,[t(u,null,{default:r(()=>[a("Variation"),ye]),_:1}),t(g,{items:e.list.product_variations,"label-property":"option_name","value-property":"id",loading:e.loading.product_variations,error:e.validation.product_variation.error,onSelect:e.findProductSubVariations,modelValue:e.search_product_form.product_variation_id,"onUpdate:modelValue":o[11]||(o[11]=s=>e.search_product_form.product_variation_id=s),"select-placeholder":"Select Variation","search-placeholder":"Search variation..."},null,8,["items","loading","error","onSelect","modelValue"])])):T("",!0),e.show.product_sub_variations?(p(),_("div",Ve,[t(u,null,{default:r(()=>[a("Sub Variation"),$e]),_:1}),t(g,{items:e.list.product_sub_variations,"label-property":"option_name","value-property":"id",loading:e.loading.product_sub_variations,error:e.validation.product_sub_variation.error,modelValue:e.search_product_form.product_sub_variation_id,"onUpdate:modelValue":o[12]||(o[12]=s=>e.search_product_form.product_sub_variation_id=s),"select-placeholder":"Select Sub Variation","search-placeholder":"Search sub variation..."},null,8,["items","loading","error","modelValue"])])):T("",!0)])]),_:1},8,["modelValue"])]),footer:r(()=>[t(c,{variant:"outline",onClick:o[14]||(o[14]=s=>e.show.add_fee=!1)},{default:r(()=>[a("Cancel")]),_:1}),t(c,{onClick:e.addFee},{default:r(()=>[a("Add")]),_:1},8,["onClick"])]),_:1},8,["open"]),t(B,{open:e.show.edit_fee,"onUpdate:open":o[17]||(o[17]=s=>e.show.edit_fee=s)},{title:r(()=>[a("Edit Fee")]),content:r(()=>[l("div",we,[(p(!0),_(y,null,V(e.fee_edit_form.data,s=>(p(),_("div",null,[t(u,null,{default:r(()=>{var f;return[a(m((f=e.$page.props.class_types_detail.find(n=>n.id===s.class_type_detail_id))==null?void 0:f.label),1),Ce]}),_:2},1024),t($,{type:"number",min:"0",error:e.validation.material_fee.error,modelValue:s.new_fee_amount,"onUpdate:modelValue":f=>s.new_fee_amount=f},null,8,["error","modelValue","onUpdate:modelValue"])]))),256))])]),footer:r(()=>[t(c,{variant:"outline",onClick:o[16]||(o[16]=s=>e.show.edit_fee=!1)},{default:r(()=>[a("Cancel")]),_:1}),t(c,{onClick:e.addFee},{default:r(()=>[a("Add")]),_:1},8,["onClick"])]),_:1},8,["open"]),t(O,{open:e.confirmation.is_open,onClose:o[18]||(o[18]=s=>e.confirmation.is_open=!1),routeName:e.confirmation.route_name,id:e.confirmation.id},{title:r(()=>[a("Delete Data")]),description:r(()=>[a("Are you sure want to delete this data?")]),_:1},8,["open","routeName","id"])]),_:1})],64)}}});export{Vt as default};
