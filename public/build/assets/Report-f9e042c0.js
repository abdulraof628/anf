import{q as n,x as l,v as B,u as j,K as u,L as w,y as t,G as i,F as _,C as x,t as P,P as S,z as T,U as D,V as m}from"./@vue-7927adca.js";import"./Authenticated-53518673.js";import{B as L}from"./Button-4f92316c.js";import{r as $,a as z,b as R}from"./@heroicons-9fa5d0e6.js";import{H as k,L as E}from"./@inertiajs-751b4e3a.js";import{C as F}from"./ConfirmationModal-2b4bc1d7.js";import{P as M}from"./Pagination-c4f5c8ff.js";import{h as b}from"./moment-a9aaa855.js";import{s as I}from"./@vueform-aef92a1c.js";import{a as O}from"./axios-9cbf0d09.js";import{C as v}from"./chart.js-88bb31f9.js";import{p as V}from"./chartjs-plugin-datalabels-c9a3a0fc.js";import{d as Z}from"./dom-to-image-d0c4691f.js";import"./ApplicationLogo-04b49080.js";import"./radix-vue-8d4617bd.js";import"./@floating-ui-1e8ef191.js";import"./class-variance-authority-f96983da.js";import"./app-c7ef466a.js";import"./pusher-js-36ce843e.js";import"./@vuepic-ba9c4d94.js";import"./date-fns-60a02367.js";import"./@babel-1b80a44a.js";import"./cropperjs-8efab0ec.js";import"./laravel-vite-plugin-d10ca5e8.js";import"./vue-debounce-ed417ae1.js";import"./clsx-0839fdbe.js";import"./tailwind-merge-642c57ff.js";import"./@vueuse-e8993a83.js";import"./@radix-icons-9a1732cf.js";import"./lodash.isequal-979ca240.js";import"./vue-446e1be1.js";import"./lodash.clonedeep-a2a90952.js";import"./qs-c5780410.js";import"./side-channel-c3de7aff.js";import"./get-intrinsic-88feedc6.js";import"./es-errors-82fd953f.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-1353c55e.js";import"./function-bind-61637ca6.js";import"./hasown-bc561cf0.js";import"./call-bind-9ec8ebd8.js";import"./set-function-length-ecd19468.js";import"./define-data-property-d38573ea.js";import"./es-define-property-cfa03815.js";import"./gopd-4c4454f6.js";import"./has-property-descriptors-68e2873e.js";import"./object-inspect-30e6e08c.js";import"./deepmerge-89e33937.js";import"./nprogress-2c66c043.js";import"./lucide-vue-next-4cc1c774.js";import"./@headlessui-d829f326.js";import"./@kurkle-b1b89bbc.js";const N={class:"flex flex-col justify-center items-center p-3 space-y-4"},W=t("div",{class:"mt-16"}," Please wait while report is loading... ",-1),H=[W],Y={class:"flex justify-center w-[215mm] mx-2 my-2 md:mx-auto"},q={class:"flex flex-col items-center space-y-4"},G={class:"w-[210mm]"},K={class:"flex flex-col justify-between space-y-2 bg-white p-3",id:"report",ref:"report"},Q={class:"grid grid-rows-1"},U={class:"flex justify-center"},J={class:"font-bold text-slate-800 text-xl py-5 uppercase"},X={class:"grid grid-rows-1"},tt={class:"grid grid-cols-2 px-4 space-x-4"},et={class:"flex items-center justify-center rounded-lg"},st={id:"scatter-chart",ref:"scatterChart",class:"hidden m-0"},rt={id:"bar-chart",ref:"barChart",class:"hidden m-0"},at={class:"p-6 rounded-lg"},ot={class:"mt-2 space-y-3"},it={class:"flex justify-between text-sm font-medium"},nt=t("dt",{class:"text-gray-500 min-w-[70px]"},"Name : ",-1),lt={class:"text-gray-900 break-word"},ct={class:"flex justify-between text-sm font-medium"},dt=t("dt",{class:"text-gray-500"},"Age :",-1),ht={class:"text-gray-900"},pt={class:"flex justify-between text-sm font-medium"},_t=t("dt",{class:"text-gray-500"},"Result :",-1),mt={class:"text-gray-900"},gt={class:"flex justify-between text-sm font-medium"},ft=t("dt",{class:"text-gray-500"},"Date / Time",-1),yt={class:"text-gray-900"},ut={class:"grid grid-cols-1 px-4 space-x-4"},wt={class:"flex items-center p-2 text-sm text-gray-800 border border-gray-300 rounded-lg bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600",role:"alert"},xt=t("svg",{class:"flex-shrink-0 inline w-4 h-4 me-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})],-1),bt={class:"flex flex-col text-xs"},vt={class:"grid grid-rows-1"},kt={class:"grid grid-cols-1"},Ct={class:"flex justify-center px-4"},At={class:"w-full"},Bt=t("thead",{class:"text-xs font-semibold uppercase text-gray-400 bg-indigo-100"},[t("tr",null,[t("th",{class:"p-2 whitespace-nowrap border-2 rounded-tr",width:"3"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"#")]),t("th",{class:"p-2 whitespace-nowrap border-2"},[t("div",{class:"flex font-semibold justify-center text-gray-700"},"Question")]),t("th",{class:"p-2 whitespace-nowrap border-2 w-8"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"Result")])])],-1),jt={class:"text-sm divide-y divide-gray-100"},Pt={class:"p-1 whitespace-nowrap border-2 text-center align-middle text-sm"},St={class:"p-1 whitespace-nowrap border-2 align-middle text-sm"},Tt={class:"flex flex-col flex-wrap"},Dt={class:"whitespace-normal font-semibold"},Lt={key:0,class:"flex items-center"},$t={class:"whitespace-normal font-semibold"},zt={key:0},Rt={key:1},Et={key:1,class:"whitespace-normal font-semibold"},Ft={class:"p-1 whitespace-nowrap border-2 text-center align-middle text-sm"},Mt={class:"flex justify-center"},It={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-check-circle-fill text-green-500",viewBox:"0 0 16 16"},Ot=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"},null,-1),Vt=[Ot],Zt={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-x-circle-fill text-red-500",viewBox:"0 0 16 16"},Nt=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"},null,-1),Wt=[Nt],Ht={components:{SearchIcon:$,TrashIcon:z,PencilIcon:R,ConfirmationModal:F,Head:k,Link:E,Multiselect:I,Pagination:M},props:{filter:Object},data(){return{finish_loading_report:!1,current_chart_type:"",chart_info:[],bar_chart:"",scatter_chart:"",chart_image:"",show_report:!1,report:{title:"",name:"",age:"",result:"",datetime:""},chart_data:{categories:{label:[],data:[],info:[]},total_answers:4},answer_data:[]}},methods:{viewReport(){const o=this.$page.props.answer_record.dt_id,s=this.$page.props.answer_record.total_answers,r=this.$page.props.answer_record.chart_type;this.current_chart_type=r,this.chart_data.total_answers=s,this.bar_chart&&this.bar_chart.destroy(),this.scatter_chart&&this.scatter_chart.destroy(),this.displayChart(o,r)},displayChart(o,s){O.get(route("diagnostic_test.get_dt_categories"),{params:{dt_id:o,chart_type:s}}).then(r=>{this.chart_data.categories.label=r.data.label,this.chart_data.categories.data=r.data.data,this.chart_data.categories.data=this.splitResultByCategory(),this.chart_data.categories.info=r.data.info,this.initChart(s),this.initAnswers(),this.initInfos()}).catch(r=>{console.error(r)})},initChart(o){if(o==1){let r=document.getElementById("bar-chart").getContext("2d");const e=new v(r,{type:"bar",data:{labels:this.chart_data.categories.label,datasets:[{data:this.chart_data.categories.data,backgroundColor:["#7B66FF","#39A7FF","#508D69","#ED5AB3"],borderWidth:1}]},options:{animation:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1},datalabels:{display:!1}},scales:{y:{min:0,max:3,stepSize:1,ticks:{beginAtZero:!0}},x:{display:!1,min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}}},ticks:{precision:0}},plugins:[V]});this.bar_chart=e}if(o==2){const s=this.chart_data.total_answers,r={id:"scatterArbitraryLine",beforeDatasetDraw(d,a,c){const{ctx:h,chartArea:{top:Yt,bottom:qt,left:Gt,right:Kt,width:Qt,height:Ut},scales:{x:f,y}}=d;A();function A(Jt,Xt,te,ee){h.save(),h.beginPath(),h.strokeStyle="rgba(170, 170, 170, 1)",h.lineWidth=3,h.moveTo(f.getPixelForValue(0),y.getPixelForValue(0)),h.lineTo(f.getPixelForValue(s),y.getPixelForValue(s)),h.stroke(),h.restore()}}},e={id:"scatterAnnotationLine",beforeDraw:d=>{if(d.tooltip._active&&d.tooltip._active.length){const a=d.ctx;a.save();const c=d.tooltip._active[0];a.beginPath(),a.moveTo(c.element.x,d.chartArea.top),a.lineTo(c.element.x,c.element.y),a.lineWidth=2,a.strokeStyle="white",a.stroke(),a.restore(),a.beginPath(),a.moveTo(c.element.x,c.element.y),a.lineTo(c.element.x,d.chartArea.bottom),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore(),a.beginPath(),a.moveTo(d.chartArea.left,c.element.y),a.lineTo(c.element.x,c.element.y),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore()}}};let p=document.getElementById("scatter-chart").getContext("2d");const C=new v(p,{type:"scatter",data:{labels:this.chart_data.total_answers,datasets:[{data:[{x:this.chart_data.categories.data[0],y:this.chart_data.categories.data[1]}],borderColor:"rgba(255, 8, 0, 1)",pointStyle:"crossRot",radius:6,hoverRadius:10,fill:!1}]},options:{animation:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1}},scales:{y:{min:0,max:5,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Operations"}},x:{min:0,max:5,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Numbers"}}},ticks:{precision:0}},plugins:[r,e]});this.scatter_chart=C}},splitResultByCategory(){const o=this.$page.props.answer_record.answer_record.reduce((r,e)=>(e.correct?r[e.question_category_id]=(r[e.question_category_id]||0)+1:r.hasOwnProperty(e.question_category_id)||(r[e.question_category_id]=null),r),{}),s={};return Object.keys(o).forEach((r,e)=>{s[e]=o[r]}),Object.values(s)},initAnswers(){this.answer_data=this.$page.props.answer_record.answer_record},initInfos(){this.report.title=this.$page.props.answer_record.dt_name,this.report.name=this.$page.props.answer_record.child_name,this.report.age=this.$page.props.answer_record.child_age,this.report.result=this.$page.props.answer_record.total_correct_answers+"/"+this.$page.props.answer_record.total_answers,this.report.date=b(this.$page.props.answer_record.created_at).format("DD/MM/YYYY"),this.report.time=b(this.$page.props.answer_record.created_at).format("hh:mm A"),this.finish_loading_report=!0},download(){document.getElementById("report").style.display="block";var o=document.getElementById("report");setTimeout(()=>{var s=2;Z.toPng(o,{width:o.clientWidth*s,height:o.clientHeight*s,style:{transform:"scale("+s+")",transformOrigin:"top left"}}).then(function(r){var e=document.createElement("a");e.href=r,e.download="Diagnostic Test Report.png",e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}).catch(function(r){console.error("oops, something went wrong!",r)})})}},created(){this.viewReport()}},ts=Object.assign(Ht,{__name:"Report",setup(o){return(s,r)=>(n(),l(_,null,[B(j(k),{title:"Diagnostic Test Report"}),u(t("div",N,H,512),[[w,!s.finish_loading_report]]),u(t("div",Y,[t("div",q,[t("div",G,[t("div",K,[t("div",Q,[t("div",U,[t("h1",J,"Diagnostic Test "+i(s.report.title),1)])]),t("div",X,[t("div",tt,[t("div",et,[t("canvas",st,null,512),t("canvas",rt,null,512)]),t("div",at,[t("dl",ot,[t("div",it,[nt,t("dd",lt,i(s.report.name),1)]),t("div",ct,[dt,t("dd",ht,i(s.report.age),1)]),t("div",pt,[_t,t("dd",mt,i(s.report.result),1)]),t("div",gt,[ft,t("dd",yt,i(s.report.date)+" - "+i(s.report.time),1)])])])]),t("div",ut,[t("div",wt,[xt,t("div",bt,[(n(!0),l(_,null,x(s.chart_data.categories.info,e=>(n(),l("span",null,[t("span",{class:"font-semibold",style:D("color: "+e.category_color)},i(e.category_name)+":",5),m(" "+i(e.category_description),1)]))),256))])])])]),t("div",vt,[t("div",kt,[t("div",Ct,[t("table",At,[Bt,t("tbody",jt,[(n(!0),l(_,null,x(s.answer_data,(e,g)=>(n(),l("tr",null,[t("td",Pt,i(++g),1),t("td",St,[t("div",Tt,[t("p",Dt,i(e.question),1),e.answer?(n(),l("div",Lt,[t("p",$t,[m("Answer: "),e.answer.length?(n(),l("span",zt,i(e.answer.map(p=>p===null?"Blank":p)),1)):(n(),l("span",Rt,i(e.answer),1))])])):(n(),l("p",Et,"Answer: "+i(e.answer+1),1))])]),t("td",Ft,[t("div",Mt,[e.correct?(n(),l("svg",It,Vt)):(n(),l("svg",Zt,Wt))])])]))),256))])])])])])],512)]),s.finish_loading_report?(n(),P(L,{key:0,onClick:s.download},{default:S(()=>[m("Download")]),_:1},8,["onClick"])):T("",!0)])],512),[[w,s.finish_loading_report]])],64))}});export{ts as default};
