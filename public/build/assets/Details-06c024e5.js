import{B as T}from"./Authenticated-5b05e583.js";import{B as I}from"./Button-f2501455.js";import{r as L}from"./PencilIcon-b62e8d9a.js";import{r as S}from"./SearchIcon-d9f7a138.js";import{r as D}from"./TrashIcon-a8ee0c70.js";import{c as d,b as g,u,w as y,F as w,H as C,L as M,ac as v,o as l,d as t,j as $,h as k,t as c}from"./app-939b8e88.js";import{C as P}from"./ConfirmationModal-0a1cb2f0.js";import{P as B}from"./Pagination-68c1c426.js";import{h as f}from"./moment-fbc5633a.js";import{s as R}from"./multiselect-cc47580c.js";import{M as z}from"./Modal-c755c3f9.js";import"./auto-47003362.js";import{p as E,d as Y}from"./dom-to-image-f0f95b7c.js";import{C as A}from"./chart-df6387c1.js";import"./ApplicationLogo-c2667bc1.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./XIcon-0bba80d5.js";import"./TimeAgo-83d4d7ae.js";import"./transition-27d34863.js";import"./VueFinalModal.esm-1e985684.js";/* empty css                                                              */const O={class:"py-4 px-4"},V={class:"mx-auto"},F={class:"align-middle inline-block min-w-full"},N={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},W={class:"min-w-full divide-y divide-gray-200"},q=t("thead",{class:"bg-gray-300"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/14"},"#"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-3/14"},"Level"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-2/14"},"Result"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-2/14"},"Date Taken"),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider w-2/14"},"Action")])],-1),H={class:"bg-white divide-y divide-gray-200"},Z={key:0},G=t("td",{class:"text-center",colspan:"10"},[t("div",{class:"p-3"}," No Record Found! ")],-1),Q=[G],J={class:"px-6 py-4 whitespace-nowrap"},K={class:"text-sm font-medium text-gray-700"},U={class:"px-6 py-4 whitespace-nowrap"},X={class:"text-sm font-medium text-gray-900"},tt={class:"px-6 py-4 whitespace-nowrap"},et={class:"text-sm font-medium text-gray-900"},st={class:"px-6 py-4 whitespace-nowrap"},at={class:"text-sm font-medium text-gray-900"},rt={class:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium"},ot={class:"flex justify-center space-x-2"},it={key:0,class:"flex items-center space-x-2"},nt=t("svg",{class:"inline-block h-4 w-4 animate-spin rounded-full border-2 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]",viewBox:"0 0 24 24"},null,-1),ct=t("span",null,"Generating...",-1),dt=[nt,ct],lt={key:1},ht={class:"relative overflow-hidden w-[210mm]"},pt={class:"absolute flex flex-col justify-between space-y-2 bg-white p-3 py-5",id:"report",ref:"report"},_t={class:"grid grid-rows-1"},mt={class:"flex justify-center"},gt={class:"font-bold text-slate-800 text-2xl py-4 uppercase"},ut={class:"grid grid-rows-1"},ft={class:"grid grid-cols-2 px-4 space-x-4"},yt={class:"flex items-center justify-center p-6 rounded-lg h-[300px]"},wt={id:"chartImage",ref:"chartImage"},xt={id:"scatter-chart",ref:"scatterChart",class:"hidden m-0"},bt={id:"bar-chart",ref:"barChart",class:"hidden m-0"},vt={class:"p-6 rounded-lg"},kt={class:"mt-2"},At={class:"py-3 flex justify-between text-sm font-medium"},Ct=t("dt",{class:"text-gray-500 min-w-[70px]"},"Name : ",-1),Bt={class:"text-gray-900 break-word"},jt={class:"py-3 flex justify-between text-sm font-medium"},Tt=t("dt",{class:"text-gray-500"},"Age :",-1),It={class:"text-gray-900"},Lt={class:"py-3 flex justify-between text-sm font-medium"},St=t("dt",{class:"text-gray-500"},"Result :",-1),Dt={class:"text-gray-900"},Mt={class:"py-3 flex justify-between text-sm font-medium"},$t=t("dt",{class:"text-gray-500"},"Date :",-1),Pt={class:"text-gray-900"},Rt={class:"py-3 flex justify-between text-sm font-medium"},zt=t("dt",{class:"text-gray-500"},"Time :",-1),Et={class:"text-gray-900"},Yt={class:"grid grid-rows-1"},Ot={class:"grid grid-cols-1"},Vt={class:"flex justify-center px-4"},Ft={class:"w-full"},Nt=t("thead",{class:"text-xs font-semibold uppercase text-gray-400 bg-indigo-100"},[t("tr",null,[t("th",{class:"p-2 whitespace-nowrap border-2 rounded-tr",width:"3"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"#")]),t("th",{class:"p-2 whitespace-nowrap border-2"},[t("div",{class:"flex font-semibold justify-center text-gray-700"},"Question")]),t("th",{class:"p-2 whitespace-nowrap border-2 w-8"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"Result")])])],-1),Wt={class:"text-sm divide-y divide-gray-100"},qt={class:"p-2 whitespace-nowrap border-2 text-center align-middle"},Ht={class:"p-2 whitespace-nowrap border-2 align-middle"},Zt={class:"flex flex-col flex-wrap"},Gt={class:"whitespace-normal font-semibold"},Qt={key:0,class:"flex items-center"},Jt={class:"whitespace-normal font-semibold"},Kt={key:1,class:"whitespace-normal font-semibold"},Ut={class:"p-2 whitespace-nowrap border-2 text-center align-middle"},Xt={class:"flex justify-center"},te={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-check-circle-fill text-green-500",viewBox:"0 0 16 16"},ee=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"},null,-1),se=[ee],ae={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-x-circle-fill text-red-500",viewBox:"0 0 16 16"},re=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"},null,-1),oe=[re],ie={id:"canvas",ref:"canvas",style:{display:"none"}},ne={components:{SearchIcon:S,TrashIcon:D,PencilIcon:L,ConfirmationModal:P,Head:C,Link:M,Multiselect:R,Modal:z,Pagination:B},props:{filter:Object},data(){return{current_chart_type:"",processing:!1,processing_item:[],bar_chart:"",scatter_chart:"",chart_image:"",show_report:!1,report:{title:"",name:"",age:"",result:"",datetime:""},params:{search:this.filter.search?this.filter.search:""},chart_data:{categories:{label:[],data:[]},total_answers:4},answer_data:[]}},watch:{params:{handler(){this.params&&this.$inertia.get(this.route("diagnostic_test.saved_result.details"),this.params,{replace:!0,preserveState:!0})},deep:!0}},methods:{async waitTwoSeconds(){await new Promise(o=>setTimeout(o,2e3))},viewReport(o,s,i,e){this.current_chart_type=e,this.processing=!0,this.processing_item[o].process=!0,this.chart_data.total_answers=i,this.bar_chart&&this.bar_chart.destroy(),this.scatter_chart&&this.scatter_chart.destroy(),this.displayChart(o,s,e)},displayChart(o,s,i){v.get(route("diagnostic_test.get_dt_categories"),{params:{dt_id:s,chart_type:i}}).then(e=>{this.chart_data.categories.label=e.data.label,this.chart_data.categories.data=e.data.data,this.chart_data.categories.data=this.splitResultByCategory(o),this.initChart(i),this.initAnswers(o),this.initInfos(o)}).catch(e=>{console.error(e)})},initChart(o){if(o==1){let i=document.getElementById("bar-chart").getContext("2d");const e=new A(i,{type:"bar",data:{labels:this.chart_data.categories.label,datasets:[{data:this.chart_data.categories.data,borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0,onComplete:function(){document.getElementById("chartImage").innerHTML='<img src="'+this.toBase64Image()+'">'}},plugins:{legend:{display:!1},datalabels:{anchor:"end",align:"end",color:"#000000",font:{size:14},formatter:function(r,n){return r}}},scales:{y:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}},x:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}}},ticks:{precision:0}},plugins:[E]});this.bar_chart=e}if(o==2){const s=this.chart_data.total_answers,i={id:"scatterArbitraryLine",beforeDatasetDraw(p,a,h){const{ctx:m,chartArea:{top:ce,bottom:de,left:le,right:he,width:pe,height:_e},scales:{x,y:b}}=p;j();function j(me,ge,ue,fe){m.save(),m.beginPath(),m.strokeStyle="rgba(170, 170, 170, 1)",m.lineWidth=3,m.moveTo(x.getPixelForValue(0),b.getPixelForValue(0)),m.lineTo(x.getPixelForValue(s),b.getPixelForValue(s)),m.stroke(),m.restore()}}},e={id:"scatterAnnotationLine",beforeDraw:p=>{if(p.tooltip._active&&p.tooltip._active.length){const a=p.ctx;a.save();const h=p.tooltip._active[0];a.beginPath(),a.moveTo(h.element.x,p.chartArea.top),a.lineTo(h.element.x,h.element.y),a.lineWidth=2,a.strokeStyle="white",a.stroke(),a.restore(),a.beginPath(),a.moveTo(h.element.x,h.element.y),a.lineTo(h.element.x,p.chartArea.bottom),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore(),a.beginPath(),a.moveTo(p.chartArea.left,h.element.y),a.lineTo(h.element.x,h.element.y),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore()}}};let n=document.getElementById("scatter-chart").getContext("2d");const _=new A(n,{type:"scatter",data:{labels:this.chart_data.total_answers,datasets:[{data:[{x:this.chart_data.categories.data[0],y:this.chart_data.categories.data[1]}],borderColor:"rgba(255, 8, 0, 1)",pointStyle:"crossRot",radius:6,hoverRadius:10,fill:!1}]},options:{animation:{duration:0,onComplete:function(){document.getElementById("chartImage").innerHTML='<img src="'+this.toBase64Image()+'">'}},plugins:{legend:{display:!1}},scales:{y:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Operations"}},x:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Numbers"}}},ticks:{precision:0}},plugins:[i,e]});this.scatter_chart=_}},splitResultByCategory(o){const i=this.$page.props.answer_record.data[o].answer_record.filter(r=>r.correct).reduce((r,n)=>(n.correct&&(r[n.question_category_id]?r[n.question_category_id]++:r[n.question_category_id]=1),r),{}),e={};return Object.keys(i).forEach((r,n)=>{e[n]=i[r]}),Object.values(e)},initAnswers(o){this.answer_data=this.$page.props.answer_record.data[o].answer_record},initInfos(o){v.post(route("diagnostic_test.get_saved_result_info"),{result_id:this.$page.props.result_id}).then(s=>{this.report.title=this.$page.props.answer_record.data[o].dt_name,this.report.name=s.data.child_name,this.report.age=s.data.child_age,this.report.result=this.$page.props.answer_record.data[o].total_correct_answers+"/"+this.$page.props.answer_record.data[o].total_answers,this.report.datetime=f(s.data.created_at).format("DD/MM/YYYY, hh:mm A"),document.getElementById("report").style.display="block";var i=document.getElementById("report"),e=!0;setTimeout(()=>{var r=2;e=!1,Y.toPng(i,{width:i.clientWidth*r,height:i.clientHeight*r,style:{transform:"scale("+r+")",transformOrigin:"top left"}}).then(function(n){var _=document.createElement("a");_.href=n,_.download="Diagnostic Test Report.png",_.style.display="none",document.body.appendChild(_),_.click(),document.body.removeChild(_)}).catch(function(n){console.error("oops, something went wrong!",n)})}),e&&(this.processing=!1,this.processing_item[o].process=!1)}).catch(s=>{console.error(s)})}},created(){this.$page.props.answer_record.data.map(()=>{this.processing_item.push({process:!1})})}},Ye=Object.assign(ne,{__name:"Details",setup(o){return(s,i)=>(l(),d(w,null,[g(u(C),{title:"Diagnostic Test"}),g(T,null,{header:y(()=>[]),default:y(()=>[t("div",O,[t("div",V,[t("div",F,[t("div",N,[t("table",W,[q,t("tbody",H,[s.$page.props.answer_record.data.length?$("",!0):(l(),d("tr",Z,Q)),(l(!0),d(w,null,k(s.$page.props.answer_record.data,(e,r)=>(l(),d("tr",{class:"hover:bg-gray-200",key:e.id},[t("td",J,[t("div",K,c(r+1),1)]),t("td",U,[t("div",X,c(e.dt_name),1)]),t("td",tt,[t("div",et,c(e.total_correct_answers+"/"+e.total_answers),1)]),t("td",st,[t("div",at,c(u(f)(e.created_at).format("DD/MM/YYYY")),1)]),t("td",rt,[t("div",ot,[g(I,{buttonType:"blue",class:"py-1 px-2",onClick:n=>!s.processing_item[r].process&&!s.processing?s.viewReport(r,e.dt_id,e.total_answers,e.chart_type):""},{default:y(()=>[s.processing_item[r].process&&s.processing?(l(),d("div",it,dt)):(l(),d("span",lt,"View Report"))]),_:2},1032,["onClick"])])])]))),128))])]),g(B,{page_data:s.$page.props.answer_record,params:"&result_id="+s.$page.props.result_id},null,8,["page_data","params"]),t("div",ht,[t("div",pt,[t("div",_t,[t("div",mt,[t("h1",gt,"Diagnostic Test "+c(s.report.title),1)])]),t("div",ut,[t("div",ft,[t("div",yt,[t("div",wt,null,512),t("canvas",xt,null,512),t("canvas",bt,null,512)]),t("div",vt,[t("dl",kt,[t("div",At,[Ct,t("dd",Bt,c(s.report.name),1)]),t("div",jt,[Tt,t("dd",It,c(s.report.age),1)]),t("div",Lt,[St,t("dd",Dt,c(s.report.result),1)]),t("div",Mt,[$t,t("dd",Pt,c(u(f)(s.report.datetime).format("DD/MM/Y")),1)]),t("div",Rt,[zt,t("dd",Et,c(u(f)(s.report.datetime).format("h:mm A")),1)])])])])]),t("div",Yt,[t("div",Ot,[t("div",Vt,[t("table",Ft,[Nt,t("tbody",Wt,[(l(!0),d(w,null,k(s.answer_data,(e,r)=>(l(),d("tr",null,[t("td",qt,c(++r),1),t("td",Ht,[t("div",Zt,[t("p",Gt,c(e.question),1),e.answer?(l(),d("div",Qt,[t("p",Jt,"Answer: "+c(e.answer.toString())+" ",1)])):(l(),d("p",Kt,"Answer: "+c(e.answer+1),1))])]),t("td",Ut,[t("div",Xt,[e.correct?(l(),d("svg",te,se)):(l(),d("svg",ae,oe))])])]))),256))])])])])])],512)])])])])]),t("canvas",ie,null,512)]),_:1})],64))}});export{Ye as default};
