import{_ as y}from"./Authenticated-31303258.js";import{o as n,c as i,a as u,u as m,d as t,t as p,w as g,F as f,b as v,H as x,n as c,q as l,e as k,g as _}from"./app-dae06b43.js";import{s as h}from"./simplebar.min-5a1aada9.js";import{h as $}from"./moment-55cb88ed.js";import"./XIcon-2fccf0c1.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./transition-aa2d9b9f.js";import"./keyboard-3fcb0a97.js";import"./use-resolve-button-type-c77ca1e3.js";import"./menu-fa9f3acf.js";const F={class:"fixed w-full flex justify-center top-[4rem] md:top-[10rem] font-extrabold bg-white border border-gray-300 py-3 z-20"},S={class:"max-w-xl mx-auto border shadow bg-white rounded-lg px-4 mt-14"},C={class:"flex justify-evenly sm:justify-center space-x-8 md:space-x-10 pt-3 pb-4 font-medium"},I=t("img",{src:"/images/parents/stories.png",class:"w-10 h-10",alt:""},null,-1),N=t("span",{class:"text-sm"},"Stories",-1),j=[I,N],H=t("img",{src:"/images/parents/progress_report.png",class:"w-10 h-10",alt:""},null,-1),B=t("span",{class:"text-sm"},"Progress Reports",-1),D=[H,B],E=t("img",{src:"/images/parents/fee_invoice.png",class:"w-10 h-10",alt:""},null,-1),V=t("span",{class:"text-sm"},"Invoices",-1),z=[E,V],A=t("img",{src:"/images/parents/art_gallery.png",class:"w-10 h-10",alt:""},null,-1),M=t("span",{class:"text-sm"},"Art Gallery",-1),T=[A,M],L=t("img",{src:"/images/parents/art_book.png",class:"w-10 h-10",alt:""},null,-1),O=t("span",{class:"text-sm"},"Art Book",-1),P=[L,O],R={class:"max-w-xl mx-auto mt-10"},U={key:0,class:"flex items-center space-y-3"},q=t("h2",{class:"text-lg md:text-xl mx-1 font-extrabold"},"Invoices",-1),G=[q],J={key:1,class:"flex justify-center mx-1 mt-10"},K=t("span",{class:"text-slate-500"},"No Invoices Found",-1),Y=[K],Q={key:2,class:"mt-3"},W={class:"bg-white shadow rounded-lg border"},X={class:"divide-y divide-slate-200 dark:divide-zink-500 px-6 py-4"},Z={class:"flex items-center gap-3 py-2 first:pt-0 last:pb-0"},ee={class:"grow"},te={class:"font-bold text-sm"},se={class:"font-semibold text-blue-700"},oe={class:"text-slate-500 text-sm font-medium"},ae={class:"text-sm font-medium"},re={class:"shrink-0"},ne=["href"],ie=["onClick"],le={key:0,class:"flex items-center justify-between pt-5 animate-pulse"},pe=t("div",null,[t("div",{class:"h-2.5 bg-gray-300 rounded-full dark:bg-gray-600 w-52 mb-2.5"}),t("div",{class:"w-28 h-2 bg-gray-200 rounded-full dark:bg-gray-700 mb-2.5"}),t("div",{class:"w-20 h-2 bg-gray-200 rounded-full dark:bg-gray-700"})],-1),ce=t("div",{class:"h-2.5 bg-gray-300 rounded-full dark:bg-gray-700 w-14"},null,-1),de=[pe,ce],ue={components:{simplebar:h},data(){return{open_modal:!1,generating:[],invoice_data:{parent_name:"",parent_address:"No 27, Jalan Kap Empat, 17/17D, Seksyen 17, Shah Alam",invoice_number:"",invoice_items:[],date_issued:"",due_date:"",total_amount:""},loading:{invoices:!1}}},methods:{viewInvoice(a,e){this.generating[e]||(this.generating[e]=!0,v.get(route("fee.invoices.generate"),{responseType:"blob",params:{invoice_id:a}}).then(o=>{const s=new Blob([o.data],{type:"application/pdf"}),r=URL.createObjectURL(s);window.open(r,"_blank"),this.generating[e]=!1}).catch(o=>{console.error("Error fetching PDF:",o),this.generating[e]=!1}))},totalFee(a){let e=0;const o=JSON.parse(a);for(const s of o){const r=parseFloat(s.programme_fee),d=parseFloat(s.programme_fee_discount),b=parseFloat(s.material_fee),w=parseFloat(s.material_fee_discount);e+=r-d,s.include_material_fee&&(e+=b-w)}return e},pay(a){window.location.href="https://www.billplz-sandbox.com/bills/"+a},handleInvoiceScroll(){const a=this.$refs.invoice_container.$el.querySelector(".simplebar-content-wrapper"),e=a.scrollTop,o=a.scrollHeight,s=a.clientHeight;e+s>=o-100&&this.$page.props.invoices.next_page_url&&(this.loading.invoices||(this.loading.invoices=!0,v.get(route("parent.student_invoices"),{params:{page:this.$page.props.invoices.current_page+1}}).then(r=>{r.data.data.forEach(d=>{this.$page.props.invoices.data.push(d)}),this.$page.props.invoices.current_page=r.data.current_page,this.$page.props.invoices.next_page_url=r.data.next_page_url,this.loading.invoices=!1})))}},mounted(){this.$page.props.invoices.data.forEach(a=>{this.generating.push(!1)})}},ke=Object.assign(ue,{__name:"Invoices",setup(a){return(e,o)=>(n(),i(f,null,[u(m(x),{title:"Invoices"}),t("div",F,[t("span",null,p(e.$page.props.session_data.current_active_programme.name),1)]),u(y,null,{default:g(()=>[t("div",S,[u(m(h),{"data-simplebar-auto-hide":"true"},{default:g(()=>[t("div",C,[t("div",{class:c(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",e.route().current("parent.stories")?"font-extrabold":""]),onClick:o[0]||(o[0]=s=>e.$inertia.get(e.route("parent.stories",e.$page.props.session_data.current_active_programme.encrypted_id)))},j,2),t("div",{class:c(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",e.route().current("parent.progress_reports")?"font-extrabold":""]),onClick:o[1]||(o[1]=s=>e.$inertia.get(e.route("parent.progress_reports")))},D,2),t("div",{class:c(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",e.route().current("parent.invoices")?"font-extrabold":""]),onClick:o[2]||(o[2]=s=>e.$inertia.get(e.route("parent.invoices")))},z,2),e.$page.props.session_data.current_active_programme.id==3||e.$page.props.session_data.current_active_programme.id==5?(n(),i("div",{key:0,class:c(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",e.route().current("parent.art_gallery")?"font-extrabold":""]),onClick:o[3]||(o[3]=s=>e.$inertia.get(e.route("parent.art_gallery")))},T,2)):l("",!0),e.$page.props.session_data.current_active_programme.id==3||e.$page.props.session_data.current_active_programme.id==5?(n(),i("div",{key:1,class:c(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",e.route().current("parent.art_book")?"font-extrabold":""]),onClick:o[4]||(o[4]=s=>e.$inertia.get(e.route("parent.art_book")))},P,2)):l("",!0)])]),_:1})]),t("div",R,[e.$page.props.invoices.data.length?(n(),i("div",U,G)):l("",!0),e.$page.props.invoices.data.length?l("",!0):(n(),i("div",J,Y)),e.$page.props.invoices.data.length?(n(),i("div",Q,[t("div",W,[u(m(h),{"data-simplebar-auto-hide":"true",class:"max-h-96",onScroll:e.handleInvoiceScroll,ref:"invoice_container"},{default:g(()=>[t("ul",X,[(n(!0),i(f,null,k(e.$page.props.invoices.data,(s,r)=>(n(),i("li",Z,[t("div",ee,[t("h6",te,[_(p(m($)(s.date_issued).format("MMMM Y"))+" (",1),t("span",se,p(s.invoice_number),1),_(")")]),t("p",oe,"Amount: "+p(s.amount),1),t("p",ae,[_("Status: "),t("span",{class:c([s.status_text_color])},p(s.status),3)])]),t("div",re,[s.status_id==1?(n(),i("a",{key:0,href:s.payment_url,class:"text-sm cursor-pointer font-medium px-3 py-1 text-indigo-600 rounded bg-indigo-100 hover:bg-indigo-200 hover:rounded whitespace-nowrap"},"Pay Now",8,ne)):l("",!0),s.status_id==2?(n(),i("a",{key:1,class:"text-sm cursor-pointer font-medium px-3 py-1 text-blue-600 bg-blue-100 hover:bg-blue-200 rounded whitespace-nowrap",onClick:d=>e.generating[r]?"":e.viewInvoice(s.id,r)},p(e.generating[r]?"Generating...":"View"),9,ie)):l("",!0)])]))),256)),e.loading.invoices?(n(),i("div",le,de)):l("",!0)])]),_:1},8,["onScroll"])])])):l("",!0)])]),_:1})],64))}});export{ke as default};
