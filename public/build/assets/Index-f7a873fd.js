import{x as i,v as u,u as d,y as e,J as p,O as m,F as h,q as o,m as g,B as l,I as f,t as _,U as y,z as $,bx as C}from"./@vue-39dc9ff3.js";import{_ as L}from"./Authenticated-6a33aaad.js";import{H as B}from"./@inertiajs-2b766590.js";import{s as v}from"./simplebar-vue-0a5cf12f.js";import{T as x}from"./TimeAgo-d5f13767.js";import{C as w,S as k,P as D,N as b}from"./vue3-carousel-ef658d03.js";import{D as H}from"./luxon-8ddd27a0.js";import"./@heroicons-fd1e1a44.js";import"./app-ef5f5861.js";import"./axios-1779699b.js";import"./pusher-js-68b5c933.js";import"./@vueform-8fb84cf1.js";import"./@vuepic-a83e4355.js";import"./@babel-1b80a44a.js";import"./cropperjs-042b647f.js";import"./laravel-vite-plugin-d10ca5e8.js";import"./vue-debounce-ed417ae1.js";import"./v-calendar-e9930861.js";import"./radix-vue-a603168c.js";import"./@floating-ui-c05b1c1f.js";import"./@internationalized-2f03b566.js";import"./clsx-1229b3e0.js";import"./tailwind-merge-3f7ff3b1.js";import"./@vueuse-c14271ca.js";import"./class-variance-authority-52f2569e.js";import"./@radix-icons-9ff33614.js";import"./lodash.isequal-0acc53e7.js";import"./vue-46d666fa.js";import"./lodash.clonedeep-12c784b4.js";import"./qs-45a3326f.js";import"./side-channel-401220dd.js";import"./get-intrinsic-88feedc6.js";import"./es-errors-82fd953f.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-1353c55e.js";import"./function-bind-61637ca6.js";import"./hasown-bc561cf0.js";import"./call-bind-9ec8ebd8.js";import"./set-function-length-ecd19468.js";import"./define-data-property-d38573ea.js";import"./es-define-property-cfa03815.js";import"./gopd-4c4454f6.js";import"./has-property-descriptors-68e2873e.js";import"./object-inspect-ac0241aa.js";import"./deepmerge-89e33937.js";import"./nprogress-87ee1729.js";import"./@headlessui-3f5736f6.js";import"./Button-dbb43583.js";import"./simplebar-core-32e0c2bb.js";import"./can-use-dom-e394c214.js";import"./lodash-es-9b1d07da.js";import"./javascript-time-ago-55ed0321.js";import"./relative-time-format-ec7ee7be.js";import"./moment-a9aaa855.js";const S={class:"fixed w-full flex justify-center top-[4rem] md:top-[10rem] font-extrabold bg-white border border-gray-300 py-3 z-20"},M={class:"max-w-xl mx-auto border shadow bg-white rounded-lg px-4 mt-14"},z={class:"flex justify-evenly sm:justify-center space-x-8 md:space-x-10 pt-3 pb-4 font-medium"},j=e("img",{src:"/images/parents/stories.png",class:"w-10 h-10",alt:""},null,-1),T=e("span",{class:"text-sm"},"Stories",-1),V=[j,T],A=e("img",{src:"/images/parents/progress_report.png",class:"w-10 h-10",alt:""},null,-1),I=e("span",{class:"text-sm"},"Progress Reports",-1),N=[A,I],P=e("img",{src:"/images/parents/fee_invoice.png",class:"w-10 h-10",alt:""},null,-1),E=e("span",{class:"text-sm"},"Invoices",-1),Z=[P,E],F=e("img",{src:"/images/parents/art_gallery.png",class:"w-10 h-10",alt:""},null,-1),U=e("span",{class:"text-sm"},"Art Gallery",-1),O=[F,U],q=e("img",{src:"/images/parents/art_book.png",class:"w-10 h-10",alt:""},null,-1),G=e("span",{class:"text-sm"},"Art Book",-1),J=[q,G],K={class:"max-w-xl mx-auto mt-5"},R={key:0,class:"flex items-center space-y-3"},Q=e("h2",{class:"text-lg md:text-xl mx-1 font-extrabold"},"Stories",-1),W=[Q],X={key:1,class:"flex justify-center mx-1 mt-10"},Y=e("span",{class:"text-slate-500"},"No Stories Found",-1),ee=[Y],te={class:"mt-3 flex flex-col space-y-3 bg-white py-3 px-4 shadow-md rounded-xl text-sm"},se={class:"flex flex-row text-sm items-center"},oe={class:"flex justify-between items-center flex-1 font-bold leading-tight select-none"},re={class:"flex flex-col"},ie={class:"text-slate-900 md:text-md font-bold"},ae={class:"text-xs font-medium text-slate-500"},ne={class:"flex items-center"},le=e("hr",null,null,-1),ce={class:"text-sm text-slate-800"},de={class:"carousel__item h-full"},pe=["src","onDblclick"],me={class:"flex items-center space-x-4"},ue={key:0,class:""},ge=["onClick"],he=e("path",{d:"M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"},null,-1),_e=[he],fe=["onClick"],ve=e("path",{d:"M225.8 468.2l-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144C158.6 37.9 198.9 47 231 69.6c9 6.4 17.4 13.8 25 22.3c4.2-4.8 8.7-9.2 13.5-13.3c3.7-3.2 7.5-6.2 11.5-9c0 0 0 0 0 0C313.1 47 353.4 37.9 392.8 45.4C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20c0 0-.1-.1-.1-.1c0 0 0 0 0 0c-23.1-25.9-58-37.7-92-31.2C81.6 101.5 48 142.1 48 189.5v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268c20.9-19.4 32.8-46.7 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9c-34-6.5-69 5.4-92 31.2c0 0 0 0-.1 .1s0 0-.1 .1l-17.8 20c-.3 .4-.7 .7-1 1.1c-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"},null,-1),xe=[ve],we=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"inline-block h-6 w-6 text-gray-500 hover:text-red-500 cursor-pointer",fill:"currentColor",viewBox:"0 0 512 512"},[e("path",{d:"M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z"})],-1),ke=[we],be={key:1,class:"space-y-2"},ye={key:0,class:"flex-col w-full mx-auto bg-white shadow border border-gray-300 px-4 py-3 rounded-lg"},$e={class:"divide-y space-y-2"},Ce={class:"flex flex-row pt-1 md-10"},Le={class:"flex-col mt-1"},Be={class:"flex items-center flex-1 font-bold leading-tight"},De={class:"text-xs font-normal text-gray-500 ml-2"},He={class:"flex-1 text-sm font-medium leading-loose text-gray-600"},Se=["onUpdate:modelValue"],Me=["onClick"],ze=e("button",{class:"px-4 py-2 text-xs bg-indigo-600 hover:bg-indigo-700 text-white rounded-md"},"Comment",-1),je=[ze],Te={key:3,class:"mt-3 max-w-xl py-3 px-4 border border-gray-200 rounded-xl shadow animate-pulse bg-white"},Ve=e("div",{class:"flex items-center"},[e("div",null,[e("div",{class:"h-2.5 bg-gray-200 rounded-full dark:bg-gray-700 w-32 mb-2"}),e("div",{class:"w-48 h-2 bg-gray-200 rounded-full dark:bg-gray-700 mb-4"})])],-1),Ae=e("hr",null,null,-1),Ie=e("div",{class:"h-2.5 bg-gray-200 rounded-full dark:bg-gray-700 w-48 mb-4 mt-3"},null,-1),Ne=e("div",{class:"flex items-center justify-center h-48 mb-4 bg-gray-300 rounded dark:bg-gray-700"},[e("svg",{class:"w-10 h-10 text-gray-200 dark:text-gray-600","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 20"},[e("path",{d:"M14.066 0H7v5a2 2 0 0 1-2 2H0v11a1.97 1.97 0 0 0 1.934 2h12.132A1.97 1.97 0 0 0 16 18V2a1.97 1.97 0 0 0-1.934-2ZM10.5 6a1.5 1.5 0 1 1 0 2.999A1.5 1.5 0 0 1 10.5 6Zm2.221 10.515a1 1 0 0 1-.858.485h-8a1 1 0 0 1-.9-1.43L5.6 10.039a.978.978 0 0 1 .936-.57 1 1 0 0 1 .9.632l1.181 2.981.541-1a.945.945 0 0 1 .883-.522 1 1 0 0 1 .879.529l1.832 3.438a1 1 0 0 1-.031.988Z"}),e("path",{d:"M5 5V.13a2.96 2.96 0 0 0-1.293.749L.879 3.707A2.98 2.98 0 0 0 .13 5H5Z"})])],-1),Pe=e("span",{class:"sr-only"},"Loading...",-1),Ee=[Ve,Ae,Ie,Ne,Pe],Ze={components:{simplebar:v,TimeAgo:x,Carousel:w,Slide:k,Pagination:D,Navigation:b},data(){return{show_comment:!1,loading:{stories:!1},comments:[]}},methods:{isLikedByParent(a){return this.$page.props.stories.data[a].likes.length?this.$page.props.stories.data[a].likes.some(t=>t.like_author_id===this.$page.props.auth.user.ID):!1},toggleLike(a,t){if(this.isLikedByParent(a)){const r=this.$page.props.stories.data[a].likes.findIndex(s=>s.like_author_id===this.$page.props.auth.user.ID);this.$page.props.stories.data[a].likes.splice(r,1)}else this.$page.props.stories.data[a].likes.push({like_author_id:this.$page.props.auth.user.ID});axios.post(route("parent.like_story"),{story_id:t,to_delete:!this.isLikedByParent(a)}).then(r=>{})},toggleComment(){this.show_comment=!this.show_comment},postComment(a,t){axios.post(route("parent.stories.comments.store"),{story_id:t,comment:this.comments[a]}).then(r=>{r.data&&(this.$page.props.stories.data[a].comments.unshift({comment:this.comments[a],comment_user_name:this.$page.props.auth.user.display_name,created_at:H.now().setZone("Asia/Kuala_Lumpur").toFormat("yyyy-MM-dd HH:mm:ss")}),this.comments[a]="")})},handleStoryScroll(){const a=document.documentElement.scrollTop||document.body.scrollTop,t=document.documentElement.scrollHeight||document.body.scrollHeight,r=document.documentElement.clientHeight||window.innerHeight;a+r>=t-100&&this.$page.props.stories.next_page_url&&(this.loading.stories||(this.loading.stories=!0,axios.get(route("parent.student_stories",[this.$page.props.session_data.current_active_child.student_id,this.$page.props.session_data.current_active_programme.id]),{params:{page:this.$page.props.stories.current_page+1}}).then(s=>{s.data.data.forEach(c=>{this.$page.props.stories.data.push(c)}),this.$page.props.stories.current_page=s.data.current_page,this.$page.props.stories.next_page_url=s.data.next_page_url,this.loading.stories=!1})))}}},Ot=Object.assign(Ze,{__name:"Index",setup(a){return(t,r)=>(o(),i(h,null,[u(d(B),{title:"Home"}),e("div",S,[e("span",null,p(t.$page.props.current_active_programme.name),1)]),u(L,{onScroll:t.handleStoryScroll},{default:m(()=>[e("div",M,[u(d(v),{"data-simplebar-auto-hide":"true"},{default:m(()=>[e("div",z,[e("div",{class:g(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",t.route().current("parent.stories")?"font-extrabold":""]),onClick:r[0]||(r[0]=s=>t.$inertia.get(t.route("parent.stories",t.$page.props.current_active_programme.encrypted_id)))},V,2),e("div",{class:g(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",t.route().current("parent.progress_reports")?"font-extrabold":""]),onClick:r[1]||(r[1]=s=>t.$inertia.get(t.route("parent.progress_reports")))},N,2),e("div",{class:g(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",t.route().current("parent.invoices")?"font-extrabold":""]),onClick:r[2]||(r[2]=s=>t.$inertia.get(t.route("parent.invoices")))},Z,2),t.$page.props.current_active_programme.id==3||t.$page.props.current_active_programme.id==5?(o(),i("div",{key:0,class:g(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",t.route().current("parent.art_gallery")?"font-extrabold":""]),onClick:r[3]||(r[3]=s=>t.$inertia.get(t.route("parent.art_gallery")))},O,2)):l("",!0),t.$page.props.current_active_programme.id==3||t.$page.props.current_active_programme.id==5?(o(),i("div",{key:1,class:g(["flex flex-col items-center cursor-pointer hover:scale-105 duration-150 whitespace-nowrap",t.route().current("parent.art_book")?"font-extrabold":""]),onClick:r[4]||(r[4]=s=>t.$inertia.get(t.route("parent.art_book")))},J,2)):l("",!0)])]),_:1})]),e("div",K,[t.$page.props.stories.data.length?(o(),i("div",R,W)):l("",!0),t.$page.props.stories.data.length?l("",!0):(o(),i("div",X,ee)),t.$page.props.stories.data.length?(o(!0),i(h,{key:2},f(t.$page.props.stories.data,(s,c)=>(o(),i("div",te,[e("div",se,[e("div",oe,[e("div",re,[e("span",ie,p(s.story_author_name),1),e("span",ae,p(s.story_programme_name),1)]),e("div",ne,[u(x,{class:"text-gray-500 font-medium text-xs",datetime:s.story_date},null,8,["datetime"])])])]),le,e("span",ce,p(s.story_title),1),s.images?(o(),_(d(w),{key:0,mouseDrag:s.images.length>1,touchDrag:s.images.length>1},{addons:m(()=>[s.images.length>1?(o(),_(d(b),{key:0})):l("",!0)]),default:m(()=>[(o(!0),i(h,null,f(s.images,(n,Fe)=>(o(),_(d(k),{key:n},{default:m(()=>[e("div",de,[e("img",{src:"/storage/stories/"+n.image_filename,class:"select-none h-full",onDblclick:Ue=>t.toggleLike(c,s.story_id)},null,40,pe)])]),_:2},1024))),128))]),_:2},1032,["mouseDrag","touchDrag"])):l("",!0),e("div",me,[t.$page.props.can.create_stories?l("",!0):(o(),i("div",ue,[t.isLikedByParent(c)?(o(),i("svg",{key:0,onClick:n=>t.toggleLike(c,s.story_id),xmlns:"http://www.w3.org/2000/svg",class:"inline-block h-6 w-6 text-red-500 cursor-pointer",fill:"currentColor",viewBox:"0 0 512 512"},_e,8,ge)):(o(),i("svg",{key:1,onClick:n=>t.toggleLike(c,s.story_id),xmlns:"http://www.w3.org/2000/svg",class:"inline-block h-6 w-6 text-gray-500 hover:text-red-500 cursor-pointer",fill:"currentColor",viewBox:"0 0 512 512"},xe,8,fe))])),e("div",{class:"",onClick:r[5]||(r[5]=n=>t.toggleComment())},ke)]),t.show_comment?(o(),i("div",be,[s.comments.length?(o(),i("div",ye,[u(d(v),{"data-simplebar-auto-hide":"true",class:"max-h-96"},{default:m(()=>[e("div",$e,[(o(!0),i(h,null,f(s.comments,n=>(o(),i("div",Ce,[e("div",Le,[e("div",Be,[y(p(n.comment_user_name)+" ",1),e("span",De,[(o(),_(x,{class:"text-gray-500 font-medium text-xs",datetime:n.created_at,key:n.created_at},null,8,["datetime"]))])]),e("div",He,p(n.comment),1)])]))),256))])]),_:2},1024)])):l("",!0),$((o(),i("textarea",{class:"bg-white border border-gray-300 p-2 px-3.5 rounded-lg w-full resize-none focus:ring-0 focus:border-2 focus:border-indigo-300 text-sm",rows:"2",placeholder:"Drop a comment...",key:c,"onUpdate:modelValue":n=>t.comments[c]=n},null,8,Se)),[[C,t.comments[c]]]),e("div",{class:"flex justify-end",onClick:n=>t.postComment(c,s.story_id)},je,8,Me)])):l("",!0)]))),256)):l("",!0),t.loading.stories?(o(),i("div",Te,Ee)):l("",!0)])]),_:1},8,["onScroll"])],64))}});export{Ot as default};
