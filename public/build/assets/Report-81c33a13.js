import{y as d,x as j,u as B,L as w,M as x,z as t,H as i,F as g,D as b,v as S,Q as D,A as P,be as T,t as l,V as L,W as f}from"./@vue-fa39c8c3.js";import"./Authenticated-2464c72b.js";import{r as $,a as M,b as R}from"./@heroicons-4f5c57a0.js";import{H as C,L as z}from"./@inertiajs-c7856c69.js";import{C as E}from"./ConfirmationModal-8b143ad0.js";import{P as F}from"./Pagination-83a017ca.js";import{h as v}from"./moment-a9aaa855.js";import{s as I}from"./@vueform-b962800d.js";import{a as O}from"./axios-1779699b.js";import{C as k}from"./chart.js-367f2c70.js";import{p as V}from"./chartjs-plugin-datalabels-9f3c2c2e.js";import{d as W}from"./dom-to-image-662217e3.js";import"./ApplicationLogo-bc2e3fb2.js";import"./radix-vue-b52878ef.js";import"./@floating-ui-d22e3cce.js";import"./@internationalized-2f03b566.js";import"./class-variance-authority-52f2569e.js";import"./clsx-1229b3e0.js";import"./app-f5e40355.js";import"./pusher-js-ddef06ed.js";import"./@vuepic-62f3604d.js";import"./@babel-1b80a44a.js";import"./cropperjs-aef143af.js";import"./laravel-vite-plugin-d10ca5e8.js";import"./vue-debounce-ed417ae1.js";import"./v-calendar-1a2c766e.js";import"./tailwind-merge-26e9d2f1.js";import"./@vueuse-0175b845.js";import"./@radix-icons-a5b56816.js";import"./lodash.isequal-32ec3540.js";import"./vue-e0f979ce.js";import"./lodash.clonedeep-2dfa23d9.js";import"./qs-fddd7d85.js";import"./side-channel-a64b5f12.js";import"./get-intrinsic-88feedc6.js";import"./es-errors-82fd953f.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-1353c55e.js";import"./function-bind-61637ca6.js";import"./hasown-bc561cf0.js";import"./call-bind-9ec8ebd8.js";import"./set-function-length-ecd19468.js";import"./define-data-property-d38573ea.js";import"./es-define-property-cfa03815.js";import"./gopd-4c4454f6.js";import"./has-property-descriptors-68e2873e.js";import"./object-inspect-6df2283d.js";import"./deepmerge-89e33937.js";import"./nprogress-4f526f01.js";import"./lucide-vue-next-f94b1320.js";import"./@headlessui-4b33c316.js";import"./@kurkle-b1b89bbc.js";const Z={class:"flex flex-col justify-center items-center p-3 space-y-4"},H={class:"flex justify-center w-[215mm] mx-2 my-2 md:mx-auto"},N={class:"flex flex-col items-center space-y-4"},Y={class:"w-[210mm]"},q={class:"flex flex-col justify-between space-y-2 bg-white p-3",id:"report",ref:"report"},Q={class:"grid grid-rows-1"},G={class:"flex justify-center"},J={class:"font-bold text-slate-800 text-xl py-5 uppercase"},K={class:"grid grid-rows-1"},U={class:"grid grid-cols-2 px-4 space-x-4"},X={class:"flex items-center justify-center rounded-lg"},tt={id:"scatter-chart",ref:"scatterChart",class:"hidden m-0"},et={id:"bar-chart",ref:"barChart",class:"hidden m-0"},st={class:"p-6 rounded-lg"},rt={class:"mt-2 space-y-3"},at={class:"flex justify-between text-sm font-medium"},ot={class:"text-gray-900 break-word"},it={class:"flex justify-between text-sm font-medium"},nt={class:"text-gray-900"},lt={class:"flex justify-between text-sm font-medium"},dt={class:"text-gray-900"},ct={class:"flex justify-between text-sm font-medium"},pt={class:"text-gray-900"},ht={class:"grid grid-cols-1 px-4 space-x-4"},mt={class:"flex items-center p-2 text-sm text-gray-800 border border-gray-300 rounded-lg bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600",role:"alert"},_t={class:"flex flex-col text-xs"},gt={class:"grid grid-rows-1"},ft={class:"grid grid-cols-1"},ut={class:"flex justify-center px-4"},yt={class:"w-full"},wt={class:"text-sm divide-y divide-gray-100"},xt={class:"p-1 whitespace-nowrap border-2 text-center align-middle text-sm"},bt={class:"p-1 whitespace-nowrap border-2 align-middle text-sm"},vt={class:"flex flex-col flex-wrap"},kt={class:"whitespace-normal font-semibold"},Ct={key:0,class:"flex items-center"},At={class:"whitespace-normal font-semibold"},jt={key:0},Bt={key:1},St={key:1,class:"whitespace-normal font-semibold"},Dt={class:"p-1 whitespace-nowrap border-2 text-center align-middle text-sm"},Pt={class:"flex justify-center"},Tt={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-check-circle-fill text-green-500",viewBox:"0 0 16 16"},Lt={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-x-circle-fill text-red-500",viewBox:"0 0 16 16"},$t={components:{SearchIcon:$,TrashIcon:M,PencilIcon:R,ConfirmationModal:E,Head:C,Link:z,Multiselect:I,Pagination:F},props:{filter:Object},data(){return{finish_loading_report:!1,current_chart_type:"",chart_info:[],bar_chart:"",scatter_chart:"",chart_image:"",show_report:!1,report:{title:"",name:"",age:"",result:"",datetime:""},chart_data:{categories:{label:[],data:[],info:[]},total_answers:4},answer_data:[]}},methods:{viewReport(){const o=this.$page.props.answer_record.dt_id,s=this.$page.props.answer_record.total_answers,e=this.$page.props.answer_record.chart_type;this.current_chart_type=e,this.chart_data.total_answers=s,this.bar_chart&&this.bar_chart.destroy(),this.scatter_chart&&this.scatter_chart.destroy(),this.displayChart(o,e)},displayChart(o,s){O.get(route("diagnostic_test.get_dt_categories"),{params:{dt_id:o,chart_type:s}}).then(e=>{this.chart_data.categories.label=e.data.label,this.chart_data.categories.data=e.data.data,this.chart_data.categories.data=this.splitResultByCategory(),this.chart_data.categories.info=e.data.info,this.initChart(s),this.initAnswers(),this.initInfos()}).catch(e=>{console.error(e)})},initChart(o){if(o==1){let e=document.getElementById("bar-chart").getContext("2d");const a=new k(e,{type:"bar",data:{labels:this.chart_data.categories.label,datasets:[{data:this.chart_data.categories.data,backgroundColor:["#7B66FF","#39A7FF","#508D69","#ED5AB3"],borderWidth:1}]},options:{animation:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1},datalabels:{display:!1}},scales:{y:{min:0,max:3,stepSize:1,ticks:{beginAtZero:!0}},x:{display:!1,min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}}},ticks:{precision:0}},plugins:[V]});this.bar_chart=a}if(o==2){const s=this.chart_data.total_answers,e={id:"scatterArbitraryLine",beforeDatasetDraw(p,r,c){const{ctx:h,chartArea:{top:Mt,bottom:Rt,left:zt,right:Et,width:Ft,height:It},scales:{x:u,y}}=p;A();function A(Ot,Vt,Wt,Zt){h.save(),h.beginPath(),h.strokeStyle="rgba(170, 170, 170, 1)",h.lineWidth=3,h.moveTo(u.getPixelForValue(0),y.getPixelForValue(0)),h.lineTo(u.getPixelForValue(s),y.getPixelForValue(s)),h.stroke(),h.restore()}}},a={id:"scatterAnnotationLine",beforeDraw:p=>{if(p.tooltip._active&&p.tooltip._active.length){const r=p.ctx;r.save();const c=p.tooltip._active[0];r.beginPath(),r.moveTo(c.element.x,p.chartArea.top),r.lineTo(c.element.x,c.element.y),r.lineWidth=2,r.strokeStyle="white",r.stroke(),r.restore(),r.beginPath(),r.moveTo(c.element.x,c.element.y),r.lineTo(c.element.x,p.chartArea.bottom),r.lineWidth=2,r.strokeStyle="red",r.stroke(),r.restore(),r.beginPath(),r.moveTo(p.chartArea.left,c.element.y),r.lineTo(c.element.x,c.element.y),r.lineWidth=2,r.strokeStyle="red",r.stroke(),r.restore()}}};let _=document.getElementById("scatter-chart").getContext("2d");const m=new k(_,{type:"scatter",data:{labels:this.chart_data.total_answers,datasets:[{data:[{x:this.chart_data.categories.data[0],y:this.chart_data.categories.data[1]}],borderColor:"rgba(255, 8, 0, 1)",pointStyle:"crossRot",radius:6,hoverRadius:10,fill:!1}]},options:{animation:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1}},scales:{y:{min:0,max:5,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Operations"}},x:{min:0,max:5,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Numbers"}}},ticks:{precision:0}},plugins:[e,a]});this.scatter_chart=m}},splitResultByCategory(){const o=this.$page.props.answer_record.answer_record.reduce((e,a)=>(a.correct?e[a.question_category_id]=(e[a.question_category_id]||0)+1:e.hasOwnProperty(a.question_category_id)||(e[a.question_category_id]=null),e),{}),s={};return Object.keys(o).forEach((e,a)=>{s[a]=o[e]}),Object.values(s)},initAnswers(){this.answer_data=this.$page.props.answer_record.answer_record},initInfos(){this.report.title=this.$page.props.answer_record.dt_name,this.report.name=this.$page.props.answer_record.child_name,this.report.age=this.$page.props.answer_record.child_age,this.report.result=this.$page.props.answer_record.total_correct_answers+"/"+this.$page.props.answer_record.total_answers,this.report.date=v(this.$page.props.answer_record.created_at).format("DD/MM/YYYY"),this.report.time=v(this.$page.props.answer_record.created_at).format("hh:mm A"),this.finish_loading_report=!0},download(){document.getElementById("report").style.display="block";var o=document.getElementById("report");setTimeout(()=>{var s=2;W.toPng(o,{width:o.clientWidth*s,height:o.clientHeight*s,style:{transform:"scale("+s+")",transformOrigin:"top left"}}).then(function(e){var a=document.createElement("a");a.href=e,a.download="Diagnostic Test Report.png",a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}).catch(function(e){console.error("oops, something went wrong!",e)})})}},created(){this.viewReport()}},We=Object.assign($t,{__name:"Report",setup(o){return(s,e)=>{const a=T("Button");return l(),d(g,null,[j(B(C),{title:"Diagnostic Test Report"}),w(t("div",Z,e[0]||(e[0]=[t("div",{class:"mt-16"}," Please wait while report is loading... ",-1)]),512),[[x,!s.finish_loading_report]]),w(t("div",H,[t("div",N,[t("div",Y,[t("div",q,[t("div",Q,[t("div",G,[t("h1",J,"Diagnostic Test "+i(s.report.title),1)])]),t("div",K,[t("div",U,[t("div",X,[t("canvas",tt,null,512),t("canvas",et,null,512)]),t("div",st,[t("dl",rt,[t("div",at,[e[1]||(e[1]=t("dt",{class:"text-gray-500 min-w-[70px]"},"Name : ",-1)),t("dd",ot,i(s.report.name),1)]),t("div",it,[e[2]||(e[2]=t("dt",{class:"text-gray-500"},"Age :",-1)),t("dd",nt,i(s.report.age),1)]),t("div",lt,[e[3]||(e[3]=t("dt",{class:"text-gray-500"},"Result :",-1)),t("dd",dt,i(s.report.result),1)]),t("div",ct,[e[4]||(e[4]=t("dt",{class:"text-gray-500"},"Date / Time",-1)),t("dd",pt,i(s.report.date)+" - "+i(s.report.time),1)])])])]),t("div",ht,[t("div",mt,[e[5]||(e[5]=t("svg",{class:"flex-shrink-0 inline w-4 h-4 me-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})],-1)),t("div",_t,[(l(!0),d(g,null,b(s.chart_data.categories.info,n=>(l(),d("span",null,[t("span",{class:"font-semibold",style:L("color: "+n.category_color)},i(n.category_name)+":",5),f(" "+i(n.category_description),1)]))),256))])])])]),t("div",gt,[t("div",ft,[t("div",ut,[t("table",yt,[e[9]||(e[9]=t("thead",{class:"text-xs font-semibold uppercase text-gray-400 bg-indigo-100"},[t("tr",null,[t("th",{class:"p-2 whitespace-nowrap border-2 rounded-tr",width:"3"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"#")]),t("th",{class:"p-2 whitespace-nowrap border-2"},[t("div",{class:"flex font-semibold justify-center text-gray-700"},"Question")]),t("th",{class:"p-2 whitespace-nowrap border-2 w-8"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"Result")])])],-1)),t("tbody",wt,[(l(!0),d(g,null,b(s.answer_data,(n,_)=>(l(),d("tr",null,[t("td",xt,i(++_),1),t("td",bt,[t("div",vt,[t("p",kt,i(n.question),1),n.answer?(l(),d("div",Ct,[t("p",At,[e[6]||(e[6]=f("Answer: ")),n.answer.length?(l(),d("span",jt,i(n.answer.map(m=>m===null?"Blank":m)),1)):(l(),d("span",Bt,i(n.answer),1))])])):(l(),d("p",St,"Answer: "+i(n.answer+1),1))])]),t("td",Dt,[t("div",Pt,[n.correct?(l(),d("svg",Tt,e[7]||(e[7]=[t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"},null,-1)]))):(l(),d("svg",Lt,e[8]||(e[8]=[t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"},null,-1)])))])])]))),256))])])])])])],512)]),s.finish_loading_report?(l(),S(a,{key:0,onClick:s.download},{default:D(()=>e[10]||(e[10]=[f("Download")])),_:1},8,["onClick"])):P("",!0)])],512),[[x,s.finish_loading_report]])],64)}}});export{We as default};
