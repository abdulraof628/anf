import{x as c,v as r,u as k,P as a,F as y,a5 as d,q as g,V as n,y as s,K as u,L as _,C as V,G as B}from"./@vue-64c42e7d.js";import{B as j}from"./Authenticated-deb5cc5f.js";import{L,H as M}from"./@inertiajs-41d03628.js";import{b as D}from"./@vueform-ba82ac10.js";import{C as x}from"./cropperjs-2c7c67ce.js";import{_ as v}from"./Card-2084bb73.js";import"./ApplicationLogo-64527dd0.js";import"./radix-vue-2488f6ae.js";import"./@floating-ui-7a9770d8.js";import"./@internationalized-2f03b566.js";import"./class-variance-authority-f96983da.js";import"./app-46681fe6.js";import"./axios-9cbf0d09.js";import"./pusher-js-2bcba7e2.js";import"./@vuepic-339c593a.js";import"./date-fns-60a02367.js";import"./@babel-1b80a44a.js";import"./laravel-vite-plugin-d10ca5e8.js";import"./vue-debounce-ed417ae1.js";import"./v-calendar-1cb1b359.js";import"./@popperjs-f3391c26.js";import"./clsx-0839fdbe.js";import"./tailwind-merge-642c57ff.js";import"./@vueuse-deae3e94.js";import"./@radix-icons-03b844c4.js";import"./moment-timezone-65f24d9a.js";import"./moment-3968d9f3.js";import"./lodash.isequal-60a7aae7.js";import"./vue-68dd36d7.js";import"./lodash.clonedeep-8b83a099.js";import"./qs-589f641c.js";import"./side-channel-1ba8a7fc.js";import"./get-intrinsic-88feedc6.js";import"./es-errors-82fd953f.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-1353c55e.js";import"./function-bind-61637ca6.js";import"./hasown-bc561cf0.js";import"./call-bind-9ec8ebd8.js";import"./set-function-length-ecd19468.js";import"./define-data-property-d38573ea.js";import"./es-define-property-cfa03815.js";import"./gopd-4c4454f6.js";import"./has-property-descriptors-68e2873e.js";import"./object-inspect-a3a9a537.js";import"./deepmerge-89e33937.js";import"./nprogress-34a09d83.js";import"./lucide-vue-next-48142e2c.js";const I={class:"grid grid-cols-1 2xl:grid-cols-2 gap-4"},U=s("span",{class:"text-red-500"},"*",-1),E=s("span",{class:"text-red-500"},"*",-1),P=s("span",{class:"text-red-500"},"*",-1),H=s("span",{class:"text-red-500"},"*",-1),R={class:"2xl:col-span-2"},S=s("span",{class:"text-red-500"},"*",-1),O={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},T={class:"mb-4"},F={class:"space-y-1 text-center"},G=s("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true"},[s("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),N={class:"flex text-sm text-gray-600"},A={class:"browse text-indigo-400 hover:text-indigo-800 cursor-pointer font-bold"},z={ref:"front_image",id:"file",class:"sr-only",type:"file",accept:"image/*"},J=s("p",{class:"pl-1"},"or drag and drop an image",-1),Y=s("p",{class:"text-xs text-gray-500"},"Image Format : PNG, JPG",-1),q={class:"mb-4"},K={class:"space-y-1 text-center"},W=s("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true"},[s("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),X={class:"flex text-sm text-gray-600"},Q={class:"browse text-indigo-400 hover:text-indigo-800 cursor-pointer font-bold"},Z={ref:"inside_image",id:"file",class:"sr-only",type:"file",accept:"image/*"},ee=s("p",{class:"pl-1"},"or drag and drop an image",-1),te=s("p",{class:"text-xs text-gray-500"},"Image Format : PNG, JPG",-1),se={class:"flex flex-col space-y-4 2xl:space-y-0 2xl:flex-row 2xl:space-x-5 mb-5"},oe={class:"flex w-full max-w-96"},ie=["src"],re={class:"flex flex-row justify-center"},ae={class:"flex-column"},le=s("div",{class:"preview h-44 w-44"},null,-1),ne={class:"flex-column pl-1 pt-6"},de={class:"flex flex-col space-y-1"},pe=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"})],-1),me=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),ue={class:"flex justify-center 2xl:justify-start flex-wrap space-y-4 2xl:space-y-0 2xl:space-x-6"},_e={class:"sm:col-span-2 self-center flex flex-wrap gap-4 py-3"},he=["onClick"],fe=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),ce=[fe],ge=["src"],ve={class:"flex items-center justify-between"},we={class:"flex space-x-2 items-center"},ye={class:"flex space-x-2"},h=window.URL||window.webkitURL,xe=/^image\/\w+$/;let f=null;const be={components:{Link:L,Toggle:D,Cropper:x},data(){return{data:{type:Object,default:()=>({})},checking_email:!1,show_front_upload:!0,show_inside_upload:!0,show_image:!1,image:"",email_exist:this.$page.props.email_exist?this.$page.props.email_exist:"",form:{id:this.$page.props.centre_info?this.$page.props.centre_info.ID:"",country:this.$page.props.centre_info.country_id!=0?this.$page.props.centre_info.country_id:"",name:this.$page.props.centre_info?this.$page.props.centre_info.label:"",contact_number:this.$page.props.centre_info?this.$page.props.centre_info.phone:"",email:this.$page.props.centre_info?this.$page.props.centre_info.email:"",address:this.$page.props.centre_info?this.$page.props.centre_info.address:"",active:this.$page.props.centre_info?!!this.$page.props.centre_info.is_active:!1,principal_user_id:this.$page.props.centre_info?this.$page.props.centre_info.principal_user_id:"",image_list:this.$page.props.centre_images?this.$page.props.centre_images:[],images_to_delete:[]},search:{email:this.$page.props.email_exist?this.$page.props.email_exist.user_email:""}}},mounted(){const o=this.$refs.input;o&&(f=new x(o,{aspectRatio:1,cropBoxResizable:!1,cropBoxMovable:!1,viewMode:1,dragMode:"move",movable:!0,rotatable:!0,preview:".preview",minCropBoxWidth:500,minCropBoxHeight:500,modal:!0,background:!1}))},watch:{image:{handler(o){o&&f.replace(o)},deep:!0}},methods:{submit(){this.$inertia.post(route("centres.update"),this.form,{preserveState:!0})},read(o,e){return new Promise((t,l)=>{if(!o){t();return}xe.test(o.type)?h?t({loaded:!0,name:o.name,type:o.type,url:h.createObjectURL(o)}):l(new Error("Your browser is not supported.")):l(new Error("Please select a valid image file."))})},change_front({target:o}){const{files:e}=o;e&&e.length>0&&this.read(e[0],o).then(t=>{this.image=t.url,this.show_front_upload=!1,this.show_inside_upload=!1,this.show_image=!0,this.update(t,"front")}).catch(this.alert)},dragover_front(o){o.preventDefault()},drop_front(o){const{files:e}=o.dataTransfer;o.preventDefault(),e&&e.length>0&&this.read(e[0],o).then(t=>{this.front_image=t.url,this.show_front_upload=!1,this.show_inside_upload=!1,this.update(t)}).catch(this.alert)},change_inside({target:o}){const{files:e}=o;e&&e.length>0&&this.read(e[0],o).then(t=>{this.image=t.url,this.show_front_upload=!1,this.show_inside_upload=!1,this.show_image=!0,this.update(t,"inside")}).catch(this.alert)},dragover_inside(o){o.preventDefault()},drop_inside(o){const{files:e}=o.dataTransfer;o.preventDefault(),e&&e.length>0&&this.read(e[0],o).then(t=>{this.front_image=t.url,this.show_front_upload=!1,this.show_inside_upload=!1,this.update(t)}).catch(this.alert)},alert(o){window.alert(o&&o.message?o.message:o)},update(o,e){Object.assign(this.data,o),Object.assign(this.data,{view_type:e})},reselect_image(){this.show_front_upload=!0,this.show_inside_upload=!0,this.show_image=!1,this.$refs.front_image.value=null,this.$refs.inside_image.value=null},select_cropped_image(){const o=this.form.image_list.filter(t=>{if(t.image_type=="front")return!0}),e=this.form.image_list.filter(t=>{if(t.image_type=="inside")return!0});this.data.view_type=="front"?o.length<1?(f.getCroppedCanvas().toBlob(t=>{var l=h.createObjectURL(t),p=this.blobToFile(t,this.data.name);this.form.image_list.unshift({image_path:l,image_file:p,image_type:this.data.view_type})},"image/jpeg",.1),this.show_front_upload=!0,this.show_inside_upload=!0,this.show_image=!1,this.$refs.front_image.value=null):(alert("Only 1 front view image is allowed!"),this.show_front_upload=!0,this.show_inside_upload=!0,this.show_image=!1,this.$refs.front_image.value=null):this.data.view_type=="inside"&&(e.length<5?(f.getCroppedCanvas().toBlob(t=>{var l=h.createObjectURL(t);this.form.image_list.push({name:this.data.name,image_path:l,image_file:t,image_type:this.data.view_type})},"image/jpeg",.1),this.show_front_upload=!0,this.show_inside_upload=!0,this.show_image=!1,this.$refs.inside_image.value=null):(alert("Only 5 inside view image is allowed!"),this.show_front_upload=!0,this.show_inside_upload=!0,this.show_image=!1,this.$refs.inside_image.value=null))},delete_cropped_image(o){this.form.image_list[o].id&&this.form.images_to_delete.push({image_id:this.form.image_list[o].id}),this.form.image_list.splice(o,1)},blobToFile(o,e){return o.lastModifiedDate=new Date,o.name=e,o}}},vt=Object.assign(be,{__name:"Edit",setup(o){return(e,t)=>{const l=d("Label"),p=d("Input"),b=d("ComboBox"),$=d("Textarea"),m=d("Button"),C=d("Switch");return g(),c(y,null,[r(k(M),{title:"Centres"}),r(j,null,{header:a(()=>[]),default:a(()=>[r(v,null,{title:a(()=>[n("Centre Information")]),content:a(()=>[s("div",I,[s("div",null,[r(l,null,{default:a(()=>[n("Name"),U]),_:1}),r(p,{type:"text",error:e.$page.props.errors.name,modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=i=>e.form.name=i)},null,8,["error","modelValue"])]),s("div",null,[r(l,null,{default:a(()=>[n("Country"),E]),_:1}),r(b,{items:e.$page.props.countries,"label-property":"name","value-property":"id",error:e.$page.props.errors.country,modelValue:e.form.country,"onUpdate:modelValue":t[1]||(t[1]=i=>e.form.country=i),"select-placeholder":"Select Country","search-placeholder":"Search country..."},null,8,["items","error","modelValue"])]),s("div",null,[r(l,null,{default:a(()=>[n("Contact Number"),P]),_:1}),r(p,{type:"text",error:e.$page.props.errors.contact_number,modelValue:e.form.contact_number,"onUpdate:modelValue":t[2]||(t[2]=i=>e.form.contact_number=i)},null,8,["error","modelValue"])]),s("div",null,[r(l,null,{default:a(()=>[n("Email"),H]),_:1}),r(p,{type:"text",error:e.$page.props.errors.email,modelValue:e.form.email,"onUpdate:modelValue":t[3]||(t[3]=i=>e.form.email=i)},null,8,["error","modelValue"])]),s("div",R,[r(l,null,{default:a(()=>[n("Address"),S]),_:1}),r($,{error:e.$page.props.errors.address,modelValue:e.form.address,"onUpdate:modelValue":t[4]||(t[4]=i=>e.form.address=i)},null,8,["error","modelValue"])])])]),_:1}),r(v,null,{title:a(()=>[n("Centre Photos")]),content:a(()=>[s("div",O,[u(s("div",T,[r(l,null,{default:a(()=>[n("Centre Front View (1 Image)")]),_:1}),s("div",{class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",onChange:t[5]||(t[5]=(...i)=>e.change_front&&e.change_front(...i)),onDragover:t[6]||(t[6]=(...i)=>e.dragover_front&&e.dragover_front(...i)),onDrop:t[7]||(t[7]=(...i)=>e.drop_front&&e.drop_front(...i))},[s("div",F,[G,s("div",N,[s("label",A,[n("Click here "),s("input",z,null,512)]),J]),Y])],32)],512),[[_,e.show_front_upload]]),u(s("div",q,[r(l,null,{default:a(()=>[n("Centre Inside View (Max: 5 Images)")]),_:1}),s("div",{class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",onChange:t[8]||(t[8]=(...i)=>e.change_inside&&e.change_inside(...i)),onDragover:t[9]||(t[9]=(...i)=>e.dragover_inside&&e.dragover_inside(...i)),onDrop:t[10]||(t[10]=(...i)=>e.drop_inside&&e.drop_inside(...i))},[s("div",K,[W,s("div",X,[s("label",Q,[n("Click here "),s("input",Z,null,512)]),ee]),te])],32)],512),[[_,e.show_inside_upload]])]),u(s("div",se,[s("div",null,[r(l,null,{default:a(()=>[n("Crop Image")]),_:1}),s("div",oe,[s("img",{class:"text-center image",ref:"input",src:e.image},null,8,ie)])]),s("div",null,[s("div",re,[s("div",ae,[r(l,null,{default:a(()=>[n(" Image Preview ")]),_:1}),le]),s("div",ne,[s("div",de,[r(m,{class:"py-1 px-2 rounded shadow",onClick:t[11]||(t[11]=i=>e.select_cropped_image()),title:"Select cropped image"},{default:a(()=>[pe]),_:1}),r(m,{class:"py-1 px-2 rounded shadow",onClick:t[12]||(t[12]=i=>e.reselect_image()),title:"Reselect an image"},{default:a(()=>[me]),_:1})])])])])],512),[[_,e.show_image]]),s("div",ue,[u(s("div",_e,[(g(!0),c(y,null,V(e.form.image_list,(i,w)=>(g(),c("div",{class:"relative h-32 w-32 mr-3 mt-3 text-center shadow-sm",key:w},[s("div",{class:"absolute bg-red-500 p-2 shadow rounded-full text-white z-10 cursor-pointer hover:bg-red-700",style:{top:"-8px",right:"-8px"},onClick:$e=>e.delete_cropped_image(w)},ce,8,he),s("img",{src:i.image_path,class:"rounded-lg",alt:""},null,8,ge),r(l,null,{default:a(()=>[n(B(i.image_type),1)]),_:2},1024)]))),128))],512),[[_,e.form.image_list.length]])])]),_:1}),r(v,null,{content:a(()=>[s("div",ve,[s("div",we,[r(l,null,{default:a(()=>[n("Active")]),_:1}),r(C,{modelValue:e.form.active,"onUpdate:modelValue":t[13]||(t[13]=i=>e.form.active=i)},null,8,["modelValue"])]),s("div",ye,[r(m,{variant:"outline",onClick:t[14]||(t[14]=i=>e.$inertia.get(e.route("centres")))},{default:a(()=>[n("Cancel")]),_:1}),r(m,{onClick:e.submit},{default:a(()=>[n("Save")]),_:1},8,["onClick"])])])]),_:1})]),_:1})],64)}}});export{vt as default};
