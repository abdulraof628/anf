import{o as n,c,b as B,u as j,d as t,f as w,i as y,t as i,F as g,h as x,m as S,w as T,j as D,H as k,L as P,ab as L,D as $,k as m}from"./app-c0f4251a.js";import{B as M}from"./Button-b43e3e6c.js";import{r as R}from"./PencilIcon-d5ddac1d.js";import{r as z}from"./SearchIcon-9dc3155e.js";import{r as E}from"./TrashIcon-e30a1aac.js";import"./toggle-f7bf70ac.js";import{C as F}from"./ConfirmationModal-c2ba1851.js";import{P as I}from"./Pagination-11a93a96.js";import{h as b}from"./moment-fbc5633a.js";import{s as O}from"./multiselect-c8795ac7.js";import{M as V}from"./Modal-998759b5.js";import"./auto-65a5f8f0.js";import{p as Z,d as N}from"./dom-to-image-7b638df9.js";import{C as v}from"./chart-30d8fb54.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./transition-7aae5dbe.js";import"./VueFinalModal.esm-84853026.js";/* empty css                                                              */const W={class:"flex flex-col items-center p-3 space-y-4"},q={class:"mt-16"},H={class:"border border-gray-700 w-[210mm]"},Y={class:"flex flex-col justify-between space-y-2 bg-white p-3",id:"report",ref:"report"},Q={class:"grid grid-rows-1"},G={class:"flex justify-center"},J={class:"font-bold text-slate-800 text-xl py-5 uppercase"},K={class:"grid grid-rows-1"},U={class:"grid grid-cols-2 px-4 space-x-4"},X={class:"flex items-center justify-center rounded-lg"},tt={id:"scatter-chart",ref:"scatterChart",class:"hidden m-0"},et={id:"bar-chart",ref:"barChart",class:"hidden m-0"},st={class:"p-6 rounded-lg"},at={class:"mt-2 space-y-3"},rt={class:"flex justify-between text-sm font-medium"},ot=t("dt",{class:"text-gray-500 min-w-[70px]"},"Name : ",-1),it={class:"text-gray-900 break-word"},nt={class:"flex justify-between text-sm font-medium"},ct=t("dt",{class:"text-gray-500"},"Age :",-1),lt={class:"text-gray-900"},dt={class:"flex justify-between text-sm font-medium"},ht=t("dt",{class:"text-gray-500"},"Result :",-1),_t={class:"text-gray-900"},pt={class:"flex justify-between text-sm font-medium"},gt=t("dt",{class:"text-gray-500"},"Date / Time",-1),mt={class:"text-gray-900"},ft={class:"grid grid-cols-1 px-4 space-x-4"},ut={class:"flex items-center p-2 text-sm text-gray-800 border border-gray-300 rounded-lg bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600",role:"alert"},wt=t("svg",{class:"flex-shrink-0 inline w-4 h-4 me-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})],-1),yt={class:"flex flex-col"},xt={class:"grid grid-rows-1"},bt={class:"grid grid-cols-1"},vt={class:"flex justify-center px-4"},kt={class:"w-full"},Ct=t("thead",{class:"text-xs font-semibold uppercase text-gray-400 bg-indigo-100"},[t("tr",null,[t("th",{class:"p-2 whitespace-nowrap border-2 rounded-tr",width:"3"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"#")]),t("th",{class:"p-2 whitespace-nowrap border-2"},[t("div",{class:"flex font-semibold justify-center text-gray-700"},"Question")]),t("th",{class:"p-2 whitespace-nowrap border-2 w-8"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"Result")])])],-1),At={class:"text-sm divide-y divide-gray-100"},Bt={class:"p-1 whitespace-nowrap border-2 text-center align-middle text-sm"},jt={class:"p-1 whitespace-nowrap border-2 align-middle text-sm"},St={class:"flex flex-col flex-wrap"},Tt={class:"whitespace-normal font-semibold"},Dt={key:0,class:"flex items-center"},Pt={class:"whitespace-normal font-semibold"},Lt={key:0},$t={key:1},Mt={key:1,class:"whitespace-normal font-semibold"},Rt={class:"p-1 whitespace-nowrap border-2 text-center align-middle text-sm"},zt={class:"flex justify-center"},Et={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-check-circle-fill text-green-500",viewBox:"0 0 16 16"},Ft=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"},null,-1),It=[Ft],Ot={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-x-circle-fill text-red-500",viewBox:"0 0 16 16"},Vt=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"},null,-1),Zt=[Vt],Nt={components:{SearchIcon:z,TrashIcon:E,PencilIcon:R,ConfirmationModal:F,Head:k,Link:P,Multiselect:O,Modal:V,Pagination:I},props:{filter:Object},data(){return{finish_loading_report:!1,current_chart_type:"",chart_info:[],bar_chart:"",scatter_chart:"",chart_image:"",show_report:!1,report:{title:"",name:"",age:"",result:"",datetime:""},chart_data:{categories:{label:[],data:[],info:[]},total_answers:4},answer_data:[]}},methods:{async waitTwoSeconds(){await new Promise(o=>setTimeout(o,2e3))},viewReport(){const o=this.$page.props.answer_record.dt_id,s=this.$page.props.answer_record.total_answers,r=this.$page.props.answer_record.chart_type;this.current_chart_type=r,this.chart_data.total_answers=s,this.bar_chart&&this.bar_chart.destroy(),this.scatter_chart&&this.scatter_chart.destroy(),this.displayChart(o,r)},displayChart(o,s){L.get(route("diagnostic_test.get_dt_categories"),{params:{dt_id:o,chart_type:s}}).then(r=>{this.chart_data.categories.label=r.data.label,this.chart_data.categories.data=r.data.data,this.chart_data.categories.data=this.splitResultByCategory(),this.chart_data.categories.info=r.data.info,this.initChart(s),this.initAnswers(),this.initInfos()}).catch(r=>{console.error(r)})},initChart(o){if(o==1){let r=document.getElementById("bar-chart").getContext("2d");const e=new v(r,{type:"bar",data:{labels:this.chart_data.categories.label,datasets:[{data:this.chart_data.categories.data,backgroundColor:["#7B66FF","#39A7FF","#508D69","#ED5AB3"],borderWidth:1}]},options:{animation:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1},datalabels:{display:!1}},scales:{y:{min:0,max:3,stepSize:1,ticks:{beginAtZero:!0}},x:{display:!1,min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}}},ticks:{precision:0}},plugins:[Z]});this.bar_chart=e}if(o==2){const s=this.chart_data.total_answers,r={id:"scatterArbitraryLine",beforeDatasetDraw(h,a,l){const{ctx:_,chartArea:{top:Wt,bottom:qt,left:Ht,right:Yt,width:Qt,height:Gt},scales:{x:f,y:u}}=h;A();function A(Jt,Kt,Ut,Xt){_.save(),_.beginPath(),_.strokeStyle="rgba(170, 170, 170, 1)",_.lineWidth=3,_.moveTo(f.getPixelForValue(0),u.getPixelForValue(0)),_.lineTo(f.getPixelForValue(s),u.getPixelForValue(s)),_.stroke(),_.restore()}}},e={id:"scatterAnnotationLine",beforeDraw:h=>{if(h.tooltip._active&&h.tooltip._active.length){const a=h.ctx;a.save();const l=h.tooltip._active[0];a.beginPath(),a.moveTo(l.element.x,h.chartArea.top),a.lineTo(l.element.x,l.element.y),a.lineWidth=2,a.strokeStyle="white",a.stroke(),a.restore(),a.beginPath(),a.moveTo(l.element.x,l.element.y),a.lineTo(l.element.x,h.chartArea.bottom),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore(),a.beginPath(),a.moveTo(h.chartArea.left,l.element.y),a.lineTo(l.element.x,l.element.y),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore()}}};let p=document.getElementById("scatter-chart").getContext("2d");const C=new v(p,{type:"scatter",data:{labels:this.chart_data.total_answers,datasets:[{data:[{x:this.chart_data.categories.data[0],y:this.chart_data.categories.data[1]}],borderColor:"rgba(255, 8, 0, 1)",pointStyle:"crossRot",radius:6,hoverRadius:10,fill:!1}]},options:{animation:!1,plugins:{legend:{display:!1},tooltip:{enabled:!1}},scales:{y:{min:0,max:5,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Operations"}},x:{min:0,max:5,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Numbers"}}},ticks:{precision:0}},plugins:[r,e]});this.scatter_chart=C}},splitResultByCategory(){const s=this.$page.props.answer_record.answer_record.filter(e=>e.correct).reduce((e,d)=>(d.correct&&(e[d.question_category_id]?e[d.question_category_id]++:e[d.question_category_id]=1),e),{}),r={};return Object.keys(s).forEach((e,d)=>{r[d]=s[e]}),Object.values(r)},initAnswers(){this.answer_data=this.$page.props.answer_record.answer_record},initInfos(){this.report.title=this.$page.props.answer_record.dt_name,this.report.name=this.$page.props.answer_record.child_name,this.report.age=this.$page.props.answer_record.child_age,this.report.result=this.$page.props.answer_record.total_correct_answers+"/"+this.$page.props.answer_record.total_answers,this.report.date=b(this.$page.props.answer_record.created_at).format("DD/MM/YYYY"),this.report.time=b(this.$page.props.answer_record.created_at).format("hh:mm A"),this.finish_loading_report=!0},download(){document.getElementById("report").style.display="block";var o=document.getElementById("report");setTimeout(()=>{var s=2;N.toPng(o,{width:o.clientWidth*s,height:o.clientHeight*s,style:{transform:"scale("+s+")",transformOrigin:"top left"}}).then(function(r){var e=document.createElement("a");e.href=r,e.download="Diagnostic Test Report.png",e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}).catch(function(r){console.error("oops, something went wrong!",r)})})}},created(){this.viewReport()}},we=Object.assign(Nt,{__name:"Report",setup(o){return(s,r)=>(n(),c(g,null,[B(j(k),{title:"Diagnostic Test Report"}),t("div",W,[w(t("div",q," Please wait, Loading Report... ",512),[[y,!s.finish_loading_report]]),w(t("div",H,[t("div",Y,[t("div",Q,[t("div",G,[t("h1",J,"Diagnostic Test "+i(s.report.title),1)])]),t("div",K,[t("div",U,[t("div",X,[t("canvas",tt,null,512),t("canvas",et,null,512)]),t("div",st,[t("dl",at,[t("div",rt,[ot,t("dd",it,i(s.report.name),1)]),t("div",nt,[ct,t("dd",lt,i(s.report.age),1)]),t("div",dt,[ht,t("dd",_t,i(s.report.result),1)]),t("div",pt,[gt,t("dd",mt,i(s.report.date)+" - "+i(s.report.time),1)])])])]),t("div",ft,[t("div",ut,[wt,t("div",yt,[(n(!0),c(g,null,x(s.chart_data.categories.info,e=>(n(),c("span",null,[t("span",{class:"font-semibold",style:$("color: "+e.category_color)},i(e.category_name)+":",5),m(" "+i(e.category_description),1)]))),256))])])])]),t("div",xt,[t("div",bt,[t("div",vt,[t("table",kt,[Ct,t("tbody",At,[(n(!0),c(g,null,x(s.answer_data,(e,d)=>(n(),c("tr",null,[t("td",Bt,i(++d),1),t("td",jt,[t("div",St,[t("p",Tt,i(e.question),1),e.answer?(n(),c("div",Dt,[t("p",Pt,[m("Answer: "),e.answer.length?(n(),c("span",Lt,i(e.answer.map(p=>p===null?"Blank":p)),1)):(n(),c("span",$t,i(e.answer),1))])])):(n(),c("p",Mt,"Answer: "+i(e.answer+1),1))])]),t("td",Rt,[t("div",zt,[e.correct?(n(),c("svg",Et,It)):(n(),c("svg",Ot,Zt))])])]))),256))])])])])])],512)],512),[[y,s.finish_loading_report]]),s.finish_loading_report?(n(),S(M,{key:0,onClick:s.download},{default:T(()=>[m("Download")]),_:1},8,["onClick"])):D("",!0)])],64))}});export{we as default};
