import{o as d,c as h,b as j,u as m,d as t,f as w,i as y,t as n,F as x,h as T,m as I,w as L,j as S,H as C,L as P,ab as b,k as v}from"./app-9f658aac.js";import{B as D}from"./Button-8b05ce75.js";import{r as M}from"./PencilIcon-409a4910.js";import{r as R}from"./SearchIcon-bc2833c4.js";import{r as E}from"./TrashIcon-06779b1e.js";import"./toggle-8a193fe7.js";import{C as $}from"./ConfirmationModal-3f6519e9.js";import{P as z}from"./Pagination-239be8ed.js";import{h as g}from"./moment-fbc5633a.js";import{s as O}from"./multiselect-14bf46fd.js";import{M as V}from"./Modal-0e602360.js";import"./auto-65a5f8f0.js";import{p as F,d as N}from"./dom-to-image-33a5ff71.js";import{C as k}from"./chart-30d8fb54.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./transition-b539f290.js";import"./VueFinalModal.esm-65aa8d42.js";/* empty css                                                              */const W={class:"flex flex-col items-center p-3 space-y-4"},q={class:"mt-16"},H={class:"border border-gray-700 w-[210mm]"},Y={class:"flex flex-col justify-between space-y-2 bg-white p-3 py-5",id:"report",ref:"report"},Z={class:"grid grid-rows-1"},Q={class:"flex justify-center"},G={class:"font-bold text-slate-800 text-2xl py-4 uppercase"},J={class:"grid grid-rows-1"},K={class:"grid grid-cols-2 px-4 space-x-4"},U={class:"flex items-center justify-center p-6 rounded-lg h-[300px]"},X={id:"chartImage",ref:"chartImage"},tt={id:"scatter-chart",ref:"scatterChart",class:"hidden m-0"},et={id:"bar-chart",ref:"barChart",class:"hidden m-0"},st={class:"p-6 rounded-lg"},at={class:"mt-2"},rt={class:"py-3 flex justify-between text-sm font-medium"},ot=t("dt",{class:"text-gray-500 min-w-[70px]"},"Name : ",-1),it={class:"text-gray-900 break-word"},nt={class:"py-3 flex justify-between text-sm font-medium"},ct=t("dt",{class:"text-gray-500"},"Age :",-1),dt={class:"text-gray-900"},lt={class:"py-3 flex justify-between text-sm font-medium"},ht=t("dt",{class:"text-gray-500"},"Result :",-1),_t={class:"text-gray-900"},pt={class:"py-3 flex justify-between text-sm font-medium"},mt=t("dt",{class:"text-gray-500"},"Date :",-1),gt={class:"text-gray-900"},ft={class:"py-3 flex justify-between text-sm font-medium"},ut=t("dt",{class:"text-gray-500"},"Time :",-1),wt={class:"text-gray-900"},yt={class:"grid grid-rows-1"},xt={class:"grid grid-cols-1"},bt={class:"flex justify-center px-4"},vt={class:"w-full"},kt=t("thead",{class:"text-xs font-semibold uppercase text-gray-400 bg-indigo-100"},[t("tr",null,[t("th",{class:"p-2 whitespace-nowrap border-2 rounded-tr",width:"3"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"#")]),t("th",{class:"p-2 whitespace-nowrap border-2"},[t("div",{class:"flex font-semibold justify-center text-gray-700"},"Question")]),t("th",{class:"p-2 whitespace-nowrap border-2 w-8"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"Result")])])],-1),Ct={class:"text-sm divide-y divide-gray-100"},At={class:"p-2 whitespace-nowrap border-2 text-center align-middle"},Bt={class:"p-2 whitespace-nowrap border-2 align-middle"},jt={class:"flex flex-col flex-wrap"},Tt={class:"whitespace-normal font-semibold"},It={key:0,class:"flex items-center"},Lt={class:"whitespace-normal font-semibold"},St={key:0},Pt={key:1},Dt={key:1,class:"whitespace-normal font-semibold"},Mt={class:"p-2 whitespace-nowrap border-2 text-center align-middle"},Rt={class:"flex justify-center"},Et={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-check-circle-fill text-green-500",viewBox:"0 0 16 16"},$t=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"},null,-1),zt=[$t],Ot={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-x-circle-fill text-red-500",viewBox:"0 0 16 16"},Vt=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"},null,-1),Ft=[Vt],Nt={components:{SearchIcon:R,TrashIcon:E,PencilIcon:M,ConfirmationModal:$,Head:C,Link:P,Multiselect:O,Modal:V,Pagination:z},props:{filter:Object},data(){return{finish_loading_report:!1,current_chart_type:"",bar_chart:"",scatter_chart:"",chart_image:"",show_report:!1,report:{title:"",name:"",age:"",result:"",datetime:""},chart_data:{categories:{label:[],data:[]},total_answers:4},answer_data:[]}},methods:{async waitTwoSeconds(){await new Promise(r=>setTimeout(r,2e3))},viewReport(){const r=this.$page.props.answer_record.dt_id,e=this.$page.props.answer_record.total_answers,o=this.$page.props.answer_record.chart_type;this.current_chart_type=o,this.chart_data.total_answers=e,this.bar_chart&&this.bar_chart.destroy(),this.scatter_chart&&this.scatter_chart.destroy(),this.displayChart(r,o)},displayChart(r,e){b.get(route("diagnostic_test.get_dt_categories"),{params:{dt_id:r,chart_type:e}}).then(o=>{this.chart_data.categories.label=o.data.label,this.chart_data.categories.data=o.data.data,this.chart_data.categories.data=this.splitResultByCategory(),this.initChart(e),this.initAnswers(),this.initInfos()}).catch(o=>{console.error(o)})},initChart(r){if(r==1){let o=document.getElementById("bar-chart").getContext("2d");const s=new k(o,{type:"bar",data:{labels:this.chart_data.categories.label,datasets:[{data:this.chart_data.categories.data,borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0,onComplete:function(){document.getElementById("chartImage").innerHTML='<img src="'+this.toBase64Image()+'">'}},plugins:{legend:{display:!1},datalabels:{anchor:"end",align:"end",color:"#000000",font:{size:14},formatter:function(i,p){return i}}},scales:{y:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}},x:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}}},ticks:{precision:0}},plugins:[F]});this.bar_chart=s}if(r==2){const e=this.chart_data.total_answers,o={id:"scatterArbitraryLine",beforeDatasetDraw(l,a,c){const{ctx:_,chartArea:{top:Wt,bottom:qt,left:Ht,right:Yt,width:Zt,height:Qt},scales:{x:f,y:u}}=l;B();function B(Gt,Jt,Kt,Ut){_.save(),_.beginPath(),_.strokeStyle="rgba(170, 170, 170, 1)",_.lineWidth=3,_.moveTo(f.getPixelForValue(0),u.getPixelForValue(0)),_.lineTo(f.getPixelForValue(e),u.getPixelForValue(e)),_.stroke(),_.restore()}}},s={id:"scatterAnnotationLine",beforeDraw:l=>{if(l.tooltip._active&&l.tooltip._active.length){const a=l.ctx;a.save();const c=l.tooltip._active[0];a.beginPath(),a.moveTo(c.element.x,l.chartArea.top),a.lineTo(c.element.x,c.element.y),a.lineWidth=2,a.strokeStyle="white",a.stroke(),a.restore(),a.beginPath(),a.moveTo(c.element.x,c.element.y),a.lineTo(c.element.x,l.chartArea.bottom),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore(),a.beginPath(),a.moveTo(l.chartArea.left,c.element.y),a.lineTo(c.element.x,c.element.y),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore()}}};let p=document.getElementById("scatter-chart").getContext("2d");const A=new k(p,{type:"scatter",data:{labels:this.chart_data.total_answers,datasets:[{data:[{x:this.chart_data.categories.data[0],y:this.chart_data.categories.data[1]}],borderColor:"rgba(255, 8, 0, 1)",pointStyle:"crossRot",radius:6,hoverRadius:10,fill:!1}]},options:{animation:{duration:0,onComplete:function(){document.getElementById("chartImage").innerHTML='<img src="'+this.toBase64Image()+'">'}},plugins:{legend:{display:!1}},scales:{y:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Operations"}},x:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Numbers"}}},ticks:{precision:0}},plugins:[o,s]});this.scatter_chart=A}},splitResultByCategory(){const e=this.$page.props.answer_record.answer_record.filter(s=>s.correct).reduce((s,i)=>(i.correct&&(s[i.question_category_id]?s[i.question_category_id]++:s[i.question_category_id]=1),s),{}),o={};return Object.keys(e).forEach((s,i)=>{o[i]=e[s]}),Object.values(o)},initAnswers(){this.answer_data=this.$page.props.answer_record.answer_record},initInfos(){b.post(route("diagnostic_test.get_saved_result_info"),{result_id:this.$page.props.result_id}).then(r=>{this.report.title=this.$page.props.answer_record.dt_name,this.report.name=r.data.child_name,this.report.age=r.data.child_age,this.report.result=this.$page.props.answer_record.total_correct_answers+"/"+this.$page.props.answer_record.total_answers,this.report.datetime=g(r.data.created_at).format("DD/MM/YYYY, hh:mm A"),this.finish_loading_report=!0}).catch(r=>{console.error(r)})},download(){document.getElementById("report").style.display="block";var r=document.getElementById("report");setTimeout(()=>{var e=2;N.toPng(r,{width:r.clientWidth*e,height:r.clientHeight*e,style:{transform:"scale("+e+")",transformOrigin:"top left"}}).then(function(o){var s=document.createElement("a");s.href=o,s.download="Diagnostic Test Report.png",s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}).catch(function(o){console.error("oops, something went wrong!",o)})})}},created(){this.viewReport()}},ue=Object.assign(Nt,{__name:"Report",setup(r){return(e,o)=>(d(),h(x,null,[j(m(C),{title:"Diagnostic Test Report"}),t("div",W,[w(t("div",q," Please wait, Loading Report... ",512),[[y,!e.finish_loading_report]]),w(t("div",H,[t("div",Y,[t("div",Z,[t("div",Q,[t("h1",G,"Diagnostic Test "+n(e.report.title),1)])]),t("div",J,[t("div",K,[t("div",U,[t("div",X,null,512),t("canvas",tt,null,512),t("canvas",et,null,512)]),t("div",st,[t("dl",at,[t("div",rt,[ot,t("dd",it,n(e.report.name),1)]),t("div",nt,[ct,t("dd",dt,n(e.report.age),1)]),t("div",lt,[ht,t("dd",_t,n(e.report.result),1)]),t("div",pt,[mt,t("dd",gt,n(m(g)(e.report.datetime).format("DD/MM/Y")),1)]),t("div",ft,[ut,t("dd",wt,n(m(g)(e.report.datetime).format("h:mm A")),1)])])])])]),t("div",yt,[t("div",xt,[t("div",bt,[t("table",vt,[kt,t("tbody",Ct,[(d(!0),h(x,null,T(e.answer_data,(s,i)=>(d(),h("tr",null,[t("td",At,n(++i),1),t("td",Bt,[t("div",jt,[t("p",Tt,n(s.question),1),s.answer?(d(),h("div",It,[t("p",Lt,[v("Answer: "),s.answer.length?(d(),h("span",St,n(s.answer.map(p=>p===null?"Blank":p)),1)):(d(),h("span",Pt,n(s.answer),1))])])):(d(),h("p",Dt,"Answer: "+n(s.answer+1),1))])]),t("td",Mt,[t("div",Rt,[s.correct?(d(),h("svg",Et,zt)):(d(),h("svg",Ot,Ft))])])]))),256))])])])])])],512)],512),[[y,e.finish_loading_report]]),e.finish_loading_report?(d(),I(D,{key:0,onClick:e.download},{default:L(()=>[v("Download")]),_:1},8,["onClick"])):S("",!0)])],64))}});export{ue as default};
