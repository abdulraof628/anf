import{_ as O}from"./app-dbb80022.js";import{q as d,x as u,y as l,b3 as j,b1 as L,v as i,O as n,m as R,t as b,B as y,F as f,b7 as w,U as _,u as c,I as x,J as k}from"./@vue-39dc9ff3.js";import{C as B}from"./compressorjs-dec42b9c.js";import{C as D}from"./ConfirmationModal-3a22d485.js";import{_ as E}from"./Card-b75ae06b.js";import{_ as S,d as T,e as g,c as V,a as $,b as U}from"./TableRow-da22b5e6.js";import{_ as A}from"./TableCaption-43844f83.js";import{C as I}from"./lucide-vue-next-7b48dc26.js";const F=e=>(j("data-v-e1956572"),e=e(),L(),e),P={class:"relative"},N={key:0,class:"flex justify-center items-center relative w-24 h-24 border border-gray-400 cursor-pointer"},M=["src"],q={key:1,class:"w-24 h-24 border-2 border-dashed border-gray-400 flex items-center justify-center cursor-pointer"},z=F(()=>l("p",{class:"text-gray-400"},"+",-1)),W=[z],H={methods:{resetInput(e){e.target.value=null}}},J=Object.assign(H,{__name:"UploadPreview",props:{previewUrl:{required:!0}},emits:["update:value"],setup(e,{emit:t}){const o=t;return(s,m)=>(d(),u("div",null,[l("div",P,[e.previewUrl?(d(),u("div",N,[l("img",{src:e.previewUrl,alt:"Preview",class:"object-fill w-full h-full",style:{margin:"0px"}},null,8,M)])):(d(),u("div",q,W)),l("input",{type:"file",class:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onInput:m[0]||(m[0]=p=>o("update:value",p.target.files[0])),onClick:m[1]||(m[1]=(...p)=>s.resetInput&&s.resetInput(...p))},null,32)])]))}}),G=O(J,[["__scopeId","data-v-e1956572"]]),K={class:"grid grid-cols-1 2xl:grid-cols-2 gap-4"},Q={class:"mb-3"},X={class:"grid grid-cols-1 gap-4"},Y={class:""},Z=l("span",{class:"text-red-500"},"*",-1),ee={class:"grid grid-cols-1 gap-2"},te={class:"flex items-center space-x-4"},oe=l("span",{class:"text-red-500"},"*",-1),ie=l("span",{class:"ml-1 hidden sm:block"},"Add",-1),ae={class:"mb-3"},ne={class:"grid grid-cols-1 gap-4"},se={class:""},le=l("span",{class:"text-red-500"},"*",-1),re={class:"grid grid-cols-1 gap-2"},de={class:"flex items-center space-x-4"},ue=l("span",{class:"text-red-500"},"*",-1),ce=l("span",{class:"ml-1 hidden sm:block"},"Add",-1),me={class:"flex flex-col items-center p-2 m-2"},_e={class:"flex flex-col items-center space-y-2"},fe={class:"flex flex-col justify-center items-center space-y-2"},pe={class:"flex flex-col justify-center items-center space-y-2"},he={class:"flex flex-col justify-center items-center space-y-2"},ve={class:"flex flex-col justify-center items-center space-y-2"};function be(e,t){return new File([e],t,{type:e.type})}const ye={components:[S,T,A,g,V,$,U],props:{detailed_info:Object,sub_variation_prop:Object},data(){return{sub_variations:this.sub_variation_prop?this.sub_variation_prop:{options:[{name:""}]},confirmation_modal:{is_open:!1,alert:"",title:"",text:"",button:"",method:"",route:"",data:"",preserveScroll:!0}}},watch:{"detailed_info.has_sub_variation":{handler(){const e=this.detailed_info;e.has_sub_variation||(this.sub_variations.options=[{name:""}],e.sub_variation_name="",e.variations.options.map(t=>{t.sub_variations.options=[{id:"",name:"",price:0,stock:0}]}))}},sub_variations:{handler(){this.detailed_info.has_sub_variation==1&&this.constructTable()},deep:!0},"detailed_info.variations.options":{handler(){this.detailed_info.variations.options.forEach(e=>{e.price||(e.price=0),e.stock||(e.stock=0),e.sub_variations.options.forEach(t=>{t.price||(t.price=0),t.stock||(t.stock=0)})})},deep:!0}},methods:{constructTable(){this.detailed_info.variations.options.forEach((e,t)=>{e.sub_variations.options.length&&e.sub_variations.options.forEach((o,s)=>{o.name=this.sub_variations.options[s]?this.sub_variations.options[s].name:""})})},addVariation(){if(!this.sub_variations.options.some(t=>t.name!==""))this.detailed_info.variations.options.push({id:"",name:"",images:{file:null,value:null},price:0,stock:0,sub_variations:{options:[{id:"",name:"",price:0,stock:0}]}});else{const t={id:"",name:"",images:{file:null,value:null},price:0,stock:0,sub_variations:{options:[]}};this.detailed_info.variations.options.push(t);const o=this.detailed_info.variations.options.indexOf(t);this.sub_variations.options.forEach(s=>{this.detailed_info.variations.options[o].sub_variations.options.push({id:"",name:s.name,price:0,stock:0})})}},addSubVariation(){this.sub_variations.options.push({name:""}),this.detailed_info.variations.options.forEach((e,t)=>{e.sub_variations.options.push({id:"",name:"",price:0,stock:0})})},removeVariation(e,t){t?(this.confirmation_modal.is_open=!0,this.confirmation_modal.alert="danger",this.confirmation_modal.title="Are you sure?",this.confirmation_modal.text='This will delete the variation along with the sub variations. This action will be executed once you click the DELETE button. This action is <span class="text-red-600">IRREVERSIBLE</span>. Are you confirm?',this.confirmation_modal.button="DELETE",this.confirmation_modal.method="delete",this.confirmation_modal.route="products.delete_variation",this.confirmation_modal.data=t):this.detailed_info.variations.options.splice(e,1)},removeSubVariation(e){const t=[];this.detailed_info.variations.options.forEach(o=>{o.sub_variations.options[e].id&&t.push(o.sub_variations.options[e].id)}),t.length?(this.confirmation_modal.is_open=!0,this.confirmation_modal.alert="danger",this.confirmation_modal.title="Are you sure?",this.confirmation_modal.text="This will delete this sub variation for all variation in this product. This action will be executed once you click the DELETE button. This action is IRREVERSIBLE. Are you confirm?",this.confirmation_modal.button="DELETE",this.confirmation_modal.method="delete",this.confirmation_modal.route="products.delete_sub_variation",this.confirmation_modal.data={to_delete:t}):(this.detailed_info.variations.options.forEach(o=>{o.sub_variations.options.splice(e,1)}),this.sub_variations.options.splice(e,1))},handleFileChange(e,t){e&&this.compress(e,t)},compress(e,t){const o=this.detailed_info;new B(e,{quality:.2,maxWidth:400,maxHeight:400,success(s){const m=URL.createObjectURL(s),p=be(s,Date.now()+".jpg");o.variations.options[t].images.file=p,o.variations.options[t].images.value=m}})},deleteImage(e){this.detailed_info.variations.options[e].images.file=null,this.detailed_info.variations.options[e].images.value=null},blobToFile(e,t){return new File([e],t,{type:e.type})},numbersOnly(e,t){e=e||window.event;var o=e.which?e.which:e.keyCode;if(o>31&&(o<48||o>57)&&o!==46)e.preventDefault();else{let s=e.target.value.trim();return s===""?s="0":s!=="0"&&s.startsWith("0")&&(s=s.replace(/^0+/,"")),e.target.value=s!==""?s:"0",!0}}}},ge=Object.assign(ye,{__name:"Variation",setup(e){return(t,o)=>{const s=w("Label"),m=w("Input"),p=w("Button");return d(),u(f,null,[l("div",K,[i(E,null,{content:n(()=>[l("div",Q,[i(s,{class:"text-base"},{default:n(()=>[_(" Variation ")]),_:1})]),l("div",X,[l("div",Y,[i(s,null,{default:n(()=>[_("Name"),Z]),_:1}),i(m,{type:"text",placeholder:"Example: Level",modelValue:e.detailed_info.main_variation_name,"onUpdate:modelValue":o[0]||(o[0]=r=>e.detailed_info.main_variation_name=r)},null,8,["modelValue"])]),l("div",ee,[l("div",te,[i(s,null,{default:n(()=>[_("Options"),oe]),_:1}),i(p,{onClick:t.addVariation,class:"text-xs px-2 h-0 py-4"},{default:n(()=>[i(c(I),{class:"h-4 w-4"}),ie]),_:1},8,["onClick"])]),(d(!0),u(f,null,x(e.detailed_info.variations.options,(r,h)=>(d(),u("div",{key:h,class:"flex space-x-2"},[i(m,{type:"text",class:"2xl:w-screen 2xl:max-w-96",placeholder:"Example: Level 1",modelValue:r.name,"onUpdate:modelValue":a=>r.name=a},null,8,["modelValue","onUpdate:modelValue"]),i(p,{variant:"destructive",class:"text-xs px-2 h-0 py-4",onClick:a=>e.detailed_info.variations.options.length>1?t.removeVariation(h,r.id):""},{default:n(()=>[_("Remove")]),_:2},1032,["onClick"])]))),128))])])]),_:1}),i(E,{class:R({hidden:e.detailed_info.has_sub_variation==0})},{content:n(()=>[l("div",ae,[i(s,{class:"text-base"},{default:n(()=>[_(" Sub Variation ")]),_:1})]),l("div",ne,[l("div",se,[i(s,null,{default:n(()=>[_("Name"),le]),_:1}),i(m,{type:"text",placeholder:"Example: Level",modelValue:e.detailed_info.sub_variation_name,"onUpdate:modelValue":o[1]||(o[1]=r=>e.detailed_info.sub_variation_name=r)},null,8,["modelValue"])]),l("div",re,[l("div",de,[i(s,null,{default:n(()=>[_("Options"),ue]),_:1}),i(p,{onClick:t.addSubVariation,class:"text-xs px-2 h-0 py-4"},{default:n(()=>[i(c(I),{class:"h-4 w-4"}),ce]),_:1},8,["onClick"])]),(d(!0),u(f,null,x(t.sub_variations.options,(r,h)=>(d(),u("div",{key:h,class:"flex space-x-2"},[i(m,{type:"text",class:"2xl:w-screen 2xl:max-w-96",placeholder:"Example: Level 1",modelValue:r.name,"onUpdate:modelValue":a=>r.name=a},null,8,["modelValue","onUpdate:modelValue"]),i(p,{variant:"destructive",class:"text-xs px-2 h-0 py-4",onClick:a=>t.sub_variations.options.length>1?t.removeSubVariation(h):""},{default:n(()=>[_("Remove")]),_:2},1032,["onClick"])]))),128))])])]),_:1},8,["class"])]),e.detailed_info.main_variation_name?(d(),b(E,{key:0,class:"mt-4"},{content:n(()=>[i(c(S),null,{default:n(()=>[i(c($),{class:"bg-gray-100"},{default:n(()=>[i(c(U),null,{default:n(()=>[i(c(V),{class:"text-center"},{default:n(()=>[_(k(e.detailed_info.main_variation_name),1)]),_:1}),e.detailed_info.has_sub_variation==1&&e.detailed_info.sub_variation_name&&t.sub_variations.options.some(r=>r.name!=="")?(d(),b(c(V),{key:0,class:"text-center"},{default:n(()=>[_(k(e.detailed_info.sub_variation_name),1)]),_:1})):y("",!0),i(c(V),{class:"text-center"},{default:n(()=>[_("Price")]),_:1}),i(c(V),{class:"text-center"},{default:n(()=>[_("Stock")]),_:1})]),_:1})]),_:1}),i(c(T),null,{default:n(()=>[(d(!0),u(f,null,x(e.detailed_info.variations.options,(r,h)=>(d(),u(f,null,[r.name.trim()!==""?(d(),b(c(U),{key:0},{default:n(()=>[i(c(g),null,{default:n(()=>[l("div",me,[i(G,{previewUrl:r.images.value,"onUpdate:value":a=>t.handleFileChange(a,h)},null,8,["previewUrl","onUpdate:value"]),i(s,{class:"mt-1",for:r.name},{default:n(()=>[_(k(r.name),1)]),_:2},1032,["for"])])]),_:2},1024),e.detailed_info.has_sub_variation==1&&e.detailed_info.sub_variation_name&&t.sub_variations.options.some(a=>a.name!=="")?(d(),b(c(g),{key:0},{default:n(()=>[(d(!0),u(f,null,x(r.sub_variations.options,(a,C)=>(d(),u("div",_e,[a.name?(d(),b(s,{key:0,class:"my-3",for:a.name},{default:n(()=>[_(k(a.name),1)]),_:2},1032,["for"])):y("",!0)]))),256))]),_:2},1024)):y("",!0),e.detailed_info.has_sub_variation==1&&e.detailed_info.sub_variation_name&&t.sub_variations.options.some(a=>a.name!=="")?(d(),u(f,{key:1},[i(c(g),null,{default:n(()=>[l("div",fe,[(d(!0),u(f,null,x(r.sub_variations.options,(a,C)=>(d(),u(f,null,[a.name?(d(),b(m,{key:0,type:"number",min:"0",onInput:o[2]||(o[2]=v=>t.numbersOnly(v)),class:"focus:ring-0 border-gray-300 focus:border-gray-400 rounded-md flex-1 block min-w-14",modelValue:a.price,"onUpdate:modelValue":v=>a.price=v},null,8,["modelValue","onUpdate:modelValue"])):y("",!0)],64))),256))])]),_:2},1024),i(c(g),null,{default:n(()=>[l("div",pe,[(d(!0),u(f,null,x(r.sub_variations.options,(a,C)=>(d(),u(f,null,[a.name?(d(),b(m,{key:0,type:"number",min:"0",onInput:o[3]||(o[3]=v=>t.numbersOnly(v)),class:"focus:ring-0 border-gray-300 focus:border-gray-400 rounded-md flex-1 block min-w-14",modelValue:a.stock,"onUpdate:modelValue":v=>a.stock=v},null,8,["modelValue","onUpdate:modelValue"])):y("",!0)],64))),256))])]),_:2},1024)],64)):(d(),u(f,{key:2},[i(c(g),null,{default:n(()=>[l("div",he,[i(m,{type:"number",min:"0",onInput:o[4]||(o[4]=a=>t.numbersOnly(a)),class:"focus:ring-0 border-gray-300 focus:border-gray-400 rounded-md flex-1 block min-w-14",modelValue:r.price,"onUpdate:modelValue":a=>r.price=a},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024),i(c(g),null,{default:n(()=>[l("div",ve,[i(m,{type:"number",min:"0",onInput:o[5]||(o[5]=a=>t.numbersOnly(a)),class:"focus:ring-0 border-gray-300 focus:border-gray-400 rounded-md flex-1 block min-w-14",modelValue:r.stock,"onUpdate:modelValue":a=>r.stock=a},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024)],64))]),_:2},1024)):y("",!0)],64))),256))]),_:1})]),_:1})]),_:1})):y("",!0),i(D,{show:t.confirmation_modal.is_open,onClose:o[6]||(o[6]=r=>t.confirmation_modal.is_open=!1),confirmationAlert:t.confirmation_modal.alert,confirmationTitle:t.confirmation_modal.title,confirmationText:t.confirmation_modal.text,confirmationButton:t.confirmation_modal.button,confirmationMethod:t.confirmation_modal.method,confirmationRoute:t.confirmation_modal.route,confirmationData:t.confirmation_modal.data,preserveScroll:t.confirmation_modal.preserveScroll,preserveState:t.confirmation_modal.preserveState},null,8,["show","confirmationAlert","confirmationTitle","confirmationText","confirmationButton","confirmationMethod","confirmationRoute","confirmationData","preserveScroll","preserveState"])],64)}}}),Se=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));export{G as U,Se as V,ge as _};
