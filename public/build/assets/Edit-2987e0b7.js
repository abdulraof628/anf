import{o as i,c as r,b as p,u as b,w as c,F as f,H as w,L as $,d as e,e as V,f as l,l as n,h,t as m,j as _,g as F,n as g,D,k as y}from"./app-32370625.js";import{B as U}from"./Authenticated-00d249ef.js";import{B as v}from"./Button-c029d0a2.js";import{h as x}from"./moment-fbc5633a.js";import{Z as M}from"./vue-datepicker-801bee1e.js";import"./ApplicationLogo-82722830.js";import"./XIcon-8395e945.js";import"./toggle-a24e2ecb.js";import"./_plugin-vue_export-helper-c27b6911.js";const C={class:"md:grid md:grid-cols-2"},L={class:"md:mt-0 md:col-span-2"},O={class:"px-4 py-5 bg-indigo-50 space-y-6 sm:p-6"},B={class:"grid grid-rows-1 grid-cols-2 sm:grid-cols-2 gap-4"},I={class:"sm:row-span-3"},P={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-md h-full"},S=e("div",{class:"mb-5"},[e("h1",{class:"font-bold text-indigo-800"},"Invoice Information"),e("div",{class:"border-b border-dashed border-indigo-900 mt-1"})],-1),N={class:"grid grid-cols-1"},j={class:"mb-4"},z=e("label",{for:"invoice_number",class:"block text-sm font-bold text-gray-700"}," Invoice Number ",-1),T={class:"mt-1 flex rounded-md shadow-sm"},E={class:"grid grid-cols-1"},A={class:"mb-4"},W=e("label",{for:"student_name",class:"block text-sm font-bold text-gray-700"}," Student Name ",-1),H={class:"mt-1 flex rounded-md shadow-sm"},R={class:"grid grid-cols-2 gap-4"},Y={class:"mb-4"},Z=e("label",{for:"date_issued",class:"block text-sm font-bold text-gray-700"}," Date Issued ",-1),J={class:"mt-1 flex rounded-md shadow-sm"},q={class:"mb-4"},G=e("label",{for:"due_date",class:"block text-sm font-bold text-gray-700"}," Due Date ",-1),K={class:"mt-1 flex rounded-md shadow-sm"},Q={class:"grid grid-cols-1"},X={class:"mb-10"},ee=e("thead",null,[e("tr",{class:"bg-gray-600"},[e("th",{class:"text-left text-white text-sm py-2 px-4 w-1/12"},"#"),e("th",{class:"text-left text-white text-sm py-2 px-4 w-7/12"},"Programme"),e("th",{class:"text-left text-white text-sm py-2 px-4 w-2/12"},"Discount"),e("th",{class:"text-left text-white text-sm py-2 px-4 w-2/12"},"Amount")])],-1),oe={class:"border text-sm align-top py-2 px-4"},se={class:"border text-sm py-2 px-4"},te={class:"flex flex-col space-y-4"},de={class:"bg-indigo-300 py-2 px-3 rounded-t-md"},ae={class:"font-semibold"},ie={class:"flex flex-col space-y-2 pl-5"},re={class:"bg-indigo-100 py-1 px-3 rounded-sm"},le={key:0,class:"bg-indigo-100 py-1 px-3 rounded-sm"},ne=e("label",null," Material Fee ",-1),me=[ne],pe={class:"border text-sm py-2 px-4 align-bottom"},ce={class:"flex flex-col space-y-1.5"},ue=["onUpdate:modelValue"],fe=["onUpdate:modelValue"],_e={class:"border text-sm py-2 px-4 align-bottom"},ge={class:"flex flex-col space-y-1.5"},be=["onUpdate:modelValue"],he=["onUpdate:modelValue"],ye=e("div",{class:"border-b border-dashed border-indigo-900 mb-5"},null,-1),ve={class:"grid grid-cols-3"},xe={class:"mb-4 text-left"},we=e("label",{for:"payment_status",class:"block text-sm font-bold text-gray-700"}," Payment Status ",-1),ke=["value"],$e=e("div",{class:"mb-4"},null,-1),Ve={class:"mb-4 text-right pr-5"},Fe=e("label",{for:"amount",class:"block text-md font-bold text-gray-700"}," Total Amount",-1),De={class:"text-2xl font-bold text-indigo-500"},Ue={class:"sm:row-span-3"},Me={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-md h-full"},Ce=e("div",{class:"mb-5"},[e("h1",{class:"font-bold text-indigo-800"},"Collect Payment"),e("div",{class:"border-b border-dashed border-indigo-900 mt-1"})],-1),Le={class:"grid grid-cols-1"},Oe={class:"mb-4"},Be=e("label",{for:"date",class:"block text-sm font-bold text-gray-700"}," Date ",-1),Ie={class:"mt-1 flex rounded-md shadow-sm"},Pe={class:"mb-4"},Se=e("label",{for:"transaction_id",class:"block text-sm font-bold text-gray-700"}," Transaction ID ",-1),Ne={class:"mt-1 flex rounded-md shadow-sm"},je={class:"grid grid-cols-1"},ze={class:"mb-4"},Te=e("label",{for:"student_name",class:"block text-sm font-bold text-gray-700"}," Proof of Payment ",-1),Ee={class:"mt-1 items-center space-x-2 w-full"},Ae={key:0,class:"mb-4"},We={class:"block focus:ring-0 focus:border-gray-300"},He=e("span",{class:"sr-only"},"Browse File",-1),Re={key:1,class:"flex justify-between py-2 border bg-gray-50 shadow-md p-4 rounded-md"},Ye=["href"],Ze=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 448 512"},[e("path",{d:"M364.2 83.8c-24.4-24.4-64-24.4-88.4 0l-184 184c-42.1 42.1-42.1 110.3 0 152.4s110.3 42.1 152.4 0l152-152c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-152 152c-64 64-167.6 64-231.6 0s-64-167.6 0-231.6l184-184c46.3-46.3 121.3-46.3 167.6 0s46.3 121.3 0 167.6l-176 176c-28.6 28.6-75 28.6-103.6 0s-28.6-75 0-103.6l144-144c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-144 144c-6.7 6.7-6.7 17.7 0 24.4s17.7 6.7 24.4 0l176-176c24.4-24.4 24.4-64 0-88.4z"})],-1),Je={class:"flex"},qe=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",fill:"currentColor",class:"text-white h-3 w-3"},[e("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})],-1),Ge=[qe],Ke={class:"grid grid-rows-1 grid-cols-1 sm:grid-cols-1 gap-4"},Qe={class:"sm:row-span-3"},Xe={class:"p-6 bg-white border border-gray-200 rounded-lg shadow-md"},eo={class:"flex items-center justify-end"},oo={class:"flex space-x-2"},so={components:{Head:w,Link:$},data(){return{date_issued:x(this.$page.props.invoice_data.date_issued).format("DD MMM Y"),due_date:x(this.$page.props.invoice_data.due_date).format("DD MMM Y"),form:{params:this.$page.props.params,invoice_id:this.$page.props.invoice_data.id,invoice_items:JSON.parse(this.$page.props.invoice_data.invoice_items),invoice_amount:this.$page.props.invoice_data.amount,payment:{status:this.$page.props.invoice_data.status,date:this.$page.props.invoice_data.payment_date,transaction_id:this.$page.props.invoice_data.payment_transaction_id,proof:{url:this.$page.props.invoice_data.payment_proof?this.$page.props.invoice_data.payment_proof:"",file:"",delete_previous:!1}}}}},watch:{"form.invoice_items":{handler(a){a.forEach(o=>{o.programme_fee||(o.programme_fee=0),o.programme_fee_discount||(o.programme_fee_discount=0),o.material_fee||(o.material_fee=0),o.material_fee_discount||(o.material_fee_discount=0)})},deep:!0}},methods:{submit(){this.form.invoice_amount=this.totalFee(this.form.invoice_items),this.$inertia.post(route("fee.invoices.update"),this.form,{preserveState:!0})},numbersOnly(a){a=a||window.event;var o=a.which?a.which:a.keyCode;if(o>31&&(o<48||o>57)&&o!==46)a.preventDefault();else{let s=a.target.value.trim();return s===""?s="0":s!=="0"&&s.startsWith("0")&&(s=s.replace(/^0+/,"")),a.target.value=s!==""?s:"0",!0}},totalFee(a){let o=0;for(const s of a){const t=parseFloat(s.programme_fee),u=parseFloat(s.programme_fee_discount),d=parseFloat(s.material_fee),k=parseFloat(s.material_fee_discount);o+=t-u,s.include_material_fee&&(o+=d-k)}return o},deleteProof(){this.form.payment.proof.url=[],this.form.payment.proof.file="",this.form.payment.proof.delete_previous=!0},uploadFile(a){const o=a.target.files[0];o.type=="application/pdf"||o.name.toLowerCase().endsWith(".pdf")||o.type=="image/jpeg"||o.name.toLowerCase().endsWith(".png")?(this.form.payment.proof.url=[URL.createObjectURL(o)],this.form.payment.proof.file=o):(alert("Only Image / PDF File allowed!"),this.$refs.file_input.value="",this.form.payment.proof.url="",this.form.payment.proof.file="")}}},uo=Object.assign(so,{__name:"Edit",setup(a){return(o,s)=>(i(),r(f,null,[p(b(w),{title:"Fee Invoices"}),p(U,null,{header:c(()=>[]),default:c(()=>[e("div",C,[e("div",L,[e("form",{onSubmit:s[13]||(s[13]=V((...t)=>o.submit&&o.submit(...t),["prevent"]))},[e("div",O,[e("div",B,[e("div",I,[e("div",P,[S,e("div",N,[e("div",j,[z,e("div",T,[l(e("input",{disabled:"",type:"text",name:"invoice_number",id:"invoice_number",class:"focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 bg-gray-100","onUpdate:modelValue":s[0]||(s[0]=t=>o.$page.props.invoice_data.invoice_number=t),autocomplete:"off"},null,512),[[n,o.$page.props.invoice_data.invoice_number]])])])]),e("div",E,[e("div",A,[W,e("div",H,[l(e("input",{disabled:"",type:"text",name:"student_name",id:"student_name",class:"focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 bg-gray-100","onUpdate:modelValue":s[1]||(s[1]=t=>o.$page.props.invoice_data.student_name=t),autocomplete:"off"},null,512),[[n,o.$page.props.invoice_data.student_name]])])])]),e("div",R,[e("div",Y,[Z,e("div",J,[l(e("input",{disabled:"",type:"text",name:"date_issued",id:"date_issued",class:"focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 bg-gray-100","onUpdate:modelValue":s[2]||(s[2]=t=>o.date_issued=t),autocomplete:"off"},null,512),[[n,o.date_issued]])])]),e("div",q,[G,e("div",K,[l(e("input",{disabled:"",type:"text",name:"due_date",id:"due_date",class:"focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300 bg-gray-100","onUpdate:modelValue":s[3]||(s[3]=t=>o.due_date=t),autocomplete:"off"},null,512),[[n,o.due_date]])])])]),e("div",Q,[e("div",X,[e("table",null,[ee,e("tbody",null,[(i(!0),r(f,null,h(o.form.invoice_items,(t,u)=>(i(),r("tr",null,[e("td",oe,m(u+1),1),e("td",se,[e("div",te,[e("div",de,[e("label",ae,m(t.programme_name)+" ( Level "+m(t.programme_level)+" )",1)]),e("div",ie,[e("div",re,[e("label",null,m(t.programme_type),1)]),t.include_material_fee?(i(),r("div",le,me)):_("",!0)])])]),e("td",pe,[e("div",ce,[l(e("input",{type:"number",min:"0",name:"",id:"",class:"py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300","onUpdate:modelValue":d=>t.programme_fee_discount=d,autocomplete:"off",onInput:s[4]||(s[4]=(...d)=>o.numbersOnly&&o.numbersOnly(...d))},null,40,ue),[[n,t.programme_fee_discount]]),t.include_material_fee?l((i(),r("input",{key:0,type:"number",min:"0",name:"",id:"",class:"py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300","onUpdate:modelValue":d=>t.material_fee_discount=d,autocomplete:"off",onInput:s[5]||(s[5]=(...d)=>o.numbersOnly&&o.numbersOnly(...d))},null,40,fe)),[[n,t.material_fee_discount]]):_("",!0)])]),e("td",_e,[e("div",ge,[l(e("input",{type:"number",min:"0",name:"",id:"",class:"py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300","onUpdate:modelValue":d=>t.programme_fee=d,autocomplete:"off",onInput:s[6]||(s[6]=(...d)=>o.numbersOnly&&o.numbersOnly(...d))},null,40,be),[[n,t.programme_fee]]),t.include_material_fee?l((i(),r("input",{key:0,type:"number",min:"0",name:"",id:"",class:"py-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300","onUpdate:modelValue":d=>t.material_fee=d,autocomplete:"off",onInput:s[7]||(s[7]=(...d)=>o.numbersOnly&&o.numbersOnly(...d))},null,40,he)),[[n,t.material_fee]]):_("",!0)])])]))),256))])])])]),ye,e("div",ve,[e("div",xe,[we,l(e("select",{name:"payment_status",id:"payment_status",class:"mt-1 focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm border-gray-300",autocomplete:"off","onUpdate:modelValue":s[8]||(s[8]=t=>o.form.payment.status=t)},[(i(!0),r(f,null,h(o.$page.props.invoice_status,t=>(i(),r("option",{value:t.id},m(t.name),9,ke))),256))],512),[[F,o.form.payment.status]])]),$e,e("div",Ve,[Fe,e("span",De,m(o.totalFee(o.form.invoice_items)),1)])])])]),e("div",Ue,[e("div",Me,[Ce,e("div",Le,[e("div",Oe,[Be,e("div",Ie,[p(b(M),{class:g("focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm"),style:D(o.$page.props.errors.date?"--dp-border-color: #fa9e9e":""),"input-class-name":"invoices-input-date-picker focus:ring-0",modelValue:o.form.payment.date,"onUpdate:modelValue":s[9]||(s[9]=t=>o.form.payment.date=t),enableTimePicker:!1,"auto-apply":!0,format:"dd/MM/yyyy"},null,8,["style","modelValue"])])]),e("div",Pe,[Se,e("div",Ne,[l(e("input",{type:"text",name:"transaction_id",id:"transaction_id",class:g(["focus:ring-0 focus:border-indigo-300 flex-1 block w-full rounded-md sm:text-sm",o.$page.props.errors.transaction_id?"border-red-300":"border-gray-300"]),"onUpdate:modelValue":s[10]||(s[10]=t=>o.form.payment.transaction_id=t),autocomplete:"off"},null,2),[[n,o.form.payment.transaction_id]])])])]),e("div",je,[e("div",ze,[Te,e("div",Ee,[o.form.payment.proof.url.length?(i(),r("div",Re,[e("a",{href:o.form.payment.proof.file?o.form.payment.proof.url:"/storage/proof_of_payment/"+o.form.payment.proof.url,download:"",class:"flex items-center space-x-2 text-indigo-500 hover:text-indigo-600"},[Ze,e("span",null,m(o.form.payment.proof.file?o.form.payment.proof.file.name:o.form.payment.proof.url),1)],8,Ye),e("div",Je,[e("button",{type:"button",class:"rounded-md p-2 bg-red-500 text-white",onClick:s[12]||(s[12]=t=>o.deleteProof())},Ge)])])):(i(),r("div",Ae,[e("label",We,[He,e("input",{type:"file",ref:"file_input",class:g(["focus:ring-0 border rounded-md block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:border-0 file:text-sm file:font-semibold file:bg-gray-200 file:text-gray-700 focus:outline-none",o.$page.props.errors.proof?"border-red-300":"border-gray-300"]),onChange:s[11]||(s[11]=(...t)=>o.uploadFile&&o.uploadFile(...t))},null,34)])]))])])])])])]),e("div",Ke,[e("div",Qe,[e("div",Xe,[e("div",eo,[e("div",oo,[p(v,{buttonType:"gray",route:o.route("fee.invoices",o.$page.props.params)},{default:c(()=>[y("Cancel")]),_:1},8,["route"]),p(v,{type:"submit"},{default:c(()=>[y("Save")]),_:1})])])])])])])],32)])])]),_:1})],64))}});export{uo as default};
