import{_ as y}from"./Authenticated-f6dcb3f6.js";import{o as n,c,a as d,u as i,w as b,F as _,H as h,L as w,b as x,d as e,e as D,t as p,n as k,p as m}from"./app-21760c51.js";import{h as u}from"./moment-a9aaa855.js";import"./XIcon-20b46cbe.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./transition-84530faa.js";import"./keyboard-69855180.js";import"./use-resolve-button-type-a6d172a5.js";import"./menu-a9efdbbb.js";const v={class:"overflow-x-auto no-scrollbar"},F={class:"bg-white shadow rounded-lg border"},N={class:"w-full text-sm text-left text-gray-500"},I=e("thead",{class:"text-gray-700 capitalize bg-gray-200"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}," Invoice Number "),e("th",{scope:"col",class:"px-6 py-3"}," Date Issued "),e("th",{scope:"col",class:"px-6 py-3"}," Due Date "),e("th",{scope:"col",class:"px-6 py-3 text-center"}," Amount "),e("th",{scope:"col",class:"px-6 py-3 text-center"}," Status "),e("th",{scope:"col",class:"px-6 py-3 text-center"}," Action ")])],-1),M={key:0,class:"bg-white border-b"},C=e("td",{class:"text-center py-4",colspan:"10"}," No record found. ",-1),L=[C],S={class:"bg-white border-b hover:bg-gray-50"},$={class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap"},B={class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap"},E={class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap"},V={class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap text-center"},z={class:"px-6 py-4 text-center"},A={class:"px-6 py-4 text-center"},O=["href"],U=["onClick"],j={components:{Head:h,Link:w},data(){return{open_modal:!1,generating:[],invoice_data:{parent_name:"",parent_address:"No 27, Jalan Kap Empat, 17/17D, Seksyen 17, Shah Alam",invoice_number:"",invoice_items:[],date_issued:"",due_date:"",total_amount:""}}},methods:{viewInvoice(o,s){this.generating[s]||(this.generating[s]=!0,x.get(route("fee.invoices.generate"),{responseType:"blob",params:{invoice_id:o}}).then(r=>{const t=new Blob([r.data],{type:"application/pdf"}),a=URL.createObjectURL(t);window.open(a,"_blank"),this.generating[s]=!1}).catch(r=>{console.error("Error fetching PDF:",r),this.generating[s]=!1}))},totalFee(o){let s=0;const r=JSON.parse(o);for(const t of r){const a=parseFloat(t.programme_fee),l=parseFloat(t.programme_fee_discount),g=parseFloat(t.material_fee),f=parseFloat(t.material_fee_discount);s+=a-l,t.include_material_fee&&(s+=g-f)}return s},pay(o){window.location.href="https://www.billplz-sandbox.com/bills/"+o}},mounted(){this.$page.props.invoices.forEach(o=>{this.generating.push(!1)})}},Q=Object.assign(j,{__name:"Index",setup(o){return(s,r)=>(n(),c(_,null,[d(i(h),{title:"Invoices"}),d(y,null,{default:b(()=>[e("div",v,[e("div",F,[e("table",N,[I,e("tbody",null,[s.$page.props.invoices.length?(n(!0),c(_,{key:1},D(s.$page.props.invoices,(t,a)=>(n(),c("tr",S,[e("td",$,p(t.invoice_number),1),e("td",B,p(i(u)(t.date_issued).format("DD MMM Y")),1),e("td",E,p(i(u)(t.due_date).format("DD MMM Y")),1),e("td",V,p(t.amount),1),e("td",z,[e("span",{class:k(["text-xs font-medium px-2 py-1 rounded",[t.status_bg_color,t.status_text_color]])},p(t.status),3)]),e("td",A,[t.status_id==1?(n(),c("a",{key:0,href:t.payment_url,class:"cursor-pointer font-medium px-3 py-1 text-indigo-600 hover:bg-indigo-200 hover:rounded whitespace-nowrap"},"Pay Now",8,O)):m("",!0),t.status_id==2?(n(),c("a",{key:1,class:"cursor-pointer font-medium px-3 py-1 text-blue-600 bg-blue-100 hover:bg-blue-200 rounded whitespace-nowrap",onClick:l=>s.generating[a]?"":s.viewInvoice(t.id,a)},p(s.generating[a]?"Generating...":"View / Download"),9,U)):m("",!0)])]))),256)):(n(),c("tr",M,L))])])])])]),_:1})],64))}});export{Q as default};
