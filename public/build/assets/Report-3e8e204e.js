import{o as d,c as h,b as A,u as B,d as t,f,i as u,t as n,F as w,h as j,m as T,w as I,j as L,H as v,L as S,ab as P,k as y}from"./app-dddabf93.js";import{B as $}from"./Button-7a08444b.js";import{r as R}from"./PencilIcon-7a9f05d7.js";import{r as D}from"./SearchIcon-24b865bf.js";import{r as E}from"./TrashIcon-670769aa.js";import"./toggle-46ef5ea0.js";import{C as M}from"./ConfirmationModal-3989e70a.js";import{P as z}from"./Pagination-8d208f0c.js";import{h as x}from"./moment-fbc5633a.js";import{s as O}from"./multiselect-a77f3869.js";import{M as V}from"./Modal-99905925.js";import"./auto-65a5f8f0.js";import{p as F,d as N}from"./dom-to-image-10cc136e.js";import{C as b}from"./chart-30d8fb54.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./transition-4432facc.js";import"./VueFinalModal.esm-468c5cf2.js";/* empty css                                                              */const W={class:"flex flex-col items-center p-3 space-y-4"},q={class:"mt-16"},H={class:"border border-gray-700 w-[210mm]"},Y={class:"flex flex-col justify-between space-y-2 bg-white p-3 py-5",id:"report",ref:"report"},Z={class:"grid grid-rows-1"},Q={class:"flex justify-center"},G={class:"font-bold text-slate-800 text-2xl py-4 uppercase"},J={class:"grid grid-rows-1"},K={class:"grid grid-cols-2 px-4 space-x-4"},U={class:"flex items-center justify-center p-6 rounded-lg h-[300px]"},X={id:"chartImage",ref:"chartImage"},tt={id:"scatter-chart",ref:"scatterChart",class:"hidden m-0"},et={id:"bar-chart",ref:"barChart",class:"hidden m-0"},st={class:"p-6 rounded-lg"},at={class:"mt-2"},rt={class:"py-3 flex justify-between text-sm font-medium"},ot=t("dt",{class:"text-gray-500 min-w-[70px]"},"Name : ",-1),it={class:"text-gray-900 break-word"},nt={class:"py-3 flex justify-between text-sm font-medium"},ct=t("dt",{class:"text-gray-500"},"Age :",-1),dt={class:"text-gray-900"},lt={class:"py-3 flex justify-between text-sm font-medium"},ht=t("dt",{class:"text-gray-500"},"Result :",-1),_t={class:"text-gray-900"},pt={class:"py-3 flex justify-between text-sm font-medium"},mt=t("dt",{class:"text-gray-500"},"Date :",-1),gt={class:"text-gray-900"},ft={class:"py-3 flex justify-between text-sm font-medium"},ut=t("dt",{class:"text-gray-500"},"Time :",-1),wt={class:"text-gray-900"},yt={class:"grid grid-rows-1"},xt={class:"grid grid-cols-1"},bt={class:"flex justify-center px-4"},vt={class:"w-full"},kt=t("thead",{class:"text-xs font-semibold uppercase text-gray-400 bg-indigo-100"},[t("tr",null,[t("th",{class:"p-2 whitespace-nowrap border-2 rounded-tr",width:"3"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"#")]),t("th",{class:"p-2 whitespace-nowrap border-2"},[t("div",{class:"flex font-semibold justify-center text-gray-700"},"Question")]),t("th",{class:"p-2 whitespace-nowrap border-2 w-8"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"Result")])])],-1),Ct={class:"text-sm divide-y divide-gray-100"},At={class:"p-2 whitespace-nowrap border-2 text-center align-middle"},Bt={class:"p-2 whitespace-nowrap border-2 align-middle"},jt={class:"flex flex-col flex-wrap"},Tt={class:"whitespace-normal font-semibold"},It={key:0,class:"flex items-center"},Lt={class:"whitespace-normal font-semibold"},St={key:0},Pt={key:1},$t={key:1,class:"whitespace-normal font-semibold"},Rt={class:"p-2 whitespace-nowrap border-2 text-center align-middle"},Dt={class:"flex justify-center"},Et={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-check-circle-fill text-green-500",viewBox:"0 0 16 16"},Mt=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"},null,-1),zt=[Mt],Ot={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-x-circle-fill text-red-500",viewBox:"0 0 16 16"},Vt=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"},null,-1),Ft=[Vt],Nt={components:{SearchIcon:D,TrashIcon:E,PencilIcon:R,ConfirmationModal:M,Head:v,Link:S,Multiselect:O,Modal:V,Pagination:z},props:{filter:Object},data(){return{finish_loading_report:!1,current_chart_type:"",bar_chart:"",scatter_chart:"",chart_image:"",show_report:!1,report:{title:"",name:"",age:"",result:"",datetime:""},chart_data:{categories:{label:[],data:[]},total_answers:4},answer_data:[]}},methods:{async waitTwoSeconds(){await new Promise(o=>setTimeout(o,2e3))},viewReport(){const o=this.$page.props.answer_record.dt_id,e=this.$page.props.answer_record.total_answers,r=this.$page.props.answer_record.chart_type;this.current_chart_type=r,this.chart_data.total_answers=e,this.bar_chart&&this.bar_chart.destroy(),this.scatter_chart&&this.scatter_chart.destroy(),this.displayChart(o,r)},displayChart(o,e){P.get(route("diagnostic_test.get_dt_categories"),{params:{dt_id:o,chart_type:e}}).then(r=>{this.chart_data.categories.label=r.data.label,this.chart_data.categories.data=r.data.data,this.chart_data.categories.data=this.splitResultByCategory(),this.initChart(e),this.initAnswers(),this.initInfos()}).catch(r=>{console.error(r)})},initChart(o){if(o==1){let r=document.getElementById("bar-chart").getContext("2d");const s=new b(r,{type:"bar",data:{labels:this.chart_data.categories.label,datasets:[{data:this.chart_data.categories.data,borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0,onComplete:function(){document.getElementById("chartImage").innerHTML='<img src="'+this.toBase64Image()+'">'}},plugins:{legend:{display:!1},datalabels:{anchor:"end",align:"end",color:"#000000",font:{size:14},formatter:function(i,p){return i}}},scales:{y:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}},x:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}}},ticks:{precision:0}},plugins:[F]});this.bar_chart=s}if(o==2){const e=this.chart_data.total_answers,r={id:"scatterArbitraryLine",beforeDatasetDraw(l,a,c){const{ctx:_,chartArea:{top:Wt,bottom:qt,left:Ht,right:Yt,width:Zt,height:Qt},scales:{x:m,y:g}}=l;C();function C(Gt,Jt,Kt,Ut){_.save(),_.beginPath(),_.strokeStyle="rgba(170, 170, 170, 1)",_.lineWidth=3,_.moveTo(m.getPixelForValue(0),g.getPixelForValue(0)),_.lineTo(m.getPixelForValue(e),g.getPixelForValue(e)),_.stroke(),_.restore()}}},s={id:"scatterAnnotationLine",beforeDraw:l=>{if(l.tooltip._active&&l.tooltip._active.length){const a=l.ctx;a.save();const c=l.tooltip._active[0];a.beginPath(),a.moveTo(c.element.x,l.chartArea.top),a.lineTo(c.element.x,c.element.y),a.lineWidth=2,a.strokeStyle="white",a.stroke(),a.restore(),a.beginPath(),a.moveTo(c.element.x,c.element.y),a.lineTo(c.element.x,l.chartArea.bottom),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore(),a.beginPath(),a.moveTo(l.chartArea.left,c.element.y),a.lineTo(c.element.x,c.element.y),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore()}}};let p=document.getElementById("scatter-chart").getContext("2d");const k=new b(p,{type:"scatter",data:{labels:this.chart_data.total_answers,datasets:[{data:[{x:this.chart_data.categories.data[0],y:this.chart_data.categories.data[1]}],borderColor:"rgba(255, 8, 0, 1)",pointStyle:"crossRot",radius:6,hoverRadius:10,fill:!1}]},options:{animation:{duration:0,onComplete:function(){document.getElementById("chartImage").innerHTML='<img src="'+this.toBase64Image()+'">'}},plugins:{legend:{display:!1}},scales:{y:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Operations"}},x:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Numbers"}}},ticks:{precision:0}},plugins:[r,s]});this.scatter_chart=k}},splitResultByCategory(){const e=this.$page.props.answer_record.answer_record.filter(s=>s.correct).reduce((s,i)=>(i.correct&&(s[i.question_category_id]?s[i.question_category_id]++:s[i.question_category_id]=1),s),{}),r={};return Object.keys(e).forEach((s,i)=>{r[i]=e[s]}),Object.values(r)},initAnswers(){this.answer_data=this.$page.props.answer_record.answer_record},initInfos(){this.report.title=this.$page.props.answer_record.dt_name,this.report.name=this.$page.props.answer_record.child_name,this.report.age=this.$page.props.answer_record.child_age,this.report.result=this.$page.props.answer_record.total_correct_answers+"/"+this.$page.props.answer_record.total_answers,this.report.date=x(this.$page.props.answer_record.created_at).format("DD/MM/YYYY"),this.report.time=x(this.$page.props.answer_record.created_at).format("hh:mm A"),this.finish_loading_report=!0},download(){document.getElementById("report").style.display="block";var o=document.getElementById("report");setTimeout(()=>{var e=2;N.toPng(o,{width:o.clientWidth*e,height:o.clientHeight*e,style:{transform:"scale("+e+")",transformOrigin:"top left"}}).then(function(r){var s=document.createElement("a");s.href=r,s.download="Diagnostic Test Report.png",s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}).catch(function(r){console.error("oops, something went wrong!",r)})})}},created(){this.viewReport()}},ue=Object.assign(Nt,{__name:"Report",setup(o){return(e,r)=>(d(),h(w,null,[A(B(v),{title:"Diagnostic Test Report"}),t("div",W,[f(t("div",q," Please wait, Loading Report... ",512),[[u,!e.finish_loading_report]]),f(t("div",H,[t("div",Y,[t("div",Z,[t("div",Q,[t("h1",G,"Diagnostic Test "+n(e.report.title),1)])]),t("div",J,[t("div",K,[t("div",U,[t("div",X,null,512),t("canvas",tt,null,512),t("canvas",et,null,512)]),t("div",st,[t("dl",at,[t("div",rt,[ot,t("dd",it,n(e.report.name),1)]),t("div",nt,[ct,t("dd",dt,n(e.report.age),1)]),t("div",lt,[ht,t("dd",_t,n(e.report.result),1)]),t("div",pt,[mt,t("dd",gt,n(e.report.date),1)]),t("div",ft,[ut,t("dd",wt,n(e.report.time),1)])])])])]),t("div",yt,[t("div",xt,[t("div",bt,[t("table",vt,[kt,t("tbody",Ct,[(d(!0),h(w,null,j(e.answer_data,(s,i)=>(d(),h("tr",null,[t("td",At,n(++i),1),t("td",Bt,[t("div",jt,[t("p",Tt,n(s.question),1),s.answer?(d(),h("div",It,[t("p",Lt,[y("Answer: "),s.answer.length?(d(),h("span",St,n(s.answer.map(p=>p===null?"Blank":p)),1)):(d(),h("span",Pt,n(s.answer),1))])])):(d(),h("p",$t,"Answer: "+n(s.answer+1),1))])]),t("td",Rt,[t("div",Dt,[s.correct?(d(),h("svg",Et,zt)):(d(),h("svg",Ot,Ft))])])]))),256))])])])])])],512)],512),[[u,e.finish_loading_report]]),e.finish_loading_report?(d(),T($,{key:0,onClick:e.download},{default:I(()=>[y("Download")]),_:1},8,["onClick"])):L("",!0)])],64))}});export{ue as default};
