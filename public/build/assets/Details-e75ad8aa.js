import{c as d,a as m,u,w as g,F as y,H as A,L as S,ad as b,o as l,b as t,e as D,l as P,h as I,r as v,t as n,i as k}from"./app-76003339.js";import{B as R}from"./Authenticated-2265def5.js";import{B as f}from"./Button-25067af7.js";import{C as z}from"./ConfirmationModal-37417c3b.js";import{P as T}from"./Pagination-a7f37a52.js";import{h as B}from"./default.css_vue_type_style_index_0_src_true_lang-d960564a.js";import{s as E}from"./multiselect-63ca98d5.js";import{M as j}from"./Modal-be0dda9b.js";import"./auto-7bcec486.js";import{r as $}from"./SearchIcon-2bfeef5e.js";import{r as V}from"./TrashIcon-a955ad26.js";import{r as O}from"./PencilIcon-a4dd03f2.js";import{C}from"./chart-7b9d2373.js";import"./ApplicationLogo-1fd67e39.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./transition-e92b5099.js";import"./VueFinalModal.esm-cec985c2.js";const Y={class:"py-4 px-4"},F={class:"mx-auto"},N={class:"align-middle inline-block min-w-full px-2"},H={class:"flex justify-between mb-4"},W={class:"flex space-x-2"},Z={class:"flex relative text-gray-400 focus-within:text-gray-600"},q={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},G={class:"min-w-full divide-y divide-gray-200"},Q=t("thead",{class:"bg-gray-300"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/14"},"#"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-3/14"},"Level"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-2/14"},"Result"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-2/14"},"Date Taken"),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider w-2/14"},"Action")])],-1),U={class:"bg-white divide-y divide-gray-200"},J={key:0},K=t("td",{class:"text-center",colspan:"10"},[t("div",{class:"p-3"}," No Record Found! ")],-1),X=[K],tt={class:"px-6 py-4 whitespace-nowrap"},et={class:"text-sm font-medium text-gray-700"},st={class:"px-6 py-4 whitespace-nowrap"},at={class:"text-sm font-medium text-gray-900"},rt={class:"px-6 py-4 whitespace-nowrap"},ot={class:"text-sm font-medium text-gray-900"},it={class:"px-6 py-4 whitespace-nowrap"},nt={class:"text-sm font-medium text-gray-900"},ct={class:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium"},dt={class:"flex justify-center space-x-2"},lt={key:0,class:"flex items-center space-x-2"},pt=t("svg",{class:"inline-block h-4 w-4 animate-spin rounded-full border-2 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]",viewBox:"0 0 24 24"},null,-1),ht=t("span",null,"Generating...",-1),_t=[pt,ht],mt={key:1},gt=t("h3",{class:"text-gray-900 text-xl font-semibold"}," Diagnostic Test Report ",-1),ut={class:"flex justify-center bg-gray-200 py-4 rounded max-h-[90%] overflow-y-auto no-scrollbar",id:"report"},yt={class:"bg-white w-[210mm] h-[297mm] space-y-6 py-4"},ft={class:"grid grid-rows-1"},wt={class:"flex justify-center"},xt={class:"font-bold text-slate-800 text-2xl py-4 uppercase"},bt={class:"grid grid-rows-1"},vt={class:"grid grid-cols-2 px-4 space-x-4"},kt=t("div",{class:"flex items-center justify-center border-2 p-6 rounded-lg"},[t("div",{id:"chart_image"}),t("canvas",{id:"scatter-chart",class:"hidden m-0"}),t("canvas",{id:"bar-chart",class:"hidden m-0"})],-1),Ct={class:"border-2 p-6 rounded-lg"},At={class:"mt-2 divide-y divide-gray-300"},Tt={class:"py-3 flex justify-between text-sm font-medium"},Bt=t("dt",{class:"text-gray-500 min-w-[70px]"},"Name : ",-1),jt={class:"text-gray-900 break-word"},$t={class:"py-3 flex justify-between text-sm font-medium"},Lt=t("dt",{class:"text-gray-500"},"Age :",-1),Mt={class:"text-gray-900"},St={class:"py-3 flex justify-between text-sm font-medium"},Dt=t("dt",{class:"text-gray-500"},"Result :",-1),Pt={class:"text-gray-900"},It={class:"py-3 flex justify-between text-sm font-medium"},Rt=t("dt",{class:"text-gray-500"},"Date / Time :",-1),zt={class:"text-gray-900"},Et={class:"grid grid-rows-1"},Vt={class:"grid grid-cols-1"},Ot={class:"flex justify-center px-4"},Yt={class:"w-full"},Ft=t("thead",{class:"text-xs font-semibold uppercase text-gray-400 bg-indigo-100"},[t("tr",null,[t("th",{class:"p-2 whitespace-nowrap border-2 rounded-tr",width:"3"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"#")]),t("th",{class:"p-2 whitespace-nowrap border-2"},[t("div",{class:"flex font-semibold justify-center text-gray-700"},"Question")]),t("th",{class:"p-2 whitespace-nowrap border-2 w-8"},[t("div",{class:"flex justify-center font-semibold text-left text-gray-700"},"Result")])])],-1),Nt={class:"text-sm divide-y divide-gray-100"},Ht={class:"p-2 whitespace-nowrap border-2 text-center align-middle"},Wt={class:"p-2 whitespace-nowrap border-2 align-middle"},Zt={class:"flex flex-wrap"},qt={class:"whitespace-normal font-semibold"},Gt={class:"p-2 whitespace-nowrap border-2 text-center align-middle"},Qt={class:"flex justify-center"},Ut={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-check-circle-fill text-green-500",viewBox:"0 0 16 16"},Jt=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"},null,-1),Kt=[Jt],Xt={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-x-circle-fill text-red-500",viewBox:"0 0 16 16"},te=t("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"},null,-1),ee=[te],se={class:"flex justify-between space-x-2 items-center p-4 border-t border-gray-200 rounded-b"},ae={name:"_blank",specs:["fullscreen=yes","titlebar=yes","scrollbars=yes"],styles:["http://127.0.0.1:8000/css/app.css"],timeout:1e3,autoClose:!0,windowTitle:window.document.title},re={components:{SearchIcon:$,TrashIcon:V,PencilIcon:O,ConfirmationModal:z,Head:A,Link:S,Multiselect:E,Modal:j,Pagination:T},props:{filter:Object},data(){return{processing:!1,processing_item:[],bar_chart:"",scatter_chart:"",show_report:!1,report:{title:"",name:"",age:"",result:"",datetime:""},params:{search:this.filter.search?this.filter.search:""},chart_data:{categories:{label:[],data:[]},total_answers:4},answer_data:[]}},watch:{params:{handler(){this.params&&this.$inertia.get(this.route("diagnostic_test.saved_result.details"),this.params,{replace:!0,preserveState:!0})},deep:!0}},methods:{print(){document.getElementById("bar-chart").style.display="none",this.$htmlToPaper("report",ae,()=>{document.getElementById("bar-chart").style.display="block"})},viewReport(r,e,o,s){this.processing=!0,this.processing_item[r].process=!0,this.chart_data.total_answers=o,this.bar_chart&&this.bar_chart.destroy(),this.scatter_chart&&this.scatter_chart.destroy(),this.displayChart(r,e,s)},displayChart(r,e,o){b.get(route("diagnostic_test.get_dt_categories"),{params:{dt_id:e,chart_type:o}}).then(s=>{this.chart_data.categories.label=s.data.label,this.chart_data.categories.data=s.data.data,this.chart_data.categories.data=this.splitResultByCategory(r),this.initChart(o),this.initAnswers(r),this.initInfos(r)}).catch(s=>{console.error(s)})},initChart(r){if(r==1){let o=document.getElementById("bar-chart").getContext("2d");const s=new C(o,{type:"bar",data:{labels:this.chart_data.categories.label,datasets:[{data:this.chart_data.categories.data,borderWidth:1}]},options:{animation:{onComplete:function(){document.getElementById("chart_image").innerHTML='<img src="'+this.toBase64Image()+'">'}},plugins:{legend:{display:!1}},scales:{y:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}},x:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0}}},ticks:{precision:0}}});this.bar_chart=s}if(r==2){const e=this.chart_data.total_answers,o={id:"scatterArbitraryLine",beforeDatasetDraw(h,a,c){const{ctx:_,chartArea:{top:oe,bottom:ie,left:ne,right:ce,width:de,height:le},scales:{x:w,y:x}}=h;M();function M(pe,he,_e,me){_.save(),_.beginPath(),_.strokeStyle="rgba(170, 170, 170, 1)",_.lineWidth=3,_.moveTo(w.getPixelForValue(0),x.getPixelForValue(0)),_.lineTo(w.getPixelForValue(e),x.getPixelForValue(e)),_.stroke(),_.restore()}}},s={id:"scatterAnnotationLine",beforeDraw:h=>{if(h.tooltip._active&&h.tooltip._active.length){const a=h.ctx;a.save();const c=h.tooltip._active[0];a.beginPath(),a.moveTo(c.element.x,h.chartArea.top),a.lineTo(c.element.x,c.element.y),a.lineWidth=2,a.strokeStyle="white",a.stroke(),a.restore(),a.beginPath(),a.moveTo(c.element.x,c.element.y),a.lineTo(c.element.x,h.chartArea.bottom),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore(),a.beginPath(),a.moveTo(h.chartArea.left,c.element.y),a.lineTo(c.element.x,c.element.y),a.lineWidth=2,a.strokeStyle="red",a.stroke(),a.restore()}}};let p=document.getElementById("scatter-chart").getContext("2d");const L=new C(p,{type:"scatter",data:{labels:this.chart_data.total_answers,datasets:[{data:[{x:this.chart_data.categories.data[0],y:this.chart_data.categories.data[1]}],borderColor:"rgba(255, 8, 0, 1)",pointStyle:"crossRot",radius:6,hoverRadius:10,fill:!1}]},options:{animation:{onComplete:function(){document.getElementById("chart_image").innerHTML='<img src="'+this.toBase64Image()+'">'}},plugins:{legend:{display:!1}},scales:{y:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Operations"}},x:{min:0,max:this.chart_data.total_answers,stepSize:1,ticks:{beginAtZero:!0},title:{display:!0,text:"Numbers"}}},ticks:{precision:0}},plugins:[o,s]});this.scatter_chart=L}},splitResultByCategory(r){const o=this.$page.props.answer_record.data[r].answer_record.filter(i=>i.correct).reduce((i,p)=>(p.correct&&(i[p.category_id]?i[p.category_id]++:i[p.category_id]=1),i),{}),s={};return Object.keys(o).forEach((i,p)=>{s[p]=o[i]}),Object.values(s)},initAnswers(r){this.answer_data=this.$page.props.answer_record.data[r].answer_record},initInfos(r){b.get(route("diagnostic_test.get_saved_result_info"),{params:{result_id:this.$page.props.result_id}}).then(e=>{this.report.title=this.$page.props.answer_record.data[r].dt_name,this.report.name=e.data.child_name,this.report.age=e.data.child_age,this.report.result=this.$page.props.answer_record.data[r].total_correct_answers+"/"+this.$page.props.answer_record.data[r].total_answers,this.report.datetime=B(e.data.created_at).format("DD/MM/YYYY, hh:mm A"),this.show_report=!0,this.processing=!1,this.processing_item[r].process=!1}).catch(e=>{console.error(e)})}},created(){this.$page.props.answer_record.data.map(()=>{this.processing_item.push({process:!1})})}},Se=Object.assign(re,{__name:"Details",setup(r){return(e,o)=>(l(),d(y,null,[m(u(A),{title:"Diagnostic Test"}),m(R,null,{header:g(()=>[]),default:g(()=>[t("div",Y,[t("div",F,[t("div",N,[t("div",H,[t("div",W,[t("div",Z,[m(u($),{class:"text-gray-600 h-4 w-4 fill-current pointer-events-none absolute top-1/4 left-3",style:"top:30%"}),D(t("input",{class:"border-2 border-gray-300 bg-white h-10 px-5 pr-16 rounded-lg text-sm focus:ring-0 focus:border-gray-300 appearance-none block pl-10",type:"text","onUpdate:modelValue":o[0]||(o[0]=s=>e.params.search=s),placeholder:"Search"},null,512),[[P,e.params.search]])])])]),t("div",q,[t("table",G,[Q,t("tbody",U,[e.$page.props.answer_record.data.length?I("",!0):(l(),d("tr",J,X)),(l(!0),d(y,null,v(e.$page.props.answer_record.data,(s,i)=>(l(),d("tr",{class:"hover:bg-gray-200",key:s.id},[t("td",tt,[t("div",et,n(i+1),1)]),t("td",st,[t("div",at,n(s.dt_name),1)]),t("td",rt,[t("div",ot,n(s.total_correct_answers+"/"+s.total_answers),1)]),t("td",it,[t("div",nt,n(u(B)(s.created_at).format("DD/MM/YYYY")),1)]),t("td",ct,[t("div",dt,[m(f,{buttonType:"blue",class:"py-1 px-2",onClick:p=>!e.processing_item[i].process&&!e.processing?e.viewReport(i,s.dt_id,s.total_answers,s.chart_type):""},{default:g(()=>[e.processing_item[i].process&&e.processing?(l(),d("div",lt,_t)):(l(),d("span",mt,"View Report"))]),_:2},1032,["onClick"])])])]))),128))])]),m(T,{page_data:e.$page.props.answer_record,params:"&result_id="+e.$page.props.result_id},null,8,["page_data","params"]),m(j,{showModal:e.show_report,onHideModal:o[2]||(o[2]=s=>e.show_report=!1)},{header:g(()=>[gt]),content:g(()=>[t("div",ut,[t("div",yt,[t("div",ft,[t("div",wt,[t("h1",xt,"Diagnostic Test "+n(e.report.title),1)])]),t("div",bt,[t("div",vt,[kt,t("div",Ct,[t("dl",At,[t("div",Tt,[Bt,t("dd",jt,n(e.report.name),1)]),t("div",$t,[Lt,t("dd",Mt,n(e.report.age),1)]),t("div",St,[Dt,t("dd",Pt,n(e.report.result),1)]),t("div",It,[Rt,t("dd",zt,n(e.report.datetime),1)])])])])]),t("div",Et,[t("div",Vt,[t("div",Ot,[t("table",Yt,[Ft,t("tbody",Nt,[(l(!0),d(y,null,v(e.answer_data,(s,i)=>(l(),d("tr",null,[t("td",Ht,n(++i),1),t("td",Wt,[t("div",Zt,[t("p",qt,n(s.question),1)])]),t("td",Gt,[t("div",Qt,[s.correct?(l(),d("svg",Ut,Kt)):(l(),d("svg",Xt,ee))])])]))),256))])])])])])])])]),footer:g(()=>[t("div",se,[m(f,{buttonType:"info",onClick:e.print},{default:g(()=>[k("Print")]),_:1},8,["onClick"]),m(f,{buttonType:"gray",onClick:o[1]||(o[1]=s=>e.show_report=!1)},{default:g(()=>[k("Close")]),_:1})])]),_:1},8,["showModal"])])])])])]),_:1})],64))}});export{Se as default};
